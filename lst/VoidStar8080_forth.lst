     1     			TITLE	'8080 FIG-FORTH 1.1.1 (2023-10-12) for VoidStar8080'
     2 			;;; 	based on 8080 FIG-FORTH 1.1 VERSION A0 17SEP79 for CP/M
     3 			;
     4 			;	FIG-FORTH  RELEASE 1.1  FOR THE 8080 PROCESSOR
     5 			;
     6 			;	ALL PUBLICATIONS OF THE FORTH INTEREST GROUP
     7 			;	ARE PUBLIC DOMAIN.  THEY MAY BE FURTHER
     8 			;	DISTRIBUTED BY THE INCLUSION OF THIS CREDIT
     9 			;	NOTICE:
    10 			;
    11 			;	THIS PUBLICATION HAS BEEN MADE AVAILABLE BY THE
    12 			;		     FORTH INTEREST GROUP
    13 			;		     P. O. BOX 1105
    14 			;		     SAN CARLOS, CA 94070
    15 			;
    16 			;	IMPLEMENTATION BY:
    17 			;		JOHN CASSADY
    18 			;                FOR THE FORTH IMPLEMENTATION TEAM (FIT) MARCH 1979
    19 			;	MODIFIED for CP/M by:
    20 			;	   	KIM HARRIS
    21 			;               FIT LIBRARIAN SEPT 1979
    22 			;	MODIFIED for VoidStar8080 by
    23 			;	   	Greg "(void *) Farsyte" Limes
    24 			;               OCTOBER 2023
    25 			;	ACKNOWLEDGEMENTS:
    26 			;		GEORGE FLAMMER
    27 			;		ROBT. D. VILLWOCK
    28 			;               Microsystems inc. Pasadena Ca.
    29 			;
    30 			;        DISTRIBUTED BY    FORTH POWER
    31 			;               P.O. BOX 2455 SAN RAFAEL CA
    32 			;               94902   415-471-1762
    33 			;               SUPPORT, SYSTEMS PROGRAMMING, 
    34 			;               APPLICATIONS PROGRAMMING
    35 			;
    36 			;  UNLESS OTHERWISE INDICATED, THIS DISTRIBUTION IS SUPPORTED
    37 			;  SOLELY BY THE FORTH INTEREST GROUP (LISTINGS) AND BY
    38 			;  FORTH POWER (MACHINE READABLE COPIES AND EXTENSIONS).
    39 			;
    40 			;   COPYRIGHT AND TRADEMARK NOTICES:
    41 			;   FORTH (C) 1974,1975,1976,1977,1978,1979 FORTH INC.
    42 			;   FIST (C) 1979 FORTH INTERNATIONAL STANDARDS TEAM
    43 			;   FIG, FORTH DIMENSIONS, FIT, (C) 1978, 1979 FORTH INTEREST GROUP
    44 			;   FORTH POWER (C) 1978, 1979 MARIN SERVICES, INC.
    45 			;   FORTH 77, FORTH 78, FORTH 79, STANDARD FORTH, FORTH INTERNATIONAL
    46 			;   STANDARD, (C) 1976, 1977, 1978, 1979, FIST
    47 			;   MULTI-FORTH (C) 1978, 1979 CREATIVE SOLUTIONS
    48 			;   CP/M (C) 1979 DIGITAL RESEARCH INC.
    49 			;   MOST ANYTHING WITH AN 11 IN IT (C) DIGITAL EQUIPMENT CORP
    50 			;   THERE MAY BE OTHERS ! !
    51 			;   MINIFORTH, MICROFORTH, POLYFORTH, FORTH  TM FORTH INC.
    52 			;   FIG-FORTH (C) 1978 1979 FORTH INTEREST GROUP
    53 			;   ALL RIGHTS RESERVED EXCEPT AS EXPRESSLY INDICATED !
    54 			;
    55 			;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    56 			;
    57 			;               UPDATES, PATCHES, BUG REPORTS, EXTENSIONS
    58 			;               FOR THIS SOFTWARE IN  FORTH DIMENSIONS  
    59 			;               NEWSLETTER OF FORTH INTEREST GROUP (FIG)
    60 			;               6 issues $5.00 includes fig membership
    61 			;
    62 			;          DOCUMENTATION FROM FIG or FORTH POWER
    63 			;        
    64 			;               FORTH PRIMER (240pp) Richard Stevens
    65 			;               KITT PEAK NATIONAL OBSERVATORY    $20.00
    66 			;    
    67 			;               FORTH IMPLEMENTATION TEAM LANGUAGE MODEL, EDITOR SOURCE,
    68 			;               LANGUAGE GLOSSARY, AND IMPLEMENTATION GUIDE  $10.00
    69 			;
    70 			;               FORTH FOR MICROCOMPUTERS by JOHN S JAMES
    71 			;               reprint from DDJ #25          $2.00
    72 			;
    73 			;               FORTH POCKET PROGRAMMERS CARD  FREE W/ S.A.S.E.
    74 			;
    75 			;               SOURCE CODE FOR TI990, 6502, 6800, PDP11, PACE,
    76 			;               8080 (included here)    $10.00/ LISTING
    77 			;
    78 			;          DOCUMENTATION FROM FIG
    79 			;
    80 			;               USING FORTH by ELIZABETH RATHER (200pp)
    81 			;               FORTH INC. 1979               $20.00
    82 			;
    83 			;          DOCUMENTATION FROM FORTH POWER
    84 			;               
    85 			;
    86 			;               CP/M MULTI-FORTH USERS MANUAL  $20.00
    87 			;               FORTH 79 INTERNATIONAL STANDARD 
    88 			;
    89 			;               CP/M 8080 FORTH BY FIG 8" DISKETT IBM STD.
    90 			;               WITH EDITOR AND ASSEMBLER, COPY AND PRINT,
    91 			;               AND USERS GUIDE                $65.00
    92 			;
    93 			;               also on 5" CP/M, 5 & 8 Northstar DOS
    94 			;
    95 			;               CP/M Multi-Forth, Full 79 International
    96 			;               Standard with extensions, Strings, Prom burner,
    97 			;               Real time clock, VIDEO EDITOR, UTILITIES
    98 			;               A PROFESSIONAL LEVEL PRODUCT    $150.00
    99 			;               includes manual
   100 			;
   101 			;               PDP 11 FORTH by JOHN S. JAMES
   102 			;               8" RX01 diskett or 9 track 800 bpi DOS tape
   103 			;               runs under OS or stand alone
   104 			;               WITH USERS GUIDE                $150.00
   105 			;
   106 			;               FIG TRS 80 FORTH cassette or diskette
   107 			;               WRITE FOR PRICES
   108 			;
   109 			;               APPLE FORTH BY CapN' SOFTWARE   $40.00
   110 			;               EASYWRITER (word processor for APPLE
   111 			;               by CapN' SOFTWARE)        $100.00
   112 			;
   113 			;               APPLE FORTH BY UNIVERSITY OF UTRECHT,
   114 			;               includes floating pt and many extensions
   115 			;               A PROFESSIONAL LEVEL PRODUCT  $100.00
   116 			;
   117 			;               FORTH FOR MICROPROSSOR DEVELOPMENT SYSTEMS,
   118 			;               FORTH FOR D.G., VAX 11, INTERDATA, Series 1,
   119 			;               C.A., HONEYWELL LEVEL 6, and others,   Write for prices
   120 			;
   121 			;          DOCUMENTATION FROM CALTECH
   122 			;                CALTECH FORTH MANUAL $6.00
   123 			;               CAL TECH BOOKSTORE PASADENA CA
   124 			;               by MARTIN S. EWING 100pp postpaid
   125 			;
   126 			;  CALL FOR PAPERS, ARTICLES, SPEAKERS: FOR FORTH DIMENSIONS
   127 			;   AND TRADE PUBLICATIONS SEND TO FIG.  FOR SPEAKERS, WORKSHOPS,
   128 			;   SHOWS AND CONVENTIONS CONTACT FIG.  FIG SOLICITES FORTH SOFTWARE
   129 			;   FOR INCLUSION IN THIS EFFORT.
   130 			;               FORTH INTERNATIONAL STANDARDS TEAM (FIT)
   131 			;              FORTH 79 INTERNATIONAL STANDARD, REQUIRED AND
   132 			;              RESERVED WORD GLOSSARY, AND STANDARDS ACTIVITY
   133 			;              DISTRIBUTION.  $30.00 TO FIT c/o FIG or to
   134 			;
   135 			;              CAROLYN ROSENBERG, FIT SECRETARY
   136 			;              c/o FORTH INC. MANHATTAN BEACH CA.
   137 			;
   138 			;
   139 			;-----------------------------------------------------
   140 			;	LABELS USED WHICH DIFFER FROM FIG-FORTH PUBLISHED
   141 			;	8080 LISTING 1.0:
   142 			;
   143 			;	REL 1.1		REL 1.0
   144 			;	-------		-------
   145 			;	ANDD		AND
   146 			;	CSPP		CSP
   147 			;	ELSEE		ELSE
   148 			;	ENDD		END
   149 			;	ENDIFF		ENDIF
   150 			;	ERASEE		ERASE
   151 			;	IDO		I
   152 			;	IFF		IF
   153 			;	INN		IN
   154 			;	MODD		MOD
   155 			;	ORR		OR
   156 			;	OUTT		OUT
   157 			;	RR		R
   158 			;	RPP		RP
   159 			;	SUBB		SUB
   160 			;	XORR		XOR
   161 			;
   162 			;	SEE ALSO:
   163 			;		RELEASE & VERSION NUMBERS
   164 			;		ASCII CHARACTER EQUATES
   165 			;		MEMORY ALLOCATION
   166 			;		DISK INTERFACE
   167 			;		CONSOLE & PRINTER INTERFACE
   168 			;
   169     			PAGE
   170
   171 			;; === === === === === === === === === === === === === === === ===
   172 			;; VoidStar8080 memory configuration
   173 			;; current configuration is 48 kib of ram and 16 kib of rom.
   174 			;; === === === === === === === === === === === === === === === ===
   175
   176      00 3E	RAMKB   EQU     62
   177      00 02	ROMKB	EQU     2
   178
   179      F8 00	RAMTOP	EQU     1024*RAMKB
   180      F8 00	ROMBASE EQU     1024*(64-ROMKB)
   181
   182     			PAGE
   183 			;
   184 			;----------------------------------------------------------
   185 			;
   186 			;	RELEASE & VERSION NUMBERS
   187 			;
   188      00 01	FIGREL	EQU	1	; FIG RELEASE #
   189      00 01	FIGREV	EQU	1	; FIG REVISION #
   190      00 01	USRVER	EQU	1	; USER VERSION #
   191 			;
   192 			;	ASCII CHARACTERS USED
   193 			;
   194      00 20	ABL	EQU	20H	; SPACE
   195      00 0D	ACR	EQU	0DH	; CARRIAGE RETURN
   196      00 2E	ADOT	EQU	02EH	; PERIOD
   197      00 07	BELL	EQU	07H	; (^G)
   198      00 7F	BSIN	EQU	7FH	; INPUT BACKSPACE CHR = RUBOUT
   199      00 08	BSOUT	EQU	08H	; OUTPUT BACKSPACE (^H)
   200      00 10	DLE	EQU	10H	; (^P)
   201      00 0A	LF	EQU	0AH	; LINE FEED
   202      00 0C	FF	EQU	0CH	; FORM FEED (^L)
   203 			;
   204 			;	MEMORY ALLOCATION
   205 			;
   206      F8 00	EM	EQU	RAMTOP	; TOP OF MEMORY + 1 = LIMIT
   207      00 01	NSCR	EQU	1	; NUMBER OF 1024 BYTE SCREENS
   208      00 80	KBBUF	EQU	128	; DATA BYTES PER DISK BUFFER
   209      00 40	US	EQU	40H	; USER VARIABLES SPACE
   210      00 A0	RTS	EQU	0A0H	; RETURN STACK & TERM BUFF SPACE
   211 			;
   212      00 84	CO	EQU	KBBUF+4	; DISK BUFFER + 2 HEADER + 2 TAIL
   213      00 08	NBUF	EQU	NSCR*400H/KBBUF	; NUMBER OF BUFFERS
   214      F3 E0	BUF1	EQU	EM-(CO*NBUF)	; ADDR FIRST DISK BUFFER
   215      F3 A0	INITR0	EQU	BUF1-US		; (R0)
   216      F3 00	INITS0	EQU	INITR0-RTS	; (S0)
   217 			;
   218     			PAGE
   219 			;
   220 			;-------------------------------------------------------
   221 			;
   222      01 00		ORG	100H
   223
   224 0100 00		ORIG	NOP
   225 0101 C3 2B 11		JMP	CLD	; VECTOR TO COLD START
   226 0104 00			NOP
   227 0105 C3 15 11		JMP	WRM	; VECTOR TO WARM START
   228
   229 0108			DB	FIGREL	; FIG RELEASE #
            01 
   230 0109			DB	FIGREV	; FIG REVISION #
            01 
   231 010A			DB	USRVER	; USER VERSION #
            01 
   232 010B			DB	0EH	; IMPLEMENTATION ATTRIBUTES
            0E 
   233 010C			DW	TASK-7  ; TOPMOST WORD IN FORTH VOCABULARY
            521B 
   234 010E			DW	BSIN	; BKSPACE CHARACTER
            7F00 
   235 0110			DW	INITR0	; INIT (UP)
            A0F3 
   236
   237 			;<<<<<< FOLLOWING USED BY COLD;
   238 			;	MUST BE IN SAME ORDER AS USER VARIABLES
   239 0112			DW	INITS0	; INIT (S0)
            00F3 
   240 0114			DW	INITR0	; INIT (R0)
            A0F3 
   241 0116			DW	INITS0	; INIT (TIB)
            00F3 
   242 0118			DW	20H		; INIT (WIDTH)
            2000 
   243 011A			DW	0		; INIT (WARNING)
            0000 
   244 011C			DW	INITDP		; INIT (FENCE)
            5D1B 
   245 011E			DW	INITDP		; INIT (DP)
            5D1B 
   246 0120			DW	FORTH+6		; INIT (VOC-LINK)
            8F10 
   247 			;<<<<<< END DATA USED BY COLD
   248
   249 0122			DW	5H,0B320H	; CPU NAME	( HW,LW )
            0500 20B3 
   250
   251 			;				  ( 32 BIT, BASE 36 INTEGER )
   252 			;
   253 			;
   254 			;			+---------------+
   255 			;	B +ORIGIN	| . . .W:I.E.B.A|	IMPLEMENTATION
   256 			;			+---------------+	ATTRIBUTES
   257 			;			       ^ ^ ^ ^ ^
   258 			;			       | | | | +-- PROCESSOR ADDR =
   259 			;			       | | | |     { 0 BYTE | 1 WORD }
   260 			;			       | | | +---- HIGH BYTE AT
   261 			;			       | | |       { 0 LOW ADDR |
   262 			;			       | | |	     1 HIGH ADDR }
   263 			;			       | | +------ ADDR MUST BE EVEN
   264 			;			       | |	   { 0 YES | 1 NO }
   265 			;			       | +-------- INTERPRETER IS
   266 			;			       |	   { 0 PRE | 1 POST }
   267 			;			       |	   INCREMENTING
   268 			;			       +---------- { 0 ABOVE SUFFICIENT
   269 			;					     | 1 OTHER DIFFER-
   270 			;					     ENCES EXIST }
   271 			;
   272     			PAGE
   273 			;
   274 			;------------------------------------------------------
   275 			;
   276 			;	FORTH REGISTERS
   277 			;
   278 			;	FORTH	8080	FORTH PRESERVATION RULES
   279 			;	-----	----	------------------------------------------------------------------------
   280 			;	IP	BC	SHOULD BE PRESERVED ACROSS
   281 			;			  FORTH WORDS
   282 			;	W	DE	SOMETIMES OUTPUT FROM NEXT
   283 			;			MAY BE ALTERED BEFORE JMP'ING TO NEXT
   284 			;			INPUT ONLY WHEN 'DPUSH' CALLED
   285 			;	SP	SP	SHOULD BE USED ONLY AS DATA STACK
   286 			;			  ACROSS FORTH WORDS
   287 			;			MAY BE USED WITHIN FORTH WORDS
   288 			;			  IF RESTORED BEFORE 'NEXT'
   289 			;		HL	NEVER OUTPUT FROM NEXT
   290 			;			INPUT ONLY WHEN 'HPUSH' CALLED
   291 			;
   292 0126		UP	DW	INITR0	; USER AREA POINTER
            A0F3 
   293 0128		RPP	DW	INITR0	; RETURN STACK POINTER
            A0F3 
   294 			;
   295 			;------------------------------------------------------
   296 			;
   297 			;	COMMENT CONVENTIONS:
   298 			;
   299 			;	=	MEANS	"IS EQUAL TO"
   300 			;	<-	MEANS	ASSIGNMENT
   301 			;
   302 			;	NAME	=	ADDRESS OF NAME
   303 			;	(NAME)	=	CONTENTS AT NAME
   304 			;	((NAME))=	INDIRECT CONTENTS
   305 			;
   306 			;	CFA	=	ADDRESS OF CODE FIELD
   307 			;	LFA	=	ADDRESS OF LINK FIELD
   308 			;	NFA	=	ADDR OF START OF NAME FIELD
   309 			;	PFA	=	ADDR OF START OF PARAMETER FIELD
   310 			;
   311 			;	S1	=	ADDR OF 1ST WORD OF PARAMETER STACK
   312 			;	S2	=	ADDR OF 2ND WORD OF PARAMETER STACK
   313 			;	R1	=	ADDR OF 1ST WORD OF RETURN STACK
   314 			;	R2	=	ADDR OF 2ND WORD OF RETURN STACK
   315 			;	( ABOVE STACK POSITIONS VALID BEFORE & AFTER EXECUTION
   316 			;	OF ANY WORD, NOT DURING. )
   317 			;
   318 			;	LSB	=	LEAST SIGNIFICANT BIT
   319 			;	MSB	=	MOST SIGNIFICANT BIT
   320 			;	LB	=	LOW BYTE
   321 			;	HB	=	HIGH BYTE
   322 			;	LW	=	LOW WORD
   323 			;	HW	=	HIGH WORD
   324 			;	( MAY BE USED AS SUFFIX TO ABOVE NAMES )
   325 			;
   326     			PAGE
   327 			;
   328 			;---------------------------------------------------
   329 			;	DEBUG SUPPORT
   330 			;
   331 			;	TO USE:
   332 			;	(1)	SET 'BIP' TO IP VALUE TO HALT, CANNOT BE CFA
   333 			;	(2)	SET MONITOR'S BREAKPOINT PC TO 'BREAK'
   334 			;			OR PATCH 'HLT' INSTR. THERE
   335 			;	(3)	PATCH A 'JMP TNEXT' AT 'NEXT'
   336 			;	WHEN (IP) = (BIP) CPU WILL HALT
   337 			;
   338 012A		BIP	DW	0	; BREAKPOINT ON IP VALUE
            0000 
   339 			;
   340 012C 21 2A 01	TNEXT	LXI	H,BIP
   341 012F 7E			MOV	A,M	; LB
   342 0130 B9			CMP	C
   343 0131 C2 3D 01		JNZ	TNEXT1
   344 0134 23			INX	H
   345 0135 7E			MOV	A,M	; HB
   346 0136 B8			CMP	B
   347 0137 C2 3D 01		JNZ	TNEXT1
   348 013A 00		BREAK	NOP		; PLACE BREAKPOINT HERE
   349 013B 00			NOP
   350 013C 00			NOP
   351 013D 0A		TNEXT1	LDAX	B
   352 013E 03			INX	B
   353 013F 6F			MOV	L,A
   354 0140 C3 48 01		JMP	NEXT+3
   355 			;
   356 			;--------------------------------------------------
   357 			;
   358 			;	NEXT, THE FORTH ADDRESS INTERPRETER
   359 			;	  ( POST INCREMENTING VERSION )
   360 			;
   361 0143 D5		DPUSH	PUSH	D
   362 0144 E5		HPUSH	PUSH	H
   363 0145 0A		NEXT	LDAX	B	;(W) <- ((IP))
   364 0146 03			INX	B	;(IP) <- (IP)+2
   365 0147 6F			MOV	L,A
   366 0148 0A			LDAX	B
   367 0149 03			INX	B
   368 014A 67			MOV	H,A	; (HL) <- CFA
   369 014B 5E		NEXT1:	MOV	E,M	;(PC) <- ((W))
   370 014C 23			INX	H
   371 014D 56			MOV	D,M
   372 014E EB			XCHG
   373 014F E9			PCHL		; NOTE: (DE) = CFA+1
   374 			;
   375     			PAGE
   376 			;
   377 			;		FORTH DICTIONARY
   378 			;
   379 			;
   380 			;	DICTIONARY FORMAT:
   381 			;
   382 			;				BYTE
   383 			;	ADDRESS	NAME		CONTENTS
   384 			;	------- ----		--------
   385 			;					  ( MSB=1
   386 			;					  ( P=PRECEDENCE BIT
   387 			;					  ( S=SMUDGE BIT
   388 			;	NFA	NAME FIELD	1PS<LEN>  < NAME LENGTH
   389 			;				0<1CHAR>  MSB=0, NAME'S 1ST CHAR
   390 			;				0<2CHAR>
   391 			;				  ...
   392 			;				1<LCHAR>  MSB=1, NAME'S LAST CHR
   393 			;	LFA	LINK FIELD	<LINKLB>  = PREVIOUS WORD'S NFA
   394 			;				<LINKHB>
   395 			;LABEL:	CFA	CODE FIELD	<CODELB>  = ADDR CPU CODE
   396 			;				<CODEHB>
   397 			;	PFA	PARAMETER	<1PARAM>  1ST PARAMETER BYTE
   398 			;		FIELD		<2PARAM>
   399 			;				  ...
   400 			;
   401 			;
   402 0150		DP0:	DB	83H	; LIT
            83 
   403 0151			DB	'LI'
            4C 49 
   404 0153			DB	'T'+80H
            54 80 
   405 0155			DW	0	; (LFA)=0 MARKS END OF DICTIONARY
            0000 
   406 0157		LIT	DW	$+2	;(S1) <- ((IP))
            5901 
   407 0159 0A			LDAX	B	; (HL) <- ((IP)) = LITERAL
   408 015A 03			INX	B	; (IP) <- (IP) + 2
   409 015B 6F			MOV	L,A	; LB
   410 015C 0A			LDAX	B	; HB
   411 015D 03			INX	B
   412 015E 67			MOV	H,A
   413 015F C3 44 01		JMP	HPUSH	; (S1) <- (HL)
   414 			 ;
   415 0162			DB	87H	; EXECUTE
            87 
   416 0163			DB	'EXECUT'
            45 58 45 43 
            55 54 
   417 0169			DB	'E'+80H
            45 80 
   418 016B			DW	LIT-6
            5101 
   419 016D		EXEC	DW	$+2
            6F01 
   420 016F E1			POP	H	; (HL) <- (S1) = CFA
   421 0170 C3 4B 01		JMP	NEXT1
   422 			;
   423 0173			DB	86H	; BRANCH
            86 
   424 0174			DB	'BRANC'
            42 52 41 4E 
            43 
   425 0179			DB	'H'+80H
            48 80 
   426 017B			DW	EXEC-0AH
            6301 
   427 017D		BRAN	DW	$+2	;(IP) <- (IP) + ((IP))
            7F01 
   428 017F 60		BRAN1	MOV	H,B	; (HL) <- (IP)
   429 0180 69			MOV	L,C
   430 0181 5E			MOV	E,M	; (DE) <- ((IP)) = BRANCH OFFSET
   431 0182 23			INX	H
   432 0183 56			MOV	D,M
   433 0184 2B			DCX	H
   434 0185 19			DAD	D	; (HL) <- (HL) + ((IP))
   435 0186 4D			MOV	C,L	; (IP) <- (HL)
   436 0187 44			MOV	B,H
   437 0188 C3 45 01		JMP	NEXT
   438 			;
   439 018B			DB	87H	; 0BRANCH
            87 
   440 018C			DB	'0BRANC'
            30 42 52 41 
            4E 43 
   441 0192			DB	'H'+80H
            48 80 
   442 0194			DW	BRAN-9
            7401 
   443 0196		ZBRAN	DW	$+2
            9801 
   444 0198 E1			POP	H
   445 0199 7D			MOV	A,L
   446 019A B4			ORA	H
   447 019B CA 7F 01		JZ	BRAN1	; IF (S1)=0 THEN BRANCH
   448 019E 03			INX	B	; ELSE SKIP BRANCH OFFSET
   449 019F 03			INX	B
   450 01A0 C3 45 01		JMP	NEXT
   451 			;
   452 01A3			DB	86H	; (LOOP)
            86 
   453 01A4			DB	'(LOOP'
            28 4C 4F 4F 
            50 
   454 01A9			DB	')'+80H
            29 80 
   455 01AB			DW	ZBRAN-0AH
            8C01 
   456 01AD		XLOOP	DW	$+2
            AF01 
   457 01AF 11 01 00		LXI	D,1	; (DE) <- INCREMENT
   458 01B2 2A 28 01	XLOO1	LHLD	RPP	; ((HL)) = INDEX
   459 01B5 7E			MOV	A,M	; INDEX <- INDEX + INCR
   460 01B6 83			ADD	E
   461 01B7 77			MOV	M,A
   462 01B8 5F			MOV	E,A
   463 01B9 23			INX	H
   464 01BA 7E			MOV	A,M
   465 01BB 8A			ADC	D
   466 01BC 77			MOV	M,A
   467 01BD 23			INX	H	; ((HL)) = LIMIT
   468 01BE 14			INR	D
   469 01BF 15			DCR	D
   470 01C0 57			MOV	D,A	; (DE) <- NEW INDEX
   471 01C1 FA CC 01		JM	XLOO2	; IF INCR > 0
   472 01C4 7B			MOV	A,E
   473 01C5 96			SUB	M	; THEN (A) <- INDEX - LIMIT
   474 01C6 7A			MOV	A,D
   475 01C7 23			INX	H
   476 01C8 9E			SBB	M
   477 01C9 C3 D1 01		JMP	XLOO3
   478 01CC 7E		XLOO2	MOV	A,M	; ELSE (A) <- LIMIT - INDEX
   479 01CD 93			SUB	E
   480 01CE 23			INX	H
   481 01CF 7E			MOV	A,M
   482 01D0 9A			SBB	D
   483 			;			; IF (A) < 0
   484 01D1 FA 7F 01	XLOO3	JM	BRAN1	; THEN LOOP AGAIN
   485 01D4 23			INX	H	; ELSE DONE
   486 01D5 22 28 01		SHLD	RPP	; DISCARD R1 & R2
   487 01D8 03			INX	B	; SKIP BRANCH OFFSET
   488 01D9 03			INX	B
   489 01DA C3 45 01		JMP	NEXT
   490 			;
   491 01DD			DB	87H	; (+LOOP)
            87 
   492 01DE			DB	'(+LOOP'
            28 2B 4C 4F 
            4F 50 
   493 01E4			DB	')'+80H
            29 80 
   494 01E6			DW	XLOOP-9
            A401 
   495 01E8		XPLOO	DW	$+2
            EA01 
   496 01EA D1			POP	D	; (DE) <- INCR
   497 01EB C3 B2 01		JMP	XLOO1
   498 			;
   499 01EE			DB	84H	; (DO)
            84 
   500 01EF			DB	'(DO'
            28 44 4F 
   501 01F2			DB	')'+80H
            29 80 
   502 01F4			DW	XPLOO-0AH
            DE01 
   503 01F6		XDO	DW	$+2
            F801 
   504 01F8 2A 28 01		LHLD	RPP	; (RP) <- (RP) - 4
   505 01FB 2B			DCX	H
   506 01FC 2B			DCX	H
   507 01FD 2B			DCX	H
   508 01FE 2B			DCX	H
   509 01FF 22 28 01		SHLD	RPP
   510 0202 D1			POP	D	; (R1) <- (S1) = INIT INDEX
   511 0203 73			MOV	M,E
   512 0204 23			INX	H
   513 0205 72			MOV	M,D
   514 0206 D1			POP	D	; (R2) <- (S2) = LIMIT
   515 0207 23			INX	H
   516 0208 73			MOV	M,E
   517 0209 23			INX	H
   518 020A 72			MOV	M,D
   519 020B C3 45 01		JMP	NEXT
   520 			;
   521 020E			DB	81H	; I
            81 
   522 020F			DB	'I'+80H
            49 80 
   523 0211			DW	XDO-7
            EF01 
   524 0213		IDO	DW	$+2	;(S1) <- (R1) , (R1) UNCHANGED
            1502 
   525 0215 2A 28 01		LHLD	RPP
   526 0218 5E			MOV	E,M	; (DE) <- (R1)
   527 0219 23			INX	H
   528 021A 56			MOV	D,M
   529 021B D5			PUSH	D	; (S1) <- (DE)
   530 021C C3 45 01		JMP	NEXT
   531 			;
   532 021F			DB	85H	; DIGIT
            85 
   533 0220			DB	'DIGI'
            44 49 47 49 
            
   534 0224			DB	'T'+80H
            54 80 
   535 0226			DW	IDO-4
            0F02 
   536 0228		DIGIT	DW	$+2
            2A02 
   537 022A E1			POP	H	; (L) <- (S1)LB = ASCII CHR TO BE
   538 			;			 CONVERTED
   539 022B D1			POP	D	; (DE) <- (S2) = BASE VALUE
   540 022C 7B			MOV	A,E
   541 022D D6 30		SUI	30H	; IF CHR > "0"
   542 022F FA 49 02		JM	DIGI2
   543 0232 FE 0A		CPI	0AH	; AND IF CHR > "9"
   544 0234 FA 3E 02		JM	DIGI1
   545 0237 D6 07		SUI	7
   546 0239 FE 0A		CPI	0AH	; AND IF CHR >= "A"
   547 023B FA 49 02		JM	DIGI2
   548 			;			; THEN VALID NUMERIC OR ALPHA CHR
   549 023E BD		DIGI1	CMP	L	; IF < BASE VALUE
   550 023F F2 49 02		JP	DIGI2
   551 			;			; THEN VALID DIGIT CHR
   552 0242 5F			MOV	E,A	; (S2) <- (DE) = CONVERTED DIGIT
   553 0243 21 01 00		LXI	H,1	; (S1) <- TRUE
   554 0246 C3 43 01		JMP	DPUSH
   555 			;			; ELSE INVALID DIGIT CHR
   556 0249 6C		DIGI2	MOV	L,H	; (HL) <- FALSE
   557 024A C3 44 01		JMP	HPUSH	; (S1) <- FALSE
   558 			;
   559 024D			DB	86H	; (FIND)  (2-1)FAILURE
            86 
   560 024E			DB	'(FIND'	; (2-3)SUCCESS
            28 46 49 4E 
            44 
   561 0253			DB	')'+80H
            29 80 
   562 0255			DW	DIGIT-8
            2002 
   563 0257		PFIND	DW	$+2
            5902 
   564 0259 D1			POP	D	; (DE) <- NFA
   565 025A E1		PFIN1	POP	H	; (HL) <- STRING ADDR
   566 025B E5			PUSH	H	; SAVE STRING ADDR FOR NEXT ITERATION
   567 025C 1A			LDAX	D
   568 025D AE			XRA	M	; CHECK LENGTHS & SMUDGE BIT
   569 025E E6 3F		ANI	3FH
   570 0260 C2 85 02		JNZ	PFIN4	; LENGTHS DIFFERENT
   571 			;			; LENGTHS MATCH, CHECK EACH CHR
   572 0263 23		PFIN2	INX	H	; (HL) <- ADDR NEXT CHR IN STRING
   573 0264 13			INX	D	; (DE) <- ADDR NEXT CHR IN NF
   574 0265 1A			LDAX	D
   575 0266 AE			XRA	M	; IGNORE MSB
   576 0267 87			ADD	A
   577 0268 C2 82 02		JNZ	PFIN3	; NO MATCH
   578 026B D2 63 02		JNC	PFIN2	; MATCH SO FAR, LOOP AGAIN
   579 026E 21 05 00		LXI	H,5	; STRING MATCHES
   580 0271 19			DAD	D	; ((SP)) <- PFA
   581 0272 E3			XTHL
   582 			;			; BACK UP TO LENGTH BYTE OF NF = NFA
   583 0273 1B		PFIN6	DCX	D
   584 0274 1A			LDAX	D
   585 0275 B7			ORA	A
   586 0276 F2 73 02		JP	PFIN6	; IF MSB = 1 THEN (DE) = NFA
   587 0279 5F			MOV	E,A	; (DE) <- LENGTH BYTE
   588 027A 16 00		MVI	D,0
   589 027C 21 01 00		LXI	H,1	; (HL) <- TRUE
   590 027F C3 43 01		JMP	DPUSH  ; RETURN, NF FOUND
   591 			;	ABOVE NF NOT A MATCH, TRY ANOTHER
   592 0282 DA 8B 02	PFIN3	JC	PFIN5	; IF NOT END OF NF
   593 0285 13		PFIN4	INX	D	; THEN FIND END OF NF
   594 0286 1A			LDAX	D
   595 0287 B7			ORA	A
   596 0288 F2 85 02		JP	PFIN4
   597 028B 13		PFIN5	INX	D	; (DE) <- LFA
   598 028C EB			XCHG
   599 028D 5E			MOV	E,M	; (DE) <- (LFA)
   600 028E 23			INX	H
   601 028F 56			MOV	D,M
   602 0290 7A			MOV	A,D
   603 0291 B3			ORA	E	; IF (LFA) <> 0
   604 0292 C2 5A 02		JNZ	PFIN1	; THEN TRY PREVIOUS DICT. DEF.
   605 			;			; ELSE END OF DICTIONARY
   606 0295 E1			POP	H	; DISCARD STRING ADDR
   607 0296 21 00 00		LXI	H,0	; (HL) <- FALSE
   608 0299 C3 44 01		JMP	HPUSH  	; RETURN, NO MATCH FOUND
   609 			;
   610 029C			DB	87H	; ENCLOSE
            87 
   611 029D			DB	'ENCLOS'
            45 4E 43 4C 
            4F 53 
   612 02A3			DB	'E'+80H
            45 80 
   613 02A5			DW	PFIND-9
            4E02 
   614 02A7		ENCL	DW	$+2
            A902 
   615 02A9 D1			POP	D	; (DE) <- (S1) = DELIMITER CHAR
   616 02AA E1			POP	H	; (HL) <- (S2) = ADDR TEXT TO SCAN
   617 02AB E5			PUSH	H	; (S4) <- ADDR
   618 02AC 7B			MOV	A,E
   619 02AD 57			MOV	D,A	; (D) <- DELIM CHR
   620 02AE 1E FF		MVI	E,-1	; INITIALIZE CHR OFFSET COUNTER
   621 02B0 2B			DCX	H	; (HL) <- ADDR-1
   622 			;			; SKIP OVER LEADING DELIMITER CHRS
   623 02B1 23		ENCL1	INX	H
   624 02B2 1C			INR	E
   625 02B3 BE			CMP	M	; IF TEXT CHR = DELIM CHR
   626 02B4 CA B1 02		JZ	ENCL1	; THEN LOOP AGAIN
   627 			;			; ELSE NON-DELIM CHR FOUND
   628 02B7 16 00		MVI	D,0	; (S3) <- (E) = OFFSET TO 1ST NON-DELIM
   629 02B9 D5			PUSH	D
   630 02BA 57			MOV	D,A	; (D) <- DELIM CHR
   631 02BB 7E			MOV	A,M	; IF 1ST NON-DELIM = NULL
   632 02BC A7			ANA	A
   633 02BD C2 C9 02		JNZ	ENCL2
   634 02C0 16 00		MVI	D,0	; THEN (S2) <- OFFSET TO BYTE
   635 02C2 1C			INR	E	;   FOLLOWING NULL
   636 02C3 D5			PUSH	D
   637 02C4 1D			DCR	E	; (S1) <- OFFSET TO NULL
   638 02C5 D5			PUSH	D
   639 02C6 C3 45 01		JMP	NEXT
   640 			;			; ELSE TEXT CONTAINS NON-DELIM &
   641 			;			  NON-NULL CHR
   642 02C9 7A		ENCL2	MOV	A,D	; (A) <- DELIM CHR
   643 02CA 23			INX	H	; (HL) <- ADDR NEXT CHR
   644 02CB 1C			INR	E	; (E) <- OFFSET TO NEXT CHR
   645 02CC BE			CMP	M	; IF NEXT CHR <> DELIM CHR
   646 02CD CA DC 02		JZ	ENCL4
   647 02D0 7E			MOV	A,M	; AND IF NEXT CHR <> NULL
   648 02D1 A7			ANA	A
   649 02D2 C2 C9 02		JNZ	ENCL2	; THEN CONTINUE SCAN
   650 			;			; ELSE CHR = NULL
   651 02D5 16 00	ENCL3	MVI	D,0	; (S2) <- OFFSET TO NULL
   652 02D7 D5			PUSH	D
   653 02D8 D5			PUSH	D	; (S1) <- OFFSET TO NULL
   654 02D9 C3 45 01		JMP	NEXT
   655 			;			; ELSE CHR = DELIM CHR
   656 02DC 16 00	ENCL4	MVI	D,0	; (S2) <- OFFSET TO BYTE
   657 			;			  FOLLOWING TEXT
   658 02DE D5			PUSH	D
   659 02DF 1C			INR	E	; (S1) <- OFFSET TO 2 BYTES AFTER
   660 			;			    END OF WORD
   661 02E0 D5			PUSH	D
   662 02E1 C3 45 01		JMP	NEXT
   663 			;
   664 02E4			DB	84H	; EMIT
            84 
   665 02E5			DB	'EMI'
            45 4D 49 
   666 02E8			DB	'T'+80H
            54 80 
   667 02EA			DW	ENCL-0AH
            9D02 
   668 02EC		EMIT	DW	DOCOL
            4306 
   669 02EE			DW	PEMIT
            5117 
   670 02F0			DW	ONE,OUTT
            CF06 BA07 
   671 02F4			DW	PSTOR,SEMIS
            9C05 6104 
   672 			;
   673 02F8			DB	83H	; KEY
            83 
   674 02F9			DB	'KE'
            4B 45 
   675 02FB			DB	'Y'+80H
            59 80 
   676 02FD			DW	EMIT-7
            E502 
   677 02FF		KEY	DW	$+2
            0103 
   678 0301 C3 39 17		JMP	PKEY
   679 			;
   680 0304			DB	89H	; ?TERMINAL
            89 
   681 0305			DB	'?TERMINA'
            3F 54 45 52 
            4D 49 4E 41 
            
   682 030D			DB	'L'+80H
            4C 80 
   683 030F			DW	KEY-6
            F902 
   684 0311		QTERM	DW	$+2
            1303 
   685 0313 21 00 00		LXI	H,0
   686 0316 C3 2B 17		JMP	PQTER
   687 			;
   688 0319			DB	82H	; CR
            82 
   689 031A			DB	'C'
            43 
   690 031B			DB	'R'+80H
            52 80 
   691 031D			DW	QTERM-0CH
            0503 
   692 031F		CR	DW	$+2
            2103 
   693 0321 C3 5D 17		JMP	PCR
   694 			;
   695 0324			DB	85H	; CMOVE
            85 
   696 0325			DB	'CMOV'
            43 4D 4F 56 
            
   697 0329			DB	'E'+80H
            45 80 
   698 032B			DW	CR-5
            1A03 
   699 032D		CMOVE	DW	$+2
            2F03 
   700 032F 69			MOV	L,C	; (HL) <- (IP)
   701 0330 60			MOV	H,B
   702 0331 C1			POP	B	; (BC) <- (S1) = #CHRS
   703 0332 D1			POP	D	; (DE) <- (S2) = DEST ADDR
   704 0333 E3			XTHL		; (HL) <- (S3) = SOURCE ADDR
   705 			;			; (S1) <- (IP)
   706 0334 C3 3C 03		JMP	CMOV2	; RETURN IF #CHRS = 0
   707 0337 7E		CMOV1	MOV	A,M	; ((DE)) <- ((HL))
   708 0338 23			INX	H	; INC SOURCE ADDR
   709 0339 12			STAX	D
   710 033A 13			INX	D	; INC DEST ADDR
   711 033B 0B			DCX	B	; DEC #CHRS
   712 033C 78		CMOV2	MOV	A,B
   713 033D B1			ORA	C
   714 033E C2 37 03		JNZ	CMOV1	; REPEAT IF #CHRS <> 0
   715 0341 C1			POP	B	; RESTORE (IP) FROM (S1)
   716 0342 C3 45 01		JMP	NEXT
   717 			;
   718 0345			DB	82H	; U*	16X16 UNSIGNED MULTIPLY
            82 
   719 0346			DB	'U'	; AVG EXECUUION TIME = 994 CYCLES
            55 
   720 0347			DB	'*'+80H
            2A 80 
   721 0349			DW	CMOVE-8
            2503 
   722 034B		USTAR	DW	$+2
            4D03 
   723 034D D1			POP	D	; (DE) <- MPLIER
   724 034E E1			POP	H	; (HL) <- MPCAND
   725 034F C5			PUSH	B	; SAVE IP
   726 0350 44			MOV	B,H
   727 0351 7D			MOV	A,L	; (BA) <- MPCAND
   728 0352 CD 69 03		CALL	MPYX	; (AHL)1 <- MPCAND.LB * MPLIER
   729 			;			       1ST PARTIAL PRODUCT
   730 0355 E5			PUSH	H	; SAVE (HL)1
   731 0356 67			MOV	H,A
   732 0357 78			MOV	A,B
   733 0358 44			MOV	B,H	; SAVE (A)1
   734 0359 CD 69 03		CALL	MPYX	; (AHL)2 <- MPCAND.HB * MPLIER
   735 			;			       2ND PARTIAL PRODUCT
   736 035C D1			POP	D	; (DE) <- (HL)1
   737 035D 4A			MOV	C,D	; (BC) <- (AH)1
   738 			;	FORM SUM OF PARTIALS:
   739 			;			   (AHL) 1
   740 			;			+ (AHL)  2
   741 			;			--------
   742 			;			  (AHLE)
   743 035E 09			DAD	B	; (HL) <- (HL)2 + (AH)1
   744 035F CE 00		ACI	0	; (AHLE) <- (BA) * (DE)
   745 0361 55			MOV	D,L
   746 0362 6C			MOV	L,H
   747 0363 67			MOV	H,A	; (HLDE) <- MPLIER * MPCAND
   748 0364 C1			POP	B	; RESTORE IP
   749 0365 D5			PUSH	D	; (S2) <- PRODUCT.LW
   750 0366 C3 44 01		JMP	HPUSH	; (S1) <- PRODUCT.HW
   751 			;
   752 			;	MULTIPLY PRIMITIVE
   753 			;		(AHL) <- (A) * (DE)
   754 			;	#BITS =	 24	  8	16
   755 0369 21 00 00	MPYX	LXI	H,0	; (HL) <- 0 = PARTIAL PRODUCT.LW
   756 036C 0E 08		MVI	C,8	; LOOP COUNTER
   757 036E 29		MPYX1	DAD	H	; LEFT SHIFT (AHL) 24 BITS
   758 036F 17			RAL
   759 0370 D2 76 03		JNC	MPYX2	; IF NEXT MPLIER BIT = 1
   760 0373 19			DAD	D	; THEN ADD MPCAND
   761 0374 CE 00		ACI	0
   762 0376 0D		MPYX2	DCR	C	; IF NOT LAST MPLIER BIT
   763 0377 C2 6E 03		JNZ	MPYX1	; THEN LOOP AGAIN
   764 037A C9			RET		; ELSE DONE
   765 			;
   766 037B			DB	82H	; U/
            82 
   767 037C			DB	'U'
            55 
   768 037D			DB	'/'+80H
            2F 80 
   769 037F			DW	USTAR-5
            4603 
   770 0381		USLAS	DW	$+2
            8303 
   771 0383 21 04 00		LXI	H,4
   772 0386 39			DAD	SP	; ((HL)) <- NUMERATOR.LW
   773 0387 5E			MOV	E,M	; (DE) <- NUMER.LW
   774 0388 71			MOV	M,C	; SAVE IP ON STACK
   775 0389 23			INX	H
   776 038A 56			MOV	D,M
   777 038B 70			MOV	M,B
   778 038C C1			POP	B	; (BC) <- DENOMINATOR
   779 038D E1			POP	H	; (HL) <- NUMER.HW
   780 038E 7D			MOV	A,L
   781 038F 91			SUB	C	; IF NUMER >= DENOM
   782 0390 7C			MOV	A,H
   783 0391 98			SBB	B
   784 0392 DA 9E 03		JC	USLA1
   785 0395 21 FF FF		LXI	H,0FFFFH	; THEN OVERFLOW
   786 0398 11 FF FF		LXI	D,0FFFFH	; SET REM & QUOT TO MAX
   787 039B C3 C9 03		JMP	USLA7
   788 039E 3E 10	USLA1	MVI	A,16	; LOOP COUNTER
   789 03A0 29		USLA2	DAD	H	; LEFT SHIFT (HLDE) THRU CARRY
   790 03A1 17			RAL
   791 03A2 EB			XCHG
   792 03A3 29			DAD	H
   793 03A4 D2 A9 03		JNC	USLA3
   794 03A7 13			INX	D
   795 03A8 A7			ANA	A
   796 03A9 EB		USLA3	XCHG		; SHIFT DONE
   797 03AA 1F			RAR		; RESTORE 1ST CARRY
   798 03AB F5			PUSH	PSW	; SAVE COUNTER
   799 03AC D2 B8 03		JNC	USLA4	; IF CARRY = 1
   800 03AF 7D			MOV	A,L	; THEN (HL) <- (HL) - (BC)
   801 03B0 91			SUB	C
   802 03B1 6F			MOV	L,A
   803 03B2 7C			MOV	A,H
   804 03B3 98			SBB	B
   805 03B4 67			MOV	H,A
   806 03B5 C3 C3 03		JMP	USLA5
   807 03B8 7D		USLA4	MOV	A,L	; ELSE TRY (HL) <- (HL) - (BC)
   808 03B9 91			SUB	C
   809 03BA 6F			MOV	L,A
   810 03BB 7C			MOV	A,H
   811 03BC 98			SBB	B	; (HL) <- PARTIAL REMAINDER
   812 03BD 67			MOV	H,A
   813 03BE D2 C3 03		JNC	USLA5
   814 03C1 09			DAD	B	; UNDERFLOW, RESTORE
   815 03C2 1B			DCX	D
   816 03C3 13		USLA5	INX	D	; INC QUOT
   817 03C4 F1		USLA6	POP	PSW	; RESTORE COUNTER
   818 03C5 3D			DCR	A	; IF COUNTER > 0
   819 03C6 C2 A0 03		JNZ	USLA2	; THEN LOOP AGAIN
   820 03C9 C1		USLA7	POP	B	; ELSE DONE, RESTORE IP
   821 03CA E5			PUSH	H	; (S2) <- REMAINDER
   822 03CB D5			PUSH	D	; (S1) <- QUOTIENT
   823 03CC C3 45 01		JMP	NEXT
   824 			;
   825 03CF			DB	83H	; AND
            83 
   826 03D0			DB	'AN'
            41 4E 
   827 03D2			DB	'D'+80H
            44 80 
   828 03D4			DW	USLAS-5
            7C03 
   829 03D6		ANDD	DW	$+2	; (S1) <- (S1) AND (S2)
            D803 
   830 03D8 D1			POP	D
   831 03D9 E1			POP	H
   832 03DA 7B			MOV	A,E
   833 03DB A5			ANA	L
   834 03DC 6F			MOV	L,A
   835 03DD 7A			MOV	A,D
   836 03DE A4			ANA	H
   837 03DF 67			MOV	H,A
   838 03E0 C3 44 01		JMP	HPUSH
   839 			;
   840 03E3			DB	82H	; OR
            82 
   841 03E4			DB	'O'
            4F 
   842 03E5			DB	'V'+80H
            56 80 
   843 03E7			DW	ANDD-6
            D003 
   844 03E9		ORR	DW	$+2	; (S1) <- (S1) OR (S2)
            EB03 
   845 03EB D1			POP	D
   846 03EC E1			POP	H
   847 03ED 7B			MOV	A,E
   848 03EE B5			ORA	L
   849 03EF 6F			MOV	L,A
   850 03F0 7A			MOV	A,D
   851 03F1 B4			ORA	H
   852 03F2 67			MOV	H,A
   853 03F3 C3 44 01		JMP	HPUSH
   854 			;
   855 03F6			DB	83H	; XOR
            83 
   856 03F7			DB	'XO'
            58 4F 
   857 03F9			DB	'R'+80H
            52 80 
   858 03FB			DW	ORR-5
            E403 
   859 03FD		XORR	DW	$+2	; (S1) <- (S1) XOR (S2)
            FF03 
   860 03FF D1			POP	D
   861 0400 E1			POP	H
   862 0401 7B			MOV	A,E
   863 0402 AD			XRA	L
   864 0403 6F			MOV	L,A
   865 0404 7A			MOV	A,D
   866 0405 AC			XRA	H
   867 0406 67			MOV	H,A
   868 0407 C3 44 01		JMP	HPUSH
   869 			;
   870 040A			DB	83H	; SP@
            83 
   871 040B			DB	'SP'
            53 50 
   872 040D			DB	'@'+80H
            40 80 
   873 040F			DW	XORR-6
            F703 
   874 0411		SPAT	DW	$+2	;(S1) <- (SP)
            1304 
   875 0413 21 00 00		LXI	H,0
   876 0416 39			DAD	SP	; (HL) <- (SP)
   877 0417 C3 44 01		JMP	HPUSH	; (S1) <- (HL)
   878 			;
   879 041A			DB	83H	; STACK POINTER STORE
            83 
   880 041B			DB	'SP'
            53 50 
   881 041D			DB	'!'+80H
            21 80 
   882 041F			DW	SPAT-6
            0B04 
   883 0421		SPSTO	DW	$+2	;(SP) <- (S0) ( USER VARIABLE )
            2304 
   884 0423 2A 26 01		LHLD	UP	; (HL) <- USER VAR BASE ADDR
   885 0426 11 06 00		LXI	D,6
   886 0429 19			DAD	D	; (HL) <- S0
   887 042A 5E			MOV	E,M	; (DE) <- (S0)
   888 042B 23			INX	H
   889 042C 56			MOV	D,M
   890 042D EB			XCHG
   891 042E F9			SPHL		; (SP) <- (S0)
   892 042F C3 45 01		JMP	NEXT
   893 			;
   894 0432			DB	83H	; RP@
            83 
   895 0433			DB	'RP'
            52 50 
   896 0435			DB	'@'+80H
            40 80 
   897 0437			DW	SPSTO-6
            1B04 
   898 0439		RPAT	DW	$+2	;(S1) <- (RP)
            3B04 
   899 043B 2A 28 01		LHLD	RPP
   900 043E C3 44 01		JMP	HPUSH
   901 			;
   902 0441			DB	83H	; RETURN STACK POINTER STORE
            83 
   903 0442			DB	'RP'
            52 50 
   904 0444			DB	'!'+80H
            21 80 
   905 0446			DW	RPAT-6
            3304 
   906 0448		RPSTO	DW	$+2	;(RP) <- (R0) ( USER VARIABLE )
            4A04 
   907 044A 2A 26 01		LHLD	UP	; (HL) <- USER VARIABLE BASE ADDR
   908 044D 11 08 00		LXI	D,8
   909 0450 19			DAD	D	; (HL) <- R0
   910 0451 5E			MOV	E,M	; (DE) <- (R0)
   911 0452 23			INX	H
   912 0453 56			MOV	D,M
   913 0454 EB			XCHG
   914 0455 22 28 01		SHLD	RPP	; (RP) <- (R0)
   915 0458 C3 45 01		JMP	NEXT
   916 			;
   917 045B			DB	82H	; ;S
            82 
   918 045C			DB	3BH ; asm8080 thinks ';' contains a comment start
            3B 
   919 045D			DB	'S'+80H
            53 80 
   920 045F			DW	RPSTO-6
            4204 
   921 0461		SEMIS	DW	$+2	;(IP) <- (R1)
            6304 
   922 0463 2A 28 01		LHLD	RPP
   923 0466 4E			MOV	C,M	; (BC) <- (R1)
   924 0467 23			INX	H
   925 0468 46			MOV	B,M
   926 0469 23			INX	H
   927 046A 22 28 01		SHLD	RPP	; (RP) <- (RP) + 2
   928 046D C3 45 01		JMP	NEXT
   929 			;
   930 0470			DB	85H	; LEAVE
            85 
   931 0471			DB	'LEAV'
            4C 45 41 56 
            
   932 0475			DB	'E'+80H
            45 80 
   933 0477			DW	SEMIS-5
            5C04 
   934 0479		LEAVE	DW	$+2	;LIMIT <- INDEX
            7B04 
   935 047B 2A 28 01		LHLD	RPP
   936 047E 5E			MOV	E,M	; (DE) <- (R1) = INDEX
   937 047F 23			INX	H
   938 0480 56			MOV	D,M
   939 0481 23			INX	H
   940 0482 73			MOV	M,E	; (R2) <- (DE) = LIMIT
   941 0483 23			INX	H
   942 0484 72			MOV	M,D
   943 0485 C3 45 01		JMP	NEXT
   944 			;
   945 0488			DB	82H	; >R
            82 
   946 0489			DB	'>'
            3E 
   947 048A			DB	'R'+80H
            52 80 
   948 048C			DW	LEAVE-8
            7104 
   949 048E		TOR	DW	$+2	;(R1) <- (S1)
            9004 
   950 0490 D1			POP	D	; (DE) <- (S1)
   951 0491 2A 28 01		LHLD	RPP
   952 0494 2B			DCX	H	; (RP) <- (RP) - 2
   953 0495 2B			DCX	H
   954 0496 22 28 01		SHLD	RPP
   955 0499 73			MOV	M,E	; ((HL)) <- (DE)
   956 049A 23			INX	H
   957 049B 72			MOV	M,D
   958 049C C3 45 01		JMP	NEXT
   959 			;
   960 049F			DB	82H	; R>
            82 
   961 04A0			DB	'R'
            52 
   962 04A1			DB	'>'+80H
            3E 80 
   963 04A3			DW	TOR-5
            8904 
   964 04A5		FROMR	DW	$+2	;(S1) <- (R1)
            A704 
   965 04A7 2A 28 01		LHLD	RPP
   966 04AA 5E			MOV	E,M	; (DE) <- (R1)
   967 04AB 23			INX	H
   968 04AC 56			MOV	D,M
   969 04AD 23			INX	H
   970 04AE 22 28 01		SHLD	RPP	; (RP) <- (RP) + 2
   971 04B1 D5			PUSH	D	; (S1) <- (DE)
   972 04B2 C3 45 01		JMP	NEXT
   973 			;
   974 04B5			DB	81H	; R
            81 
   975 04B6			DB	'R'+80H
            52 80 
   976 04B8			DW	FROMR-5
            A004 
   977 04BA		RR	DW	IDO+2
            1502 
   978 			;
   979 04BC			DB	82H	; 0=
            82 
   980 04BD			DB	'0'
            30 
   981 04BE			DB	'='+80H
            3D 80 
   982 04C0			DW	RR-4
            B604 
   983 04C2		ZEQU	DW	$+2
            C404 
   984 04C4 E1			POP	H	; (HL) <- (S1)
   985 04C5 7D			MOV	A,L
   986 04C6 B4			ORA	H	; IF (HL) = 0
   987 04C7 21 00 00		LXI	H,0	; THEN (HL) <- FALSE
   988 04CA C2 CE 04		JNZ	ZEQU1
   989 04CD 23			INX	H	; ELSE (HL) <- TRUE
   990 04CE C3 44 01	ZEQU1	JMP	HPUSH	; (S1) <- (HL)
   991 			;
   992 04D1			DB	82H	; 0<
            82 
   993 04D2			DB	'0'
            30 
   994 04D3			DB	'<'+80H
            3C 80 
   995 04D5			DW	ZEQU-5
            BD04 
   996 04D7		ZLESS	DW	$+2
            D904 
   997 04D9 E1			POP	H	; (HL) <- (S1)
   998 04DA 29			DAD	H	; IF (HL) >= 0
   999 04DB 21 00 00		LXI	H,0	; THEN (HL) <- FALSE
  1000 04DE D2 E2 04		JNC	ZLES1
  1001 04E1 23			INX	H	; ELSE (HL) <- TRUE
  1002 04E2 C3 44 01	ZLES1	JMP	HPUSH	; (S1) <- (HL)
  1003 			;
  1004 04E5			DB	81H	; +
            81 
  1005 04E6			DB	'+'+80H
            2B 80 
  1006 04E8			DW	ZLESS-5
            D204 
  1007 04EA		PLUS	DW	$+2	;(S1) <- (S1) + (S2)
            EC04 
  1008 04EC D1			POP	D
  1009 04ED E1			POP	H
  1010 04EE 19			DAD	D
  1011 04EF C3 44 01		JMP	HPUSH
  1012 			;
  1013 04F2			DB	82H	; D+	(4-2)
            82 
  1014 04F3			DB	'D'	; XLW XHW  YLW YHW  ---  SLW SHW
            44 
  1015 04F4			DB	'+'+80H	; S4  S3   S2  S1        S2  S1
            2B 80 
  1016 04F6			DW	PLUS-4
            E604 
  1017 04F8		DPLUS	DW	$+2
            FA04 
  1018 04FA 21 06 00		LXI	H,6
  1019 04FD 39			DAD	SP	; ((HL)) = XLW
  1020 04FE 5E			MOV	E,M	; (DE) = XLW
  1021 04FF 71			MOV	M,C	; SAVE IP ON STACK
  1022 0500 23			INX	H
  1023 0501 56			MOV	D,M
  1024 0502 70			MOV	M,B
  1025 0503 C1			POP	B	; (BC) <- YHW
  1026 0504 E1			POP	H	; (HL) <- YLW
  1027 0505 19			DAD	D
  1028 0506 EB			XCHG		; (DE) <- YLW + XLW = SUM.LW
  1029 0507 E1			POP	H	; (HL) <- XHW
  1030 0508 7D			MOV	A,L
  1031 0509 89			ADC	C
  1032 050A 6F			MOV	L,A	; (HL) <- YHW + XHW + CARRY
  1033 050B 7C			MOV	A,H
  1034 050C 88			ADC	B
  1035 050D 67			MOV	H,A
  1036 050E C1			POP	B	; RESTORE IP
  1037 050F D5			PUSH	D	; (S2) <- SUM.LW
  1038 0510 C3 44 01		JMP	HPUSH	; (S1) <- SUM.HW
  1039 			;
  1040 0513			DB	85H	; MINUS
            85 
  1041 0514			DB	'MINU'
            4D 49 4E 55 
            
  1042 0518			DB	'S'+80H
            53 80 
  1043 051A			DW	DPLUS-5
            F304 
  1044 051C		MINUS	DW	$+2	;(S1) <- -(S1)	( 2'S COMPLEMENT )
            1E05 
  1045 051E E1			POP	H
  1046 051F 7D			MOV	A,L
  1047 0520 2F			CMA
  1048 0521 6F			MOV	L,A
  1049 0522 7C			MOV	A,H
  1050 0523 2F			CMA
  1051 0524 67			MOV	H,A
  1052 0525 23			INX	H
  1053 0526 C3 44 01		JMP	HPUSH
  1054 			;
  1055 0529			DB	86H	; DMINUS
            86 
  1056 052A			DB	'DMINU'
            44 4D 49 4E 
            55 
  1057 052F			DB	'S'+80H
            53 80 
  1058 0531			DW	MINUS-8
            1405 
  1059 0533		DMINU	DW	$+2
            3505 
  1060 0535 E1			POP	H	; (HL) <- HW
  1061 0536 D1			POP	D	; (DE) <- LW
  1062 0537 97			SUB	A
  1063 0538 93			SUB	E	; (DE) <- 0 - (DE)
  1064 0539 5F			MOV	E,A
  1065 053A 3E 00		MVI	A,0
  1066 053C 9A			SBB	D
  1067 053D 57			MOV	D,A
  1068 053E 3E 00		MVI	A,0
  1069 0540 9D			SBB	L	; (HL) <- 0 - (HL)
  1070 0541 6F			MOV	L,A
  1071 0542 3E 00		MVI	A,0
  1072 0544 9C			SBB	H
  1073 0545 67			MOV	H,A
  1074 0546 D5			PUSH	D	; (S2) <- LW
  1075 0547 C3 44 01		JMP	HPUSH	; (S1) <- HW
  1076 			;
  1077 054A			DB	84H	; OVER
            84 
  1078 054B			DB	'OVE'
            4F 56 45 
  1079 054E			DB	'R'+80H
            52 80 
  1080 0550			DW	DMINU-9
            2A05 
  1081 0552		OVER	DW	$+2
            5405 
  1082 0554 D1			POP	D
  1083 0555 E1			POP	H
  1084 0556 E5			PUSH	H
  1085 0557 C3 43 01		JMP	DPUSH
  1086 			;
  1087 055A			DB	84H	; DROP
            84 
  1088 055B			DB	'DRO'
            44 52 4F 
  1089 055E			DB	'P'+80H
            50 80 
  1090 0560			DW	OVER-7
            4B05 
  1091 0562		DROP	DW	$+2
            6405 
  1092 0564 E1			POP	H
  1093 0565 C3 45 01		JMP	NEXT
  1094 			;
  1095 0568			DB	84H	; SWAP
            84 
  1096 0569			DB	'SWA'
            53 57 41 
  1097 056C			DB	'P'+80H
            50 80 
  1098 056E			DW	DROP-7
            5B05 
  1099 0570		SWAP	DW	$+2
            7205 
  1100 0572 E1			POP	H
  1101 0573 E3			XTHL
  1102 0574 C3 44 01		JMP	HPUSH
  1103 			;
  1104 0577			DB	83H	; DUP
            83 
  1105 0578			DB	'DU'
            44 55 
  1106 057A			DB	'P'+80H
            50 80 
  1107 057C			DW	SWAP-7
            6905 
  1108 057E		DUP	DW	$+2
            8005 
  1109 0580 E1			POP	H
  1110 0581 E5			PUSH	H
  1111 0582 C3 44 01		JMP	HPUSH
  1112 			;
  1113 0585			DB	84H	; 2DUP
            84 
  1114 0586			DB	'2DU'
            32 44 55 
  1115 0589			DB	'P'+80H
            50 80 
  1116 058B			DW	DUP-6
            7805 
  1117 058D		TDUP	DW	$+2
            8F05 
  1118 058F E1			POP	H
  1119 0590 D1			POP	D
  1120 0591 D5			PUSH	D
  1121 0592 E5			PUSH	H
  1122 0593 C3 43 01		JMP	DPUSH
  1123 			;
  1124 0596			DB	82H	; PLUS STORE
            82 
  1125 0597			DB	'+'
            2B 
  1126 0598			DB	'!'+80H
            21 80 
  1127 059A			DW	TDUP-7
            8605 
  1128 059C		PSTOR	DW	$+2	;((S1)) <- ((S1)) + (S2)
            9E05 
  1129 059E E1			POP	H	; (HL) <- (S1) = ADDR
  1130 059F D1			POP	D	; (DE) <- (S2) = INCR
  1131 05A0 7E			MOV	A,M	; ((HL)) <- ((HL)) + (DE)
  1132 05A1 83			ADD	E
  1133 05A2 77			MOV	M,A
  1134 05A3 23			INX	H
  1135 05A4 7E			MOV	A,M
  1136 05A5 8A			ADC	D
  1137 05A6 77			MOV	M,A
  1138 05A7 C3 45 01		JMP	NEXT
  1139 			;
  1140 05AA			DB	86H	; TOGGLE
            86 
  1141 05AB			DB	'TOGGL'
            54 4F 47 47 
            4C 
  1142 05B0			DB	'E'+80H
            45 80 
  1143 05B2			DW	PSTOR-5
            9705 
  1144 05B4		TOGGL	DW	$+2	;((S2)) <- ((S2)) XOR (S1)LB
            B605 
  1145 05B6 D1			POP	D	; (E) <- BYTE MASK
  1146 05B7 E1			POP	H	; (HL) <- ADDR
  1147 05B8 7E			MOV	A,M
  1148 05B9 AB			XRA	E
  1149 05BA 77			MOV	M,A	; (ADDR) <- (ADDR) XOR (E)
  1150 05BB C3 45 01		JMP	NEXT
  1151 			;
  1152 05BE			DB	81H	; @
            81 
  1153 05BF			DB	'@'+80H
            40 80 
  1154 05C1			DW	TOGGL-9
            AB05 
  1155 05C3		AT	DW	$+2	;(S1) <- ((S1))
            C505 
  1156 05C5 E1			POP	H	; (HL) <- ADDR
  1157 05C6 5E			MOV	E,M	; (DE) <- (ADDR)
  1158 05C7 23			INX	H
  1159 05C8 56			MOV	D,M
  1160 05C9 D5			PUSH	D	; (S1) <- (DE)
  1161 05CA C3 45 01		JMP	NEXT
  1162 			;
  1163 05CD			DB	82H	; C@
            82 
  1164 05CE			DB	'C'
            43 
  1165 05CF			DB	'@'+80H
            40 80 
  1166 05D1			DW	AT-4
            BF05 
  1167 05D3		CAT	DW	$+2	;(S1) <- ((S1))LB
            D505 
  1168 05D5 E1			POP	H	; (HL) <- ADDR
  1169 05D6 6E			MOV	L,M	; (HL) <- (ADDR)LB
  1170 05D7 26 00		MVI	H,0
  1171 05D9 C3 44 01		JMP	HPUSH
  1172 			;
  1173 05DC			DB	82H	; 2@
            82 
  1174 05DD			DB	'2'
            32 
  1175 05DE			DB	'@'+80H
            40 80 
  1176 05E0			DW	CAT-5
            CE05 
  1177 05E2		TAT	DW	$+2
            E405 
  1178 05E4 E1			POP	H	; (HL) <- ADDR HW
  1179 05E5 11 02 00		LXI	D,2
  1180 05E8 19			DAD	D	; (HL) <- ADDR LW
  1181 05E9 5E			MOV	E,M	; (DE) <- LW
  1182 05EA 23			INX	H
  1183 05EB 56			MOV	D,M
  1184 05EC D5			PUSH	D	; (S2) <- LW
  1185 05ED 11 FD FF		LXI	D,-3	; (HL) <- ADDR HW
  1186 05F0 19			DAD	D
  1187 05F1 5E			MOV	E,M	; (DE) <- HW
  1188 05F2 23			INX	H
  1189 05F3 56			MOV	D,M
  1190 05F4 D5			PUSH	D	; (S1) <- HW
  1191 05F5 C3 45 01		JMP	NEXT
  1192 			;
  1193 05F8			DB	81H	; STORE
            81 
  1194 05F9			DB	'!'+80H
            21 80 
  1195 05FB			DW	TAT-5
            DD05 
  1196 05FD		STORE	DW	$+2	;((S1)) <- (S2)
            FF05 
  1197 05FF E1			POP	H	; (HL) <- (S1) = ADDR
  1198 0600 D1			POP	D	; (DE) <- (S2) = VALUE
  1199 0601 73			MOV	M,E	; ((HL)) <- (DE)
  1200 0602 23			INX	H
  1201 0603 72			MOV	M,D
  1202 0604 C3 45 01		JMP	NEXT
  1203 			;
  1204 0607			DB	82H	; C STORE
            82 
  1205 0608			DB	'C'
            43 
  1206 0609			DB	'!'+80H
            21 80 
  1207 060B			DW	STORE-4
            F905 
  1208 060D		CSTOR	DW	$+2	;((S1))LB <- (S2)LB
            0F06 
  1209 060F E1			POP	H	; (HL) <- (S1) = ADDR
  1210 0610 D1			POP	D	; (DE) <- (S2) = BYTE
  1211 0611 73			MOV	M,E	; ((HL))LB <- (E)
  1212 0612 C3 45 01		JMP	NEXT
  1213 			;
  1214 0615			DB	82H	; 2 STORE
            82 
  1215 0616			DB	'2'
            32 
  1216 0617			DB	'!'+80H
            21 80 
  1217 0619			DW	CSTOR-5
            0806 
  1218 061B		TSTOR	DW	$+2
            1D06 
  1219 061D E1			POP	H	; (HL) <- ADDR
  1220 061E D1			POP	D	; (DE) <- HW
  1221 061F 73			MOV	M,E	; (ADDR) <- HW
  1222 0620 23			INX	H
  1223 0621 72			MOV	M,D
  1224 0622 23			INX	H	; (HL) <- ADDR LW
  1225 0623 D1			POP	D	; (DE) <- LW
  1226 0624 73			MOV	M,E	; (ADDR+2) <- LW
  1227 0625 23			INX	H
  1228 0626 72			MOV	M,D
  1229 0627 C3 45 01		JMP	NEXT
  1230 			;
  1231 062A			DB	0C1H	; :
            C1 
  1232 062B			DB	':'+80H
            3A 80 
  1233 062D			DW	TSTOR-5
            1606 
  1234 062F		COLON	DW	DOCOL
            4306 
  1235 0631			DW	QEXEC
            190A 
  1236 0633			DW	SCSP
            D109 
  1237 0635			DW	CURR
            ED07 
  1238 0637			DW	AT
            C305 
  1239 0639			DW	CONT
            DF07 
  1240 063B			DW	STORE
            FD05 
  1241 063D			DW	CREAT
            0E0F 
  1242 063F			DW	RBRAC
            A40A 
  1243 0641			DW	PSCOD
            FB0A 
  1244 0643 2A 28 01	DOCOL	LHLD	RPP
  1245 0646 2B			DCX	H	; (R1) <- (IP)
  1246 0647 70			MOV	M,B
  1247 0648 2B			DCX	H	; (RP) <- (RP) - 2
  1248 0649 71			MOV	M,C
  1249 064A 22 28 01		SHLD	RPP
  1250 064D 13			INX	D	; (DE) <- CFA+2 = (W)
  1251 064E 4B			MOV	C,E	; (IP) <- (DE) = (W)
  1252 064F 42			MOV	B,D
  1253 0650 C3 45 01		JMP	NEXT
  1254 			;
  1255 0653			DB	0C1H	; ;
            C1 
  1256 0654			DB	0BBH ; asm8080 thinks ';'+80H contains a comment start
            BB 
  1257 0655			DW	COLON-4
            2B06 
  1258 0657		SEMI	DW	DOCOL
            4306 
  1259 0659			DW	QCSP
            450A 
  1260 065B			DW	COMP
            7E0A 
  1261 065D			DW	SEMIS
            6104 
  1262 065F			DW	SMUDG
            BA0A 
  1263 0661			DW	LBRAC
            950A 
  1264 0663			DW	SEMIS
            6104 
  1265 			;
  1266 0665			DB	84H	; NOOP
            84 
  1267 0666			DB	'NOO'
            4E 4F 4F 
  1268 0669			DB	'P'+80H
            50 80 
  1269 066B			DW	SEMI-4
            5306 
  1270 066D		NOOP	DW	DOCOL
            4306 
  1271 066F			DW	SEMIS
            6104 
  1272 			 ;
  1273 0671			DB	88H	; CONSTANT
            88 
  1274 0672			DB	'CONSTAN'
            43 4F 4E 53 
            54 41 4E 
  1275 0679			DB	'T'+80H
            54 80 
  1276 067B			DW	NOOP-7
            6606 
  1277 067D		CON	DW	DOCOL
            4306 
  1278 067F			DW	CREAT
            0E0F 
  1279 0681			DW	SMUDG
            BA0A 
  1280 0683			DW	COMMA
            7B08 
  1281 0685			DW	PSCOD
            FB0A 
  1282 0687 13		DOCON	INX	D	; (DE) <- PFA
  1283 0688 EB			XCHG
  1284 0689 5E			MOV	E,M	; (DE) <- (PFA)
  1285 068A 23			INX	H
  1286 068B 56			MOV	D,M
  1287 068C D5			PUSH	D	; (S1) <- (PFA)
  1288 068D C3 45 01		JMP	NEXT
  1289 			;
  1290 0690			DB	88H	; VARIABLE
            88 
  1291 0691			DB	'VARIABL'
            56 41 52 49 
            41 42 4C 
  1292 0698			DB	'E'+80H
            45 80 
  1293 069A			DW	CON-0BH
            7206 
  1294 069C		VAR	DW	DOCOL
            4306 
  1295 069E			DW	CON
            7D06 
  1296 06A0			DW	PSCOD
            FB0A 
  1297 06A2 13		DOVAR	INX	D	; (DE) <- PFA
  1298 06A3 D5			PUSH	D	; (S1) <- PFA
  1299 06A4 C3 45 01		JMP	NEXT
  1300 			;
  1301 06A7			DB	84H	; USER
            84 
  1302 06A8			DB	'USE'
            55 53 45 
  1303 06AB			DB	'R'+80H
            52 80 
  1304 06AD			DW	VAR-0BH
            9106 
  1305 06AF		USER	DW	DOCOL
            4306 
  1306 06B1			DW	CON
            7D06 
  1307 06B3			DW	PSCOD
            FB0A 
  1308 06B5 13		DOUSE	INX	D	; (DE) <- PFA
  1309 06B6 EB			XCHG
  1310 06B7 5E			MOV	E,M	; (DE) <- USER VARIABLE OFFSET
  1311 06B8 16 00		MVI	D,0
  1312 06BA 2A 26 01		LHLD	UP	; (HL) <- USER VARIABLE BASE ADDR
  1313 06BD 19			DAD	D	; (HL) <- (HL) + (DE)
  1314 06BE C3 44 01		JMP	HPUSH	; (S1) <- BASE + OFFSET
  1315 			;
  1316 06C1			DB	81H	; 0
            81 
  1317 06C2			DB	'0'+80H
            30 80 
  1318 06C4			DW	USER-7
            A806 
  1319 06C6		ZERO	DW	DOCON
            8706 
  1320 06C8			DW	0
            0000 
  1321 			;
  1322 06CA			DB	81H	; 1
            81 
  1323 06CB			DB	'1'+80H
            31 80 
  1324 06CD			DW	ZERO-4
            C206 
  1325 06CF		ONE	DW	DOCON
            8706 
  1326 06D1			DW	1
            0100 
  1327 			;
  1328 06D3			DB	81H	; 2
            81 
  1329 06D4			DB	'2'+80H
            32 80 
  1330 06D6			DW	ONE-4
            CB06 
  1331 06D8		TWO	DW	DOCON
            8706 
  1332 06DA			DW	2
            0200 
  1333 			;
  1334 06DC			DB	81H	; 3
            81 
  1335 06DD			DB	'3'+80H
            33 80 
  1336 06DF			DW	TWO-4
            D406 
  1337 06E1		THREE	DW	DOCON
            8706 
  1338 06E3			DW	3
            0300 
  1339 			;
  1340 06E5			DB	82H	; BL
            82 
  1341 06E6			DB	'B'
            42 
  1342 06E7			DB	'L'+80H
            4C 80 
  1343 06E9			DW	THREE-4
            DD06 
  1344 06EB		BL	DW	DOCON
            8706 
  1345 06ED			DW	20H
            2000 
  1346 			;
  1347 06EF			DB	83H	; C/L ( CHARACTERS/LINE )
            83 
  1348 06F0			DB	'C/'
            43 2F 
  1349 06F2			DB	'L'+80H
            4C 80 
  1350 06F4			DW	BL-5
            E606 
  1351 06F6		CSLL	DW	DOCON
            8706 
  1352 06F8			DW	64
            4000 
  1353 			;
  1354 06FA			DB	85H	; FIRST
            85 
  1355 06FB			DB	'FIRS'
            46 49 52 53 
            
  1356 06FF			DB	'T'+80H
            54 80 
  1357 0701			DW	CSLL-6
            F006 
  1358 0703		FIRST	DW	DOCON
            8706 
  1359 0705			DW	BUF1
            E0F3 
  1360 			;
  1361 0707			DB	85H	; LIMIT
            85 
  1362 0708			DB	'LIMI'
            4C 49 4D 49 
            
  1363 070C			DB	'T'+80H
            54 80 
  1364 070E			DW	FIRST-8
            FB06 
  1365 0710		LIMIT	DW	DOCON
            8706 
  1366 0712			DW	EM
            00F8 
  1367 			;
  1368 0714			DB	85H	; B/BUF ( BYTES/BUFFER )
            85 
  1369 0715			DB	'B/BU'
            42 2F 42 55 
            
  1370 0719			DB	'F'+80H
            46 80 
  1371 071B			DW	LIMIT-8
            0807 
  1372 071D		BBUF	DW	DOCON
            8706 
  1373 071F			DW	KBBUF
            8000 
  1374 			;
  1375 0721			DB	85H	; B/SCR ( BUFFERS/SCREEN )
            85 
  1376 0722			DB	'B/SC'
            42 2F 53 43 
            
  1377 0726			DB	'R'+80H
            52 80 
  1378 0728			DW	BBUF-8
            1507 
  1379 072A		BSCR	DW	DOCON
            8706 
  1380 072C			DW	400H/KBBUF
            0800 
  1381 			;
  1382 072E			DB	87H	; +ORIGIN
            87 
  1383 072F			DB	'+ORIGI'
            2B 4F 52 49 
            47 49 
  1384 0735			DB	'N'+80H
            4E 80 
  1385 0737			DW	BSCR-8
            2207 
  1386 0739		PORIG	DW	DOCOL
            4306 
  1387 073B			DW	LIT
            5701 
  1388 073D			DW	ORIG
            0001 
  1389 073F			DW	PLUS
            EA04 
  1390 0741			DW	SEMIS
            6104 
  1391 			;
  1392 			;	USER VARIABLES
  1393 			;
  1394 0743			DB	82H	; S0
            82 
  1395 0744			DB	'S'
            53 
  1396 0745			DB	'0'+80H
            30 80 
  1397 0747			DW	PORIG-0AH
            2F07 
  1398 0749		SZERO	DW	DOUSE
            B506 
  1399 074B			DW	6
            0600 
  1400 			;
  1401 074D			DB	82H	; R0
            82 
  1402 074E			DB	'R'
            52 
  1403 074F			DB	'0'+80H
            30 80 
  1404 0751			DW	SZERO-5
            4407 
  1405 0753		RZERO	DW	DOUSE
            B506 
  1406 0755			DW	8
            0800 
  1407 			;
  1408 0757			DB	83H	; TIB
            83 
  1409 0758			DB	'TI'
            54 49 
  1410 075A			DB	'B'+80H
            42 80 
  1411 075C			DW	RZERO-5
            4E07 
  1412 075E		TIB	DW	DOUSE
            B506 
  1413 0760			DB	0AH
            0A 
  1414 			;
  1415 0761			DB	85H	; WIDTH
            85 
  1416 0762			DB	'WIDT'
            57 49 44 54 
            
  1417 0766			DB	'H'+80H
            48 80 
  1418 0768			DW	TIB-6
            5807 
  1419 076A		WIDTH	DW	DOUSE
            B506 
  1420 076C			DB	0CH
            0C 
  1421 			;
  1422 076D			DB	87H	; WARNING
            87 
  1423 076E			DB	'WARNIN'
            57 41 52 4E 
            49 4E 
  1424 0774			DB	'G'+80H
            47 80 
  1425 0776			DW	WIDTH-8
            6207 
  1426 0778		WARN	DW	DOUSE
            B506 
  1427 077A			DB	0EH
            0E 
  1428 			;
  1429 077B			DB	85H	; FENCE
            85 
  1430 077C			DB	'FENC'
            46 45 4E 43 
            
  1431 0780			DB	'E'+80H
            45 80 
  1432 0782			DW	WARN-0AH
            6E07 
  1433 0784		FENCE	DW	DOUSE
            B506 
  1434 0786			DB	10H
            10 
  1435 			;
  1436 0787			DB	82H	; DP
            82 
  1437 0788			DB	'D'
            44 
  1438 0789			DB	'P'+80H
            50 80 
  1439 078B			DW	FENCE-8
            7C07 
  1440 078D		DP	DW	DOUSE
            B506 
  1441 078F			DB	12H
            12 
  1442 			;
  1443 0790			DB	88H	; VOC-LINK
            88 
  1444 0791			DB	'VOC-LIN'
            56 4F 43 2D 
            4C 49 4E 
  1445 0798			DB	'K'+80H
            4B 80 
  1446 079A			DW	DP-5
            8807 
  1447 079C		VOCL	DW	DOUSE
            B506 
  1448 079E			DW	14H
            1400 
  1449 			;
  1450 07A0			DB	83H	; BLK
            83 
  1451 07A1			DB	'BL'
            42 4C 
  1452 07A3			DB	'K'+80H
            4B 80 
  1453 07A5			DW	VOCL-0BH
            9107 
  1454 07A7		BLK	DW	DOUSE
            B506 
  1455 07A9			DB	16H
            16 
  1456 			;
  1457 07AA			DB	82H	; IN
            82 
  1458 07AB			DB	'I'
            49 
  1459 07AC			DB	'N'+80H
            4E 80 
  1460 07AE			DW	BLK-6
            A107 
  1461 07B0		INN	DW	DOUSE
            B506 
  1462 07B2			DB	18H
            18 
  1463 			;
  1464 07B3			DB	83H	; OUT
            83 
  1465 07B4			DB	'OU'
            4F 55 
  1466 07B6			DB	'T'+80H
            54 80 
  1467 07B8			DW	INN-5
            AB07 
  1468 07BA		OUTT	DW	DOUSE
            B506 
  1469 07BC			DB	1AH
            1A 
  1470 			;
  1471 07BD			DB	83H	; SCR
            83 
  1472 07BE			DB	'SC'
            53 43 
  1473 07C0			DB	'R'+80H
            52 80 
  1474 07C2			DW	OUTT-6
            B407 
  1475 07C4		SCR	DW	DOUSE
            B506 
  1476 07C6			DB	1CH
            1C 
  1477 			;
  1478 07C7			DB	86H	; OFFSET
            86 
  1479 07C8			DB	'OFFSE'
            4F 46 46 53 
            45 
  1480 07CD			DB	'T'+80H
            54 80 
  1481 07CF			DW	SCR-6
            BE07 
  1482 07D1		OFSET	DW	DOUSE
            B506 
  1483 07D3			DB	1EH
            1E 
  1484 			;
  1485 07D4			DB	87H	; CONTEXT
            87 
  1486 07D5			DB	'CONTEX'
            43 4F 4E 54 
            45 58 
  1487 07DB			DB	'T'+80H
            54 80 
  1488 07DD			DW	OFSET-9
            C807 
  1489 07DF		CONT	DW	DOUSE
            B506 
  1490 07E1			DB	20H
            20 
  1491 			;
  1492 07E2			DB	87H	; CURRENT
            87 
  1493 07E3			DB	'CURREN'
            43 55 52 52 
            45 4E 
  1494 07E9			DB	'T'+80H
            54 80 
  1495 07EB			DW	CONT-0AH
            D507 
  1496 07ED		CURR	DW	DOUSE
            B506 
  1497 07EF			DB	22H
            22 
  1498 			;
  1499 07F0			DB	85H	; STATE
            85 
  1500 07F1			DB	'STAT'
            53 54 41 54 
            
  1501 07F5			DB	'E'+80H
            45 80 
  1502 07F7			DW	CURR-0AH
            E307 
  1503 07F9		STATE	DW	DOUSE
            B506 
  1504 07FB			DB	24H
            24 
  1505 			;
  1506 07FC			DB	84H	; BASE
            84 
  1507 07FD			DB	'BAS'
            42 41 53 
  1508 0800			DB	'E'+80H
            45 80 
  1509 0802			DW	STATE-8
            F107 
  1510 0804		BASE	DW	DOUSE
            B506 
  1511 0806			DB	26H
            26 
  1512 			;
  1513 0807			DB	83H	; DPL
            83 
  1514 0808			DB	'DP'
            44 50 
  1515 080A			DB	'L'+80H
            4C 80 
  1516 080C			DW	BASE-7
            FD07 
  1517 080E		DPL	DW	DOUSE
            B506 
  1518 0810			DB	28H
            28 
  1519 			;
  1520 0811			DB	83H	; FLD
            83 
  1521 0812			DB	'FL'
            46 4C 
  1522 0814			DB	'D'+80H
            44 80 
  1523 0816			DW	DPL-6
            0808 
  1524 0818		FLD	DW	DOUSE
            B506 
  1525 081A			DB	2AH
            2A 
  1526 			;
  1527 081B			DB	83H	; CSP
            83 
  1528 081C			DB	'CS'
            43 53 
  1529 081E			DB	'P'+80H
            50 80 
  1530 0820			DW	FLD-6
            1208 
  1531 0822		CSPP	DW	DOUSE
            B506 
  1532 0824			DB	2CH
            2C 
  1533 			;
  1534 0825			DB	82H	; R#
            82 
  1535 0826			DB	'R'
            52 
  1536 0827			DB	'#'+80H
            23 80 
  1537 0829			DW	CSPP-6
            1C08 
  1538 082B		RNUM	DW	DOUSE
            B506 
  1539 082D			DB	2EH
            2E 
  1540 			;
  1541 082E			DB	83H	; HLD
            83 
  1542 082F			DB	'HL'
            48 4C 
  1543 0831			DB	'D'+80H
            44 80 
  1544 0833			DW	RNUM-5
            2608 
  1545 0835		HLD	DW	DOUSE
            B506 
  1546 0837			DW	30H
            3000 
  1547 			;
  1548 			;	END OF USER VARIABLES
  1549 			;
  1550 0839			DB	82H	; 1+
            82 
  1551 083A			DB	'1'
            31 
  1552 083B			DB	'+'+80H
            2B 80 
  1553 083D			DW	HLD-6
            2F08 
  1554 083F		ONEP	DW	DOCOL
            4306 
  1555 0841			DW	ONE
            CF06 
  1556 0843			DW	PLUS
            EA04 
  1557 0845			DW	SEMIS
            6104 
  1558 			;
  1559 0847			DB	82H	; 2+
            82 
  1560 0848			DB	'2'
            32 
  1561 0849			DB	'+'+80H
            2B 80 
  1562 084B			DW	ONEP-5
            3A08 
  1563 084D		TWOP	DW	DOCOL
            4306 
  1564 084F			DW	TWO
            D806 
  1565 0851			DW	PLUS
            EA04 
  1566 0853			DW	SEMIS
            6104 
  1567 			;
  1568 0855			DB	84H	; HERE
            84 
  1569 0856			DB	'HER'
            48 45 52 
  1570 0859			DB	'E'+80H
            45 80 
  1571 085B			DW	TWOP-5
            4808 
  1572 085D		HERE	DW	DOCOL
            4306 
  1573 085F			DW	DP
            8D07 
  1574 0861			DW	AT
            C305 
  1575 0863			DW	SEMIS
            6104 
  1576 			;
  1577 0865			DB	85H	; ALLOT
            85 
  1578 0866			DB	'ALLO'
            41 4C 4C 4F 
            
  1579 086A			DB	'T'+80H
            54 80 
  1580 086C			DW	HERE-7
            5608 
  1581 086E		ALLOT	DW	DOCOL
            4306 
  1582 0870			DW	DP
            8D07 
  1583 0872			DW	PSTOR
            9C05 
  1584 0874			DW	SEMIS
            6104 
  1585 			;
  1586 0876			DB	81H	; ,
            81 
  1587 0877			DB	','+80H
            2C 80 
  1588 0879			DW	ALLOT-8
            6608 
  1589 087B		COMMA	DW	DOCOL
            4306 
  1590 087D			DW	HERE
            5D08 
  1591 087F			DW	STORE
            FD05 
  1592 0881			DW	TWO
            D806 
  1593 0883			DW	ALLOT
            6E08 
  1594 0885			DW	SEMIS
            6104 
  1595 			;
  1596 0887			DB	82H	; C,
            82 
  1597 0888			DB	'C'
            43 
  1598 0889			DB	','+80H
            2C 80 
  1599 088B			DW	COMMA-4
            7708 
  1600 088D		CCOMM	DW	DOCOL
            4306 
  1601 088F			DW	HERE
            5D08 
  1602 0891			DW	CSTOR
            0D06 
  1603 0893			DW	ONE
            CF06 
  1604 0895			DW	ALLOT
            6E08 
  1605 0897			DW	SEMIS
            6104 
  1606 			;
  1607 			;	SUBROUTINE USED BY - AND <
  1608 			;			; (HL) <- (HL) - (DE)
  1609 0899 7D		SSUB	MOV	A,L	; LB
  1610 089A 93			SUB	E
  1611 089B 6F			MOV	L,A
  1612 089C 7C			MOV	A,H	; HB
  1613 089D 9A			SBB	D
  1614 089E 67			MOV	H,A
  1615 089F C9			RET
  1616 			;
  1617 08A0			DB	81H	; -
            81 
  1618 08A1			DB	'-'+80H
            2D 80 
  1619 08A3			DW	CCOMM-5
            8808 
  1620 08A5		SUBB	DW	$+2
            A708 
  1621 08A7 D1			POP	D	; (DE) <- (S1) = Y
  1622 08A8 E1			POP	H	; (HL) <- (S2) = X
  1623 08A9 CD 99 08		CALL	SSUB
  1624 08AC C3 44 01		JMP	HPUSH	; (S1) <- X - Y
  1625 			;
  1626 08AF			DB	81H	; =
            81 
  1627 08B0			DB	'='+80H
            3D 80 
  1628 08B2			DW	SUBB-4
            A108 
  1629 08B4		EQUAL	DW	DOCOL
            4306 
  1630 08B6			DW	SUBB
            A508 
  1631 08B8			DW	ZEQU
            C204 
  1632 08BA			DW	SEMIS
            6104 
  1633 			;
  1634 08BC			DB	81H	; <
            81 
  1635 08BD			DB	'<'+80H		; X  <  Y
            3C 80 
  1636 08BF			DW	EQUAL-4		; S2    S1
            B008 
  1637 08C1		LESS	DW	$+2
            C308 
  1638 08C3 D1			POP	D	; (DE) <- (S1) = Y
  1639 08C4 E1			POP	H	; (HL) <- (S2) = X
  1640 08C5 7A			MOV	A,D	; IF X & Y HAVE SAME SIGNS
  1641 08C6 AC			XRA	H
  1642 08C7 FA CD 08		JM	LES1
  1643 08CA CD 99 08		CALL	SSUB	; (HL) <- X - Y
  1644 08CD 24		LES1	INR	H	; IF (HL) >= 0
  1645 08CE 25			DCR	H
  1646 08CF FA D8 08		JM	LES2
  1647 08D2 21 00 00		LXI	H,0	; THEN X >= Y
  1648 08D5 C3 44 01		JMP	HPUSH	; (S1) <- FALSE
  1649 08D8 21 01 00	LES2	LXI	H,1	; ELSE X < Y
  1650 08DB C3 44 01		JMP	HPUSH	; (S1) <- TRUE
  1651 			;
  1652 08DE			DB	82H	; U< ( UNSIGNED < )
            82 
  1653 08DF			DB	'U'
            55 
  1654 08E0			DB	'<'+80H
            3C 80 
  1655 08E2			DW	LESS-4
            BD08 
  1656 08E4		ULESS	DW	DOCOL,TDUP
            4306 8D05 
  1657 08E8			DW	XORR,ZLESS
            FD03 D704 
  1658 08EC			DW	ZBRAN,ULES1-$	; IF
            9601 0E00 
  1659 08F0			DW	DROP,ZLESS
            6205 D704 
  1660 08F4			DW	ZEQU
            C204 
  1661 08F6			DW	BRAN,ULES2-$
            7D01 0800 
  1662 08FA		ULES1	DW	SUBB,ZLESS	; ELSE
            A508 D704 
  1663 08FE		ULES2	DW	SEMIS		; ENDIF
            6104 
  1664 			;
  1665 0900			DB	81H	; >
            81 
  1666 0901			DB	'>'+80H
            3E 80 
  1667 0903			DW	ULESS-5
            DF08 
  1668 0905		GREAT	DW	DOCOL
            4306 
  1669 0907			DW	SWAP
            7005 
  1670 0909			DW	LESS
            C108 
  1671 090B			DW	SEMIS
            6104 
  1672 			;
  1673 090D			DB	83H	; ROT
            83 
  1674 090E			DB	'RO'
            52 4F 
  1675 0910			DB	'T'+80H
            54 80 
  1676 0912			DW	GREAT-4
            0109 
  1677 0914		ROT	DW	$+2
            1609 
  1678 0916 D1			POP	D
  1679 0917 E1			POP	H
  1680 0918 E3			XTHL
  1681 0919 C3 43 01		JMP	DPUSH
  1682 			;
  1683 091C			DB	85H	; SPACE
            85 
  1684 091D			DB	'SPAC'
            53 50 41 43 
            
  1685 0921			DB	'E'+80H
            45 80 
  1686 0923			DW	ROT-6
            0E09 
  1687 0925		SPACE	DW	DOCOL
            4306 
  1688 0927			DW	BL
            EB06 
  1689 0929			DW	EMIT
            EC02 
  1690 092B			DW	SEMIS
            6104 
  1691 			;
  1692 092D			DB	84H	; -DUP
            84 
  1693 092E			DB	'-DU'
            2D 44 55 
  1694 0931			DB	'P'+80H
            50 80 
  1695 0933			DW	SPACE-8
            1D09 
  1696 0935		DDUP	DW	DOCOL
            4306 
  1697 0937			DW	DUP
            7E05 
  1698 0939			DW	ZBRAN	; IF
            9601 
  1699 093B			DW	DDUP1-$
            0400 
  1700 093D			DW	DUP	; ENDIF
            7E05 
  1701 093F		DDUP1	DW	SEMIS
            6104 
  1702 			;
  1703 0941			DB	88H	; TRAVERSE
            88 
  1704 0942			DB	'TRAVERS'
            54 52 41 56 
            45 52 53 
  1705 0949			DB	'E'+80H
            45 80 
  1706 094B			DW	DDUP-7
            2E09 
  1707 094D		TRAV	DW	DOCOL
            4306 
  1708 094F			DW	SWAP
            7005 
  1709 0951		TRAV1	DW	OVER	; BEGIN
            5205 
  1710 0953			DW	PLUS
            EA04 
  1711 0955			DW	LIT
            5701 
  1712 0957			DW	7FH
            7F00 
  1713 0959			DW	OVER
            5205 
  1714 095B			DW	CAT
            D305 
  1715 095D			DW	LESS
            C108 
  1716 095F			DW	ZBRAN	; UNTIL
            9601 
  1717 0961			DW	TRAV1-$
            F0FFFFFFFF 
  1718 0963			DW	SWAP
            7005 
  1719 0965			DW	DROP
            6205 
  1720 0967			DW	SEMIS
            6104 
  1721 			;
  1722 0969			DB	86H	; LATEST
            86 
  1723 096A			DB	'LATES'
            4C 41 54 45 
            53 
  1724 096F			DB	'T'+80H
            54 80 
  1725 0971			DW	TRAV-0BH
            4209 
  1726 0973		LATES	DW	DOCOL
            4306 
  1727 0975			DW	CURR
            ED07 
  1728 0977			DW	AT
            C305 
  1729 0979			DW	AT
            C305 
  1730 097B			DW	SEMIS
            6104 
  1731 			;
  1732 097D			DB	83H	; LFA
            83 
  1733 097E			DB	'LF'
            4C 46 
  1734 0980			DB	'A'+80H
            41 80 
  1735 0982			DW	LATES-9
            6A09 
  1736 0984		LFA	DW	DOCOL
            4306 
  1737 0986			DW	LIT
            5701 
  1738 0988			DW	4
            0400 
  1739 098A			DW	SUBB
            A508 
  1740 098C			DW	SEMIS
            6104 
  1741 			;
  1742 098E			DB	83H	; CFA
            83 
  1743 098F			DB	'CF'
            43 46 
  1744 0991			DB	'A'+80H
            41 80 
  1745 0993			DW	LFA-6
            7E09 
  1746 0995		CFA	DW	DOCOL
            4306 
  1747 0997			DW	TWO
            D806 
  1748 0999			DW	SUBB
            A508 
  1749 099B			DW	SEMIS
            6104 
  1750 			;
  1751 099D			DB	83H	; NFA
            83 
  1752 099E			DB	'NF'
            4E 46 
  1753 09A0			DB	'A'+80H
            41 80 
  1754 09A2			DW	CFA-6
            8F09 
  1755 09A4		NFA	DW	DOCOL
            4306 
  1756 09A6			DW	LIT
            5701 
  1757 09A8			DW	5
            0500 
  1758 09AA			DW	SUBB
            A508 
  1759 09AC			DW	LIT
            5701 
  1760 09AE			DW	-1
            FFFFFFFFFF 
  1761 09B0			DW	TRAV
            4D09 
  1762 09B2			DW	SEMIS
            6104 
  1763 			;
  1764 09B4			DB	83H	; PFA
            83 
  1765 09B5			DB	'PF'
            50 46 
  1766 09B7			DB	'A'+80H
            41 80 
  1767 09B9			DW	NFA-6
            9E09 
  1768 09BB		PFA	DW	DOCOL
            4306 
  1769 09BD			DW	ONE
            CF06 
  1770 09BF			DW	TRAV
            4D09 
  1771 09C1			DW	LIT
            5701 
  1772 09C3			DW	5
            0500 
  1773 09C5			DW	PLUS
            EA04 
  1774 09C7			DW	SEMIS
            6104 
  1775 			;
  1776 09C9			DB	84H	; STORE CSP
            84 
  1777 09CA			DB	'!CS'
            21 43 53 
  1778 09CD			DB	'P'+80H
            50 80 
  1779 09CF			DW	PFA-6
            B509 
  1780 09D1		SCSP	DW	DOCOL
            4306 
  1781 09D3			DW	SPAT
            1104 
  1782 09D5			DW	CSPP
            2208 
  1783 09D7			DW	STORE
            FD05 
  1784 09D9			DW	SEMIS
            6104 
  1785 			;
  1786 09DB			DB	86H	; ?ERROR
            86 
  1787 09DC			DB	'?ERRO'
            3F 45 52 52 
            4F 
  1788 09E1			DB	'R'+80H
            52 80 
  1789 09E3			DW	SCSP-7
            CA09 
  1790 09E5		QERR	DW	DOCOL
            4306 
  1791 09E7			DW	SWAP
            7005 
  1792 09E9			DW	ZBRAN	; IF
            9601 
  1793 09EB			DW	QERR1-$
            0800 
  1794 09ED			DW	ERROR
            A00E 
  1795 09EF			DW	BRAN	; ELSE
            7D01 
  1796 09F1			DW	QERR2-$
            0400 
  1797 09F3		QERR1	DW	DROP	; ENDIF
            6205 
  1798 09F5		QERR2	DW	SEMIS
            6104 
  1799 			;
  1800 09F7			DB	85H	; ?COMP
            85 
  1801 09F8			DB	'?COM'
            3F 43 4F 4D 
            
  1802 09FC			DB	'P'+80H
            50 80 
  1803 09FE			DW	QERR-9
            DC09 
  1804 0A00		QCOMP	DW	DOCOL
            4306 
  1805 0A02			DW	STATE
            F907 
  1806 0A04			DW	AT
            C305 
  1807 0A06			DW	ZEQU
            C204 
  1808 0A08			DW	LIT
            5701 
  1809 0A0A			DW	11H
            1100 
  1810 0A0C			DW	QERR
            E509 
  1811 0A0E			DW	SEMIS
            6104 
  1812 			;
  1813 0A10			DB	85H	; ?EXEC
            85 
  1814 0A11			DB	'?EXE'
            3F 45 58 45 
            
  1815 0A15			DB	'C'+80H
            43 80 
  1816 0A17			DW	QCOMP-8
            F809 
  1817 0A19		QEXEC	DW	DOCOL
            4306 
  1818 0A1B			DW	STATE
            F907 
  1819 0A1D			DW	AT
            C305 
  1820 0A1F			DW	LIT
            5701 
  1821 0A21			DW	12H
            1200 
  1822 0A23			DW	QERR
            E509 
  1823 0A25			DW	SEMIS
            6104 
  1824 			;
  1825 0A27			DB	86H	; ?PAIRS
            86 
  1826 0A28			DB	'?PAIR'
            3F 50 41 49 
            52 
  1827 0A2D			DB	'S'+80H
            53 80 
  1828 0A2F			DW	QEXEC-8
            110A 
  1829 0A31		QPAIR	DW	DOCOL
            4306 
  1830 0A33			DW	SUBB
            A508 
  1831 0A35			DW	LIT
            5701 
  1832 0A37			DW	13H
            1300 
  1833 0A39			DW	QERR
            E509 
  1834 0A3B			DW	SEMIS
            6104 
  1835 			;
  1836 0A3D			DB	84H	; ?CSP
            84 
  1837 0A3E			DB	'?CS'
            3F 43 53 
  1838 0A41			DB	'P'+80H
            50 80 
  1839 0A43			DW	QPAIR-9
            280A 
  1840 0A45		QCSP	DW	DOCOL
            4306 
  1841 0A47			DW	SPAT
            1104 
  1842 0A49			DW	CSPP
            2208 
  1843 0A4B			DW	AT
            C305 
  1844 0A4D			DW	SUBB
            A508 
  1845 0A4F			DW	LIT
            5701 
  1846 0A51			DW	14H
            1400 
  1847 0A53			DW	QERR
            E509 
  1848 0A55			DW	SEMIS
            6104 
  1849 			;
  1850 0A57			DB	88H	; ?LOADING
            88 
  1851 0A58			DB	'?LOADIN'
            3F 4C 4F 41 
            44 49 4E 
  1852 0A5F			DB	'G'+80H
            47 80 
  1853 0A61			DW	QCSP-7
            3E0A 
  1854 0A63		QLOAD	DW	DOCOL
            4306 
  1855 0A65			DW	BLK
            A707 
  1856 0A67			DW	AT
            C305 
  1857 0A69			DW	ZEQU
            C204 
  1858 0A6B			DW	LIT
            5701 
  1859 0A6D			DW	16H
            1600 
  1860 0A6F			DW	QERR
            E509 
  1861 0A71			DW	SEMIS
            6104 
  1862 			;
  1863 0A73			DB	87H	; COMPILE
            87 
  1864 0A74			DB	'COMPIL'
            43 4F 4D 50 
            49 4C 
  1865 0A7A			DB	'E'+80H
            45 80 
  1866 0A7C			DW	QLOAD-0BH
            580A 
  1867 0A7E		COMP	DW	DOCOL
            4306 
  1868 0A80			DW	QCOMP
            000A 
  1869 0A82			DW	FROMR
            A504 
  1870 0A84			DW	DUP
            7E05 
  1871 0A86			DW	TWOP
            4D08 
  1872 0A88			DW	TOR
            8E04 
  1873 0A8A			DW	AT
            C305 
  1874 0A8C			DW	COMMA
            7B08 
  1875 0A8E			DW	SEMIS
            6104 
  1876 			;
  1877 0A90			DB	0C1H	; [
            C1 
  1878 0A91			DB	'['+80H
            5B 80 
  1879 0A93			DW	COMP-0AH
            740A 
  1880 0A95		LBRAC	DW	DOCOL
            4306 
  1881 0A97			DW	ZERO
            C606 
  1882 0A99			DW	STATE
            F907 
  1883 0A9B			DW	STORE
            FD05 
  1884 0A9D			DW	SEMIS
            6104 
  1885 			;
  1886 0A9F			DB	81H	; ]
            81 
  1887 0AA0			DB	']'+80H
            5D 80 
  1888 0AA2			DW	LBRAC-4
            910A 
  1889 0AA4		RBRAC	DW	DOCOL
            4306 
  1890 0AA6			DW	LIT,0C0H
            5701 C000 
  1891 0AAA			DW	STATE,STORE
            F907 FD05 
  1892 0AAE			DW	SEMIS
            6104 
  1893 			;
  1894 0AB0			DB	86H	; SMUDGE
            86 
  1895 0AB1			DB	'SMUDG'
            53 4D 55 44 
            47 
  1896 0AB6			DB	'E'+80H
            45 80 
  1897 0AB8			DW	RBRAC-4
            A00A 
  1898 0ABA		SMUDG	DW	DOCOL
            4306 
  1899 0ABC			DW	LATES
            7309 
  1900 0ABE			DW	LIT
            5701 
  1901 0AC0			DW	20H
            2000 
  1902 0AC2			DW	TOGGL
            B405 
  1903 0AC4			DW	SEMIS
            6104 
  1904 			;
  1905 0AC6			DB	83H	; HEX
            83 
  1906 0AC7			DB	'HE'
            48 45 
  1907 0AC9			DB	'X'+80H
            58 80 
  1908 0ACB			DW	SMUDG-9
            B10A 
  1909 0ACD		HEX	DW	DOCOL
            4306 
  1910 0ACF			DW	LIT
            5701 
  1911 0AD1			DW	10H
            1000 
  1912 0AD3			DW	BASE
            0408 
  1913 0AD5			DW	STORE
            FD05 
  1914 0AD7			DW	SEMIS
            6104 
  1915 			;
  1916 0AD9			DB	87H	; DECIMAL
            87 
  1917 0ADA			DB	'DECIMA'
            44 45 43 49 
            4D 41 
  1918 0AE0			DB	'L'+80H
            4C 80 
  1919 0AE2			DW	HEX-6
            C70A 
  1920 0AE4		DEC	DW	DOCOL
            4306 
  1921 0AE6			DW	LIT
            5701 
  1922 0AE8			DW	0AH
            0A00 
  1923 0AEA			DW	BASE
            0408 
  1924 0AEC			DW	STORE
            FD05 
  1925 0AEE			DW	SEMIS
            6104 
  1926 			;
  1927 0AF0			DB	87H	; (;CODE)
            87 
  1928 0AF1			DB	'('
            28 
  1929 0AF2			DB	3BH     ;asm8080 thinks ';' in a string starts a comment.
            3B 
  1930 0AF3			DB	'CODE'
            43 4F 44 45 
            
  1931 0AF7			DB	')'+80H
            29 80 
  1932 0AF9			DW	DEC-0AH
            DA0A 
  1933 0AFB		PSCOD	DW	DOCOL
            4306 
  1934 0AFD			DW	FROMR
            A504 
  1935 0AFF			DW	LATES
            7309 
  1936 0B01			DW	PFA
            BB09 
  1937 0B03			DW	CFA
            9509 
  1938 0B05			DW	STORE
            FD05 
  1939 0B07			DW	SEMIS
            6104 
  1940 			;
  1941 0B09			DB	0C5H	; ;CODE
            C5 
  1942 0B0A			DB	3BH     ;asm8080 thinks ';' in a string starts a comment.
            3B 
  1943 0B0B			DB	'COD'
            43 4F 44 
  1944 0B0E			DB	'E'+80H
            45 80 
  1945 0B10			DW	PSCOD-0AH
            F10A 
  1946 0B12		SEMIC	DW	DOCOL
            4306 
  1947 0B14			DW	QCSP
            450A 
  1948 0B16			DW	COMP
            7E0A 
  1949 0B18			DW	PSCOD
            FB0A 
  1950 0B1A			DW	LBRAC
            950A 
  1951 0B1C		SEMI1	DW	NOOP	; ( ASSEMBLER )
            6D06 
  1952 0B1E			DW	SEMIS
            6104 
  1953 			;
  1954 0B20			DB	87H	; <BUILDS
            87 
  1955 0B21			DB	'<BUILD'
            3C 42 55 49 
            4C 44 
  1956 0B27			DB	'S'+80H
            53 80 
  1957 0B29			DW	SEMIC-8
            0A0B 
  1958 0B2B		BUILD	DW	DOCOL
            4306 
  1959 0B2D			DW	ZERO
            C606 
  1960 0B2F			DW	CON
            7D06 
  1961 0B31			DW	SEMIS
            6104 
  1962 			;
  1963 0B33			DB	85H	; DOES>
            85 
  1964 0B34			DB	'DOES'
            44 4F 45 53 
            
  1965 0B38			DB	'>'+80H
            3E 80 
  1966 0B3A			DW	BUILD-0AH
            210B 
  1967 0B3C		DOES	DW	DOCOL
            4306 
  1968 0B3E			DW	FROMR
            A504 
  1969 0B40			DW	LATES
            7309 
  1970 0B42			DW	PFA
            BB09 
  1971 0B44			DW	STORE
            FD05 
  1972 0B46			DW	PSCOD
            FB0A 
  1973 0B48 2A 28 01	DODOE	LHLD	RPP	; (HL) <- (RP)
  1974 0B4B 2B			DCX	H
  1975 0B4C 70			MOV	M,B	; (R1) <- (IP) = PFA = (SUBSTITUTE CFA)
  1976 0B4D 2B			DCX	H
  1977 0B4E 71			MOV	M,C
  1978 0B4F 22 28 01		SHLD	RPP	; (RP) <- (RP) - 2
  1979 0B52 13			INX	D	; (DE) <- PFA = (SUBSTITUTE CFA)
  1980 0B53 EB			XCHG
  1981 0B54 4E			MOV	C,M	; (IP) <- (SUBSTITUTE CFA)
  1982 0B55 23			INX	H
  1983 0B56 46			MOV	B,M
  1984 0B57 23			INX	H
  1985 0B58 C3 44 01		JMP	HPUSH	; (S1) <- PFA+2 = SUBSTITUTE PFA
  1986 			;
  1987 0B5B			DB	85H	; COUNT
            85 
  1988 0B5C			DB	'COUN'
            43 4F 55 4E 
            
  1989 0B60			DB	'T'+80H
            54 80 
  1990 0B62			DW	DOES-8
            340B 
  1991 0B64		COUNT	DW	DOCOL
            4306 
  1992 0B66			DW	DUP
            7E05 
  1993 0B68			DW	ONEP
            3F08 
  1994 0B6A			DW	SWAP
            7005 
  1995 0B6C			DW	CAT
            D305 
  1996 0B6E			DW	SEMIS
            6104 
  1997 			;
  1998 0B70			DB	84H	; TYPE
            84 
  1999 0B71			DB	'TYP'
            54 59 50 
  2000 0B74			DB	'E'+80H
            45 80 
  2001 0B76			DW	COUNT-8
            5C0B 
  2002 0B78		TYPE	DW	DOCOL
            4306 
  2003 0B7A			DW	DDUP
            3509 
  2004 0B7C			DW	ZBRAN	; IF
            9601 
  2005 0B7E			DW	TYPE1-$
            1800 
  2006 0B80			DW	OVER
            5205 
  2007 0B82			DW	PLUS
            EA04 
  2008 0B84			DW	SWAP
            7005 
  2009 0B86			DW	XDO	; DO
            F601 
  2010 0B88		TYPE2	DW	IDO
            1302 
  2011 0B8A			DW	CAT
            D305 
  2012 0B8C			DW	EMIT
            EC02 
  2013 0B8E			DW	XLOOP	; LOOP
            AD01 
  2014 0B90			DW	TYPE2-$
            F8FFFFFFFF 
  2015 0B92			DW	BRAN	; ELSE
            7D01 
  2016 0B94			DW	TYPE3-$
            0400 
  2017 0B96		TYPE1	DW	DROP	; ENDIF
            6205 
  2018 0B98		TYPE3	DW	SEMIS
            6104 
  2019 			;
  2020 0B9A			DB	89H	; -TRAILING
            89 
  2021 0B9B			DB	'-TRAILIN'
            2D 54 52 41 
            49 4C 49 4E 
            
  2022 0BA3			DB	'G'+80H
            47 80 
  2023 0BA5			DW	TYPE-7
            710B 
  2024 0BA7		DTRAI	DW	DOCOL
            4306 
  2025 0BA9			DW	DUP
            7E05 
  2026 0BAB			DW	ZERO
            C606 
  2027 0BAD			DW	XDO	; DO
            F601 
  2028 0BAF		DTRA1	DW	OVER
            5205 
  2029 0BB1			DW	OVER
            5205 
  2030 0BB3			DW	PLUS
            EA04 
  2031 0BB5			DW	ONE
            CF06 
  2032 0BB7			DW	SUBB
            A508 
  2033 0BB9			DW	CAT
            D305 
  2034 0BBB			DW	BL
            EB06 
  2035 0BBD			DW	SUBB
            A508 
  2036 0BBF			DW	ZBRAN	; IF
            9601 
  2037 0BC1			DW	DTRA2-$
            0800 
  2038 0BC3			DW	LEAVE
            7904 
  2039 0BC5			DW	BRAN	; ELSE
            7D01 
  2040 0BC7			DW	DTRA3-$
            0600 
  2041 0BC9		DTRA2	DW	ONE
            CF06 
  2042 0BCB			DW	SUBB	; ENDIF
            A508 
  2043 0BCD		DTRA3	DW	XLOOP	; LOOP
            AD01 
  2044 0BCF			DW	DTRA1-$
            E0FFFFFFFF 
  2045 0BD1			DW	SEMIS
            6104 
  2046 			;
  2047 0BD3			DB	84H	; (.")
            84 
  2048 0BD4			DB	'(.'
            28 2E 
  2049 0BD6			DB	22H     ;asm8080 thinks '"' in a string starts a comment.
            22 
  2050 0BD7			DB	')'+80H
            29 80 
  2051 0BD9			DW	DTRAI-0CH
            9B0B 
  2052 0BDB		PDOTQ	DW	DOCOL
            4306 
  2053 0BDD			DW	RR
            BA04 
  2054 0BDF			DW	COUNT
            640B 
  2055 0BE1			DW	DUP
            7E05 
  2056 0BE3			DW	ONEP
            3F08 
  2057 0BE5			DW	FROMR
            A504 
  2058 0BE7			DW	PLUS
            EA04 
  2059 0BE9			DW	TOR
            8E04 
  2060 0BEB			DW	TYPE
            780B 
  2061 0BED			DW	SEMIS
            6104 
  2062 			;
  2063 0BEF			DB	0C2H	; ."
            C2 
  2064 0BF0			DB	'.'
            2E 
  2065 0BF1			DB	82H     ;asm8080 thinks '"' in a string starts a comment.
            82 
  2066 0BF2			DW	PDOTQ-7
            D40B 
  2067 0BF4		DOTQ	DW	DOCOL
            4306 
  2068 0BF6			DW	LIT
            5701 
  2069 0BF8			DW	22H
            2200 
  2070 0BFA			DW	STATE
            F907 
  2071 0BFC			DW	AT
            C305 
  2072 0BFE			DW	ZBRAN	; IF
            9601 
  2073 0C00			DW	DOTQ1-$
            1400 
  2074 0C02			DW	COMP
            7E0A 
  2075 0C04			DW	PDOTQ
            DB0B 
  2076 0C06			DW	WORD
            6D0D 
  2077 0C08			DW	HERE
            5D08 
  2078 0C0A			DW	CAT
            D305 
  2079 0C0C			DW	ONEP
            3F08 
  2080 0C0E			DW	ALLOT
            6E08 
  2081 0C10			DW	BRAN	; ELSE
            7D01 
  2082 0C12			DW	DOTQ2-$
            0A00 
  2083 0C14		DOTQ1	DW	WORD
            6D0D 
  2084 0C16			DW	HERE
            5D08 
  2085 0C18			DW	COUNT
            640B 
  2086 0C1A			DW	TYPE	; ENDIF
            780B 
  2087 0C1C		DOTQ2	DW	SEMIS
            6104 
  2088 			;
  2089 0C1E			DB	86H	; EXPECT
            86 
  2090 0C1F			DB	'EXPEC'
            45 58 50 45 
            43 
  2091 0C24			DB	'T'+80H
            54 80 
  2092 0C26			DW	DOTQ-5
            EF0B 
  2093 0C28		EXPEC	DW	DOCOL
            4306 
  2094 0C2A			DW	OVER
            5205 
  2095 0C2C			DW	PLUS
            EA04 
  2096 0C2E			DW	OVER
            5205 
  2097 0C30			DW	XDO	; DO
            F601 
  2098 0C32		EXPE1	DW	KEY
            FF02 
  2099 0C34			DW	DUP
            7E05 
  2100 0C36			DW	LIT
            5701 
  2101 0C38			DW	0EH
            0E00 
  2102 0C3A			DW	PORIG
            3907 
  2103 0C3C			DW	AT
            C305 
  2104 0C3E			DW	EQUAL
            B408 
  2105 0C40			DW	ZBRAN	; IF
            9601 
  2106 0C42			DW	EXPE2-$
            2A00 
  2107 0C44			DW	DROP
            6205 
  2108 0C46			DW	DUP
            7E05 
  2109 0C48			DW	IDO
            1302 
  2110 0C4A			DW	EQUAL
            B408 
  2111 0C4C			DW	DUP
            7E05 
  2112 0C4E			DW	FROMR
            A504 
  2113 0C50			DW	TWO
            D806 
  2114 0C52			DW	SUBB
            A508 
  2115 0C54			DW	PLUS
            EA04 
  2116 0C56			DW	TOR
            8E04 
  2117 0C58			DW	ZBRAN	; IF
            9601 
  2118 0C5A			DW	EXPE6-$
            0A00 
  2119 0C5C			DW	LIT
            5701 
  2120 0C5E			DW	BELL
            0700 
  2121 0C60			DW	BRAN	; ELSE
            7D01 
  2122 0C62			DW	EXPE7-$
            0600 
  2123 0C64		EXPE6	DW	LIT
            5701 
  2124 0C66			DW	BSOUT	; ENDIF
            0800 
  2125 0C68		EXPE7	DW	BRAN	; ELSE
            7D01 
  2126 0C6A			DW	EXPE3-$
            2800 
  2127 0C6C		EXPE2	DW	DUP
            7E05 
  2128 0C6E			DW	LIT
            5701 
  2129 0C70			DW	0DH
            0D00 
  2130 0C72			DW	EQUAL
            B408 
  2131 0C74			DW	ZBRAN	; IF
            9601 
  2132 0C76			DW	EXPE4-$
            0E00 
  2133 0C78			DW	LEAVE
            7904 
  2134 0C7A			DW	DROP
            6205 
  2135 0C7C			DW	BL
            EB06 
  2136 0C7E			DW	ZERO
            C606 
  2137 0C80			DW	BRAN	; ELSE
            7D01 
  2138 0C82			DW	EXPE5-$
            0400 
  2139 0C84		EXPE4	DW	DUP	; ENDIF
            7E05 
  2140 0C86		EXPE5	DW	IDO
            1302 
  2141 0C88			DW	CSTOR
            0D06 
  2142 0C8A			DW	ZERO
            C606 
  2143 0C8C			DW	IDO
            1302 
  2144 0C8E			DW	ONEP
            3F08 
  2145 0C90			DW	STORE	; ENDIF
            FD05 
  2146 0C92		EXPE3	DW	EMIT
            EC02 
  2147 0C94			DW	XLOOP	; LOOP
            AD01 
  2148 0C96			DW	EXPE1-$
            9CFFFFFFFF 
  2149 0C98			DW	DROP
            6205 
  2150 0C9A			DW	SEMIS
            6104 
  2151 			;
  2152 0C9C			DB	85H	; QUERY
            85 
  2153 0C9D			DB	'QUER'
            51 55 45 52 
            
  2154 0CA1			DB	'Y'+80H
            59 80 
  2155 0CA3			DW	EXPEC-9
            1F0C 
  2156 0CA5		QUERY	DW	DOCOL
            4306 
  2157 0CA7			DW	TIB
            5E07 
  2158 0CA9			DW	AT
            C305 
  2159 0CAB			DW	LIT
            5701 
  2160 0CAD			DW	50H
            5000 
  2161 0CAF			DW	EXPEC
            280C 
  2162 0CB1			DW	ZERO
            C606 
  2163 0CB3			DW	INN
            B007 
  2164 0CB5			DW	STORE
            FD05 
  2165 0CB7			DW	SEMIS
            6104 
  2166 			;
  2167 0CB9			DB	0C1H	; 0 (NULL)
            C1 
  2168 0CBA			DB	80H
            80 
  2169 0CBB			DW	QUERY-8
            9D0C 
  2170 0CBD		NULL	DW	DOCOL
            4306 
  2171 0CBF			DW	BLK
            A707 
  2172 0CC1			DW	AT
            C305 
  2173 0CC3			DW	ZBRAN	; IF
            9601 
  2174 0CC5			DW	NULL1-$
            2A00 
  2175 0CC7			DW	ONE
            CF06 
  2176 0CC9			DW	BLK
            A707 
  2177 0CCB			DW	PSTOR
            9C05 
  2178 0CCD			DW	ZERO
            C606 
  2179 0CCF			DW	INN
            B007 
  2180 0CD1			DW	STORE
            FD05 
  2181 0CD3			DW	BLK
            A707 
  2182 0CD5			DW	AT
            C305 
  2183 0CD7			DW	BSCR
            2A07 
  2184 0CD9			DW	ONE
            CF06 
  2185 0CDB			DW	SUBB
            A508 
  2186 0CDD			DW	ANDD
            D603 
  2187 0CDF			DW	ZEQU
            C204 
  2188 0CE1			DW	ZBRAN	; IF
            9601 
  2189 0CE3			DW	NULL2-$
            0800 
  2190 0CE5			DW	QEXEC
            190A 
  2191 0CE7			DW	FROMR
            A504 
  2192 0CE9			DW	DROP	; ENDIF
            6205 
  2193 0CEB		NULL2	DW	BRAN	; ELSE
            7D01 
  2194 0CED			DW	NULL3-$
            0600 
  2195 0CEF		NULL1	DW	FROMR
            A504 
  2196 0CF1			DW	DROP	; ENDIF
            6205 
  2197 0CF3		NULL3	DW	SEMIS
            6104 
  2198 			;
  2199 0CF5			DB	84H	; FILL
            84 
  2200 0CF6			DB	'FIL'
            46 49 4C 
  2201 0CF9			DB	'L'+80H
            4C 80 
  2202 0CFB			DW	NULL-4
            B90C 
  2203 0CFD		FILL	DW	$+2
            FF0C 
  2204 0CFF 69			MOV	L,C
  2205 0D00 60			MOV	H,B
  2206 0D01 D1			POP	D
  2207 0D02 C1			POP	B
  2208 0D03 E3			XTHL
  2209 0D04 EB			XCHG
  2210 0D05 78		FILL1	MOV	A,B	; BEGIN
  2211 0D06 B1			ORA	C
  2212 0D07 CA 11 0D		JZ	FILL2	; WHILE
  2213 0D0A 7D			MOV	A,L
  2214 0D0B 12			STAX	D
  2215 0D0C 13			INX	D
  2216 0D0D 0B			DCX	B
  2217 0D0E C3 05 0D		JMP	FILL1	; REPEAT
  2218 0D11 C1		FILL2	POP	B
  2219 0D12 C3 45 01		JMP	NEXT
  2220 			;
  2221 0D15			DB	85H	; ERASE
            85 
  2222 0D16			DB	'ERAS'
            45 52 41 53 
            
  2223 0D1A			DB	'E'+80H
            45 80 
  2224 0D1C			DW	FILL-7
            F60C 
  2225 0D1E		ERASEE	DW	DOCOL
            4306 
  2226 0D20			DW	ZERO
            C606 
  2227 0D22			DW	FILL
            FD0C 
  2228 0D24			DW	SEMIS
            6104 
  2229 			;
  2230 0D26			DB	86H	; BLANKS
            86 
  2231 0D27			DB	'BLANK'
            42 4C 41 4E 
            4B 
  2232 0D2C			DB	'S'+80H
            53 80 
  2233 0D2E			DW	ERASEE-8
            160D 
  2234 0D30		BLANK	DW	DOCOL
            4306 
  2235 0D32			DW	BL
            EB06 
  2236 0D34			DW	FILL
            FD0C 
  2237 0D36			DW	SEMIS
            6104 
  2238 			;
  2239 0D38			DB	84H	; HOLD
            84 
  2240 0D39			DB	'HOL'
            48 4F 4C 
  2241 0D3C			DB	'D'+80H
            44 80 
  2242 0D3E			DW	BLANK-9
            270D 
  2243 0D40		HOLD	DW	DOCOL
            4306 
  2244 0D42			DW	LIT
            5701 
  2245 0D44			DW	-1
            FFFFFFFFFF 
  2246 0D46			DW	HLD
            3508 
  2247 0D48			DW	PSTOR
            9C05 
  2248 0D4A			DW	HLD
            3508 
  2249 0D4C			DW	AT
            C305 
  2250 0D4E			DW	CSTOR
            0D06 
  2251 0D50			DW	SEMIS
            6104 
  2252 			;
  2253 0D52			DB	83H	; PAD
            83 
  2254 0D53			DB	'PA'
            50 41 
  2255 0D55			DB	'D'+80H
            44 80 
  2256 0D57			DW	HOLD-7
            390D 
  2257 0D59		PAD	DW	DOCOL
            4306 
  2258 0D5B			DW	HERE
            5D08 
  2259 0D5D			DW	LIT
            5701 
  2260 0D5F			DW	44H
            4400 
  2261 0D61			DW	PLUS
            EA04 
  2262 0D63			DW	SEMIS
            6104 
  2263 			;
  2264 0D65			DB	84H	; WORD
            84 
  2265 0D66			DB	'WOR'
            57 4F 52 
  2266 0D69			DB	'D'+80H
            44 80 
  2267 0D6B			DW	PAD-6
            530D 
  2268 0D6D		WORD	DW	DOCOL
            4306 
  2269 0D6F			DW	BLK
            A707 
  2270 0D71			DW	AT
            C305 
  2271 0D73			DW	ZBRAN	; IF
            9601 
  2272 0D75			DW	WORD1-$
            0C00 
  2273 0D77			DW	BLK
            A707 
  2274 0D79			DW	AT
            C305 
  2275 0D7B			DW	BLOCK
            E314 
  2276 0D7D			DW	BRAN	; ELSE
            7D01 
  2277 0D7F			DW	WORD2-$
            0600 
  2278 0D81		WORD1	DW	TIB
            5E07 
  2279 0D83			DW	AT	; ENDIF
            C305 
  2280 0D85		WORD2	DW	INN
            B007 
  2281 0D87			DW	AT
            C305 
  2282 0D89			DW	PLUS
            EA04 
  2283 0D8B			DW	SWAP
            7005 
  2284 0D8D			DW	ENCL
            A702 
  2285 0D8F			DW	HERE
            5D08 
  2286 0D91			DW	LIT
            5701 
  2287 0D93			DW	22H
            2200 
  2288 0D95			DW	BLANK
            300D 
  2289 0D97			DW	INN
            B007 
  2290 0D99			DW	PSTOR
            9C05 
  2291 0D9B			DW	OVER
            5205 
  2292 0D9D			DW	SUBB
            A508 
  2293 0D9F			DW	TOR
            8E04 
  2294 0DA1			DW	RR
            BA04 
  2295 0DA3			DW	HERE
            5D08 
  2296 0DA5			DW	CSTOR
            0D06 
  2297 0DA7			DW	PLUS
            EA04 
  2298 0DA9			DW	HERE
            5D08 
  2299 0DAB			DW	ONEP
            3F08 
  2300 0DAD			DW	FROMR
            A504 
  2301 0DAF			DW	CMOVE
            2D03 
  2302 0DB1			DW	SEMIS
            6104 
  2303 			;
  2304 0DB3			DB	88H	; (NUMBER)
            88 
  2305 0DB4			DB	'(NUMBER'
            28 4E 55 4D 
            42 45 52 
  2306 0DBB			DB	')'+80H
            29 80 
  2307 0DBD			DW	WORD-7
            660D 
  2308 0DBF		PNUMB	DW	DOCOL
            4306 
  2309 0DC1		PNUM1	DW	ONEP	; BEGIN
            3F08 
  2310 0DC3			DW	DUP
            7E05 
  2311 0DC5			DW	TOR
            8E04 
  2312 0DC7			DW	CAT
            D305 
  2313 0DC9			DW	BASE
            0408 
  2314 0DCB			DW	AT
            C305 
  2315 0DCD			DW	DIGIT
            2802 
  2316 0DCF			DW	ZBRAN	; WHILE
            9601 
  2317 0DD1			DW	PNUM2-$
            2C00 
  2318 0DD3			DW	SWAP
            7005 
  2319 0DD5			DW	BASE
            0408 
  2320 0DD7			DW	AT
            C305 
  2321 0DD9			DW	USTAR
            4B03 
  2322 0DDB			DW	DROP
            6205 
  2323 0DDD			DW	ROT
            1409 
  2324 0DDF			DW	BASE
            0408 
  2325 0DE1			DW	AT
            C305 
  2326 0DE3			DW	USTAR
            4B03 
  2327 0DE5			DW	DPLUS
            F804 
  2328 0DE7			DW	DPL
            0E08 
  2329 0DE9			DW	AT
            C305 
  2330 0DEB			DW	ONEP
            3F08 
  2331 0DED			DW	ZBRAN	; IF
            9601 
  2332 0DEF			DW	PNUM3-$
            0800 
  2333 0DF1			DW	ONE
            CF06 
  2334 0DF3			DW	DPL
            0E08 
  2335 0DF5			DW	PSTOR	; ENDIF
            9C05 
  2336 0DF7		PNUM3	DW	FROMR
            A504 
  2337 0DF9			DW	BRAN	; REPEAT
            7D01 
  2338 0DFB			DW	PNUM1-$
            C6FFFFFFFF 
  2339 0DFD		PNUM2	DW	FROMR
            A504 
  2340 0DFF			DW	SEMIS
            6104 
  2341 			;
  2342 0E01			DB	86H	; NUMBER
            86 
  2343 0E02			DB	'NUMBE'
            4E 55 4D 42 
            45 
  2344 0E07			DB	'R'+80H
            52 80 
  2345 0E09			DW	PNUMB-0BH
            B40D 
  2346 0E0B		NUMB	DW	DOCOL
            4306 
  2347 0E0D			DW	ZERO
            C606 
  2348 0E0F			DW	ZERO
            C606 
  2349 0E11			DW	ROT
            1409 
  2350 0E13			DW	DUP
            7E05 
  2351 0E15			DW	ONEP
            3F08 
  2352 0E17			DW	CAT
            D305 
  2353 0E19			DW	LIT
            5701 
  2354 0E1B			DW	2DH
            2D00 
  2355 0E1D			DW	EQUAL
            B408 
  2356 0E1F			DW	DUP
            7E05 
  2357 0E21			DW	TOR
            8E04 
  2358 0E23			DW	PLUS
            EA04 
  2359 0E25			DW	LIT
            5701 
  2360 0E27			DW	-1
            FFFFFFFFFF 
  2361 0E29		NUMB1	DW	DPL	; BEGIN
            0E08 
  2362 0E2B			DW	STORE
            FD05 
  2363 0E2D			DW	PNUMB
            BF0D 
  2364 0E2F			DW	DUP
            7E05 
  2365 0E31			DW	CAT
            D305 
  2366 0E33			DW	BL
            EB06 
  2367 0E35			DW	SUBB
            A508 
  2368 0E37			DW	ZBRAN	; WHILE
            9601 
  2369 0E39			DW	NUMB2-$
            1600 
  2370 0E3B			DW	DUP
            7E05 
  2371 0E3D			DW	CAT
            D305 
  2372 0E3F			DW	LIT
            5701 
  2373 0E41			DW	2EH
            2E00 
  2374 0E43			DW	SUBB
            A508 
  2375 0E45			DW	ZERO
            C606 
  2376 0E47			DW	QERR
            E509 
  2377 0E49			DW	ZERO
            C606 
  2378 0E4B			DW	BRAN	; REPEAT
            7D01 
  2379 0E4D			DW	NUMB1-$
            DCFFFFFFFF 
  2380 0E4F		NUMB2	DW	DROP
            6205 
  2381 0E51			DW	FROMR
            A504 
  2382 0E53			DW	ZBRAN	; IF
            9601 
  2383 0E55			DW	NUMB3-$
            0400 
  2384 0E57			DW	DMINU	; ENDIF
            3305 
  2385 0E59		NUMB3	DW	SEMIS
            6104 
  2386 			;
  2387 0E5B			DB	85H	; -FIND	(0-3) SUCCESS
            85 
  2388 0E5C			DB	'-FIN'	; (0-1) FAILURE
            2D 46 49 4E 
            
  2389 0E60			DB	'D'+80H
            44 80 
  2390 0E62			DW	NUMB-9
            020E 
  2391 0E64		DFIND	DW	DOCOL
            4306 
  2392 0E66			DW	BL
            EB06 
  2393 0E68			DW	WORD
            6D0D 
  2394 0E6A			DW	HERE
            5D08 
  2395 0E6C			DW	CONT
            DF07 
  2396 0E6E			DW	AT
            C305 
  2397 0E70			DW	AT
            C305 
  2398 0E72			DW	PFIND
            5702 
  2399 0E74			DW	DUP
            7E05 
  2400 0E76			DW	ZEQU
            C204 
  2401 0E78			DW	ZBRAN	; IF
            9601 
  2402 0E7A			DW	DFIN1-$
            0A00 
  2403 0E7C			DW	DROP
            6205 
  2404 0E7E			DW	HERE
            5D08 
  2405 0E80			DW	LATES
            7309 
  2406 0E82			DW	PFIND	; ENDIF
            5702 
  2407 0E84		DFIN1	DW	SEMIS
            6104 
  2408 			;
  2409 0E86			DB	87H	; (ABORT)
            87 
  2410 0E87			DB	'(ABORT'
            28 41 42 4F 
            52 54 
  2411 0E8D			DB	')'+80H
            29 80 
  2412 0E8F			DW	DFIND-8
            5C0E 
  2413 0E91		PABOR	DW	DOCOL
            4306 
  2414 0E93			DW	ABORT
            F310 
  2415 0E95			DW	SEMIS
            6104 
  2416 			;
  2417 0E97			DB	85H	; ERROR
            85 
  2418 0E98			DB	'ERRO'
            45 52 52 4F 
            
  2419 0E9C			DB	'R'+80H
            52 80 
  2420 0E9E			DW	PABOR-0AH
            870E 
  2421 0EA0		ERROR	DW	DOCOL
            4306 
  2422 0EA2			DW	WARN
            7807 
  2423 0EA4			DW	AT
            C305 
  2424 0EA6			DW	ZLESS
            D704 
  2425 0EA8			DW	ZBRAN	; IF
            9601 
  2426 0EAA			DW	ERRO1-$
            0400 
  2427 0EAC			DW	PABOR	; ENDIF
            910E 
  2428 0EAE		ERRO1	DW	HERE
            5D08 
  2429 0EB0			DW	COUNT
            640B 
  2430 0EB2			DW	TYPE
            780B 
  2431 0EB4			DW	PDOTQ
            DB0B 
  2432 0EB6			DB	2
            02 
  2433 0EB7			DB	'? '
            3F 20 
  2434 0EB9			DW	MESS
            2013 
  2435 0EBB			DW	SPSTO
            2104 
  2436 			;	CHANGE FROM FIG MODEL
  2437 			;	DW	INN,AT,BLK,AT
  2438 0EBD			DW	BLK,AT
            A707 C305 
  2439 0EC1			DW	DDUP
            3509 
  2440 0EC3			DW	ZBRAN,ERRO2-$	; IF
            9601 0A00 
  2441 0EC7			DW	INN,AT
            B007 C305 
  2442 0ECB			DW	SWAP		; ENDIF
            7005 
  2443 0ECD		ERRO2	DW	QUIT
            C510 
  2444 			;
  2445 0ECF			DB	83H	; ID.
            83 
  2446 0ED0			DB	'ID'
            49 44 
  2447 0ED2			DB	'.'+80H
            2E 80 
  2448 0ED4			DW	ERROR-8
            980E 
  2449 0ED6		IDDOT	DW	DOCOL
            4306 
  2450 0ED8			DW	PAD
            590D 
  2451 0EDA			DW	LIT
            5701 
  2452 0EDC			DW	20H
            2000 
  2453 0EDE			DW	LIT
            5701 
  2454 0EE0			DW	5FH
            5F00 
  2455 0EE2			DW	FILL
            FD0C 
  2456 0EE4			DW	DUP
            7E05 
  2457 0EE6			DW	PFA
            BB09 
  2458 0EE8			DW	LFA
            8409 
  2459 0EEA			DW	OVER
            5205 
  2460 0EEC			DW	SUBB
            A508 
  2461 0EEE			DW	PAD
            590D 
  2462 0EF0			DW	SWAP
            7005 
  2463 0EF2			DW	CMOVE
            2D03 
  2464 0EF4			DW	PAD
            590D 
  2465 0EF6			DW	COUNT
            640B 
  2466 0EF8			DW	LIT
            5701 
  2467 0EFA			DW	1FH
            1F00 
  2468 0EFC			DW	ANDD
            D603 
  2469 0EFE			DW	TYPE
            780B 
  2470 0F00			DW	SPACE
            2509 
  2471 0F02			DW	SEMIS
            6104 
  2472 			;
  2473 0F04			DB	86H	; CREATE
            86 
  2474 0F05			DB	'CREAT'
            43 52 45 41 
            54 
  2475 0F0A			DB	'E'+80H
            45 80 
  2476 0F0C			DW	IDDOT-6
            D00E 
  2477 0F0E		CREAT	DW	DOCOL
            4306 
  2478 0F10			DW	DFIND
            640E 
  2479 0F12			DW	ZBRAN	; IF
            9601 
  2480 0F14			DW	CREA1-$
            1000 
  2481 0F16			DW	DROP
            6205 
  2482 0F18			DW	NFA
            A409 
  2483 0F1A			DW	IDDOT
            D60E 
  2484 0F1C			DW	LIT
            5701 
  2485 0F1E			DW	4
            0400 
  2486 0F20			DW	MESS
            2013 
  2487 0F22			DW	SPACE	; ENDIF
            2509 
  2488 0F24		CREA1	DW	HERE
            5D08 
  2489 0F26			DW	DUP
            7E05 
  2490 0F28			DW	CAT
            D305 
  2491 0F2A			DW	WIDTH
            6A07 
  2492 0F2C			DW	AT
            C305 
  2493 0F2E			DW	MIN
            EC11 
  2494 0F30			DW	ONEP
            3F08 
  2495 0F32			DW	ALLOT
            6E08 
  2496 0F34			DW	DUP
            7E05 
  2497 0F36			DW	LIT
            5701 
  2498 0F38			DW	0A0H
            A000 
  2499 0F3A			DW	TOGGL
            B405 
  2500 0F3C			DW	HERE
            5D08 
  2501 0F3E			DW	ONE
            CF06 
  2502 0F40			DW	SUBB
            A508 
  2503 0F42			DW	LIT
            5701 
  2504 0F44			DW	80H
            8000 
  2505 0F46			DW	TOGGL
            B405 
  2506 0F48			DW	LATES
            7309 
  2507 0F4A			DW	COMMA
            7B08 
  2508 0F4C			DW	CURR
            ED07 
  2509 0F4E			DW	AT
            C305 
  2510 0F50			DW	STORE
            FD05 
  2511 0F52			DW	HERE
            5D08 
  2512 0F54			DW	TWOP
            4D08 
  2513 0F56			DW	COMMA
            7B08 
  2514 0F58			DW	SEMIS
            6104 
  2515 			;
  2516 0F5A			DB	0C9H	; [COMPILE]
            C9 
  2517 0F5B			DB	'[COMPILE'
            5B 43 4F 4D 
            50 49 4C 45 
            
  2518 0F63			DB	']'+80H
            5D 80 
  2519 0F65			DW	CREAT-9
            050F 
  2520 0F67		BCOMP	DW	DOCOL
            4306 
  2521 0F69			DW	DFIND
            640E 
  2522 0F6B			DW	ZEQU
            C204 
  2523 0F6D			DW	ZERO
            C606 
  2524 0F6F			DW	QERR
            E509 
  2525 0F71			DW	DROP
            6205 
  2526 0F73			DW	CFA
            9509 
  2527 0F75			DW	COMMA
            7B08 
  2528 0F77			DW	SEMIS
            6104 
  2529 			;
  2530 0F79			DB	0C7H	; LITERAL
            C7 
  2531 0F7A			DB	'LITERA'
            4C 49 54 45 
            52 41 
  2532 0F80			DB	'L'+80H
            4C 80 
  2533 0F82			DW	BCOMP-0CH
            5B0F 
  2534 0F84		LITER	DW	DOCOL
            4306 
  2535 0F86			DW	STATE
            F907 
  2536 0F88			DW	AT
            C305 
  2537 0F8A			DW	ZBRAN	; IF
            9601 
  2538 0F8C			DW	LITE1-$
            0800 
  2539 0F8E			DW	COMP
            7E0A 
  2540 0F90			DW	LIT
            5701 
  2541 0F92			DW	COMMA	; ENDIF
            7B08 
  2542 0F94		LITE1	DW	SEMIS
            6104 
  2543 			;
  2544 0F96			DB	0C8H	; DLITERAL
            C8 
  2545 0F97			DB	'DLITERA'
            44 4C 49 54 
            45 52 41 
  2546 0F9E			DB	'L'+80H
            4C 80 
  2547 0FA0			DW	LITER-0AH
            7A0F 
  2548 0FA2		DLITE	DW	DOCOL
            4306 
  2549 0FA4			DW	STATE
            F907 
  2550 0FA6			DW	AT
            C305 
  2551 0FA8			DW	ZBRAN	; IF
            9601 
  2552 0FAA			DW	DLIT1-$
            0800 
  2553 0FAC			DW	SWAP
            7005 
  2554 0FAE			DW	LITER
            840F 
  2555 0FB0			DW	LITER	; ENDIF
            840F 
  2556 0FB2		DLIT1	DW	SEMIS
            6104 
  2557 			;
  2558 0FB4			DB	86H	; ?STACK
            86 
  2559 0FB5			DB	'?STAC'
            3F 53 54 41 
            43 
  2560 0FBA			DB	'K'+80H
            4B 80 
  2561 0FBC			DW	DLITE-0BH
            970F 
  2562 0FBE		QSTAC	DW	DOCOL
            4306 
  2563 0FC0			DW	SPAT
            1104 
  2564 0FC2			DW	SZERO
            4907 
  2565 0FC4			DW	AT
            C305 
  2566 0FC6			DW	SWAP
            7005 
  2567 0FC8			DW	ULESS
            E408 
  2568 0FCA			DW	ONE
            CF06 
  2569 0FCC			DW	QERR
            E509 
  2570 0FCE			DW	SPAT
            1104 
  2571 0FD0			DW	HERE
            5D08 
  2572 0FD2			DW	LIT
            5701 
  2573 0FD4			DW	80H
            8000 
  2574 0FD6			DW	PLUS
            EA04 
  2575 0FD8			DW	ULESS
            E408 
  2576 0FDA			DW	LIT
            5701 
  2577 0FDC			DW	7
            0700 
  2578 0FDE			DW	QERR
            E509 
  2579 0FE0			DW	SEMIS
            6104 
  2580 			;
  2581 0FE2			DB	89H	; INTERPRET
            89 
  2582 0FE3			DB	'INTERPRE'
            49 4E 54 45 
            52 50 52 45 
            
  2583 0FEB			DB	'T'+80H
            54 80 
  2584 0FED			DW	QSTAC-9
            B50F 
  2585 0FEF		INTER	DW	DOCOL
            4306 
  2586 0FF1		INTE1	DW	DFIND	; BEGIN
            640E 
  2587 0FF3			DW	ZBRAN	; IF
            9601 
  2588 0FF5			DW	INTE2-$
            1E00 
  2589 0FF7			DW	STATE
            F907 
  2590 0FF9			DW	AT
            C305 
  2591 0FFB			DW	LESS
            C108 
  2592 0FFD			DW	ZBRAN	; IF
            9601 
  2593 0FFF			DW	INTE3-$
            0A00 
  2594 1001			DW	CFA
            9509 
  2595 1003			DW	COMMA
            7B08 
  2596 1005			DW	BRAN	; ELSE
            7D01 
  2597 1007			DW	INTE4-$
            0600 
  2598 1009		INTE3	DW	CFA
            9509 
  2599 100B			DW	EXEC	; ENDIF
            6D01 
  2600 100D		INTE4	DW	QSTAC
            BE0F 
  2601 100F			DW	BRAN	; ELSE
            7D01 
  2602 1011			DW	INTE5-$
            1C00 
  2603 1013		INTE2	DW	HERE
            5D08 
  2604 1015			DW	NUMB
            0B0E 
  2605 1017			DW	DPL
            0E08 
  2606 1019			DW	AT
            C305 
  2607 101B			DW	ONEP
            3F08 
  2608 101D			DW	ZBRAN	; IF
            9601 
  2609 101F			DW	INTE6-$
            0800 
  2610 1021			DW	DLITE
            A20F 
  2611 1023			DW	BRAN	; ELSE
            7D01 
  2612 1025			DW	INTE7-$
            0600 
  2613 1027		INTE6	DW	DROP
            6205 
  2614 1029			DW	LITER	; ENDIF
            840F 
  2615 102B		INTE7	DW	QSTAC	; ENDIF
            BE0F 
  2616 102D		INTE5	DW	BRAN	; AGAIN
            7D01 
  2617 102F			DW	INTE1-$
            C2FFFFFFFF 
  2618 			;
  2619 1031			DB	89H	; IMMEDIATE
            89 
  2620 1032			DB	'IMMEDIAT'
            49 4D 4D 45 
            44 49 41 54 
            
  2621 103A			DB	'E'+80H
            45 80 
  2622 103C			DW	INTER-0CH
            E30F 
  2623 103E		IMMED	DW	DOCOL
            4306 
  2624 1040			DW	LATES
            7309 
  2625 1042			DW	LIT
            5701 
  2626 1044			DW	40H
            4000 
  2627 1046			DW	TOGGL
            B405 
  2628 1048			DW	SEMIS
            6104 
  2629 			;
  2630 104A			DB	8AH	; VOCABULARY
            8A 
  2631 104B			DB	'VOCABULAR'
            56 4F 43 41 
            42 55 4C 41 
            52 
  2632 1054			DB	'Y'+80H
            59 80 
  2633 1056			DW	IMMED-0CH
            3210 
  2634 1058		VOCAB	DW	DOCOL
            4306 
  2635 105A			DW	BUILD
            2B0B 
  2636 105C			DW	LIT
            5701 
  2637 105E			DW	0A081H
            81A0 
  2638 1060			DW	COMMA
            7B08 
  2639 1062			DW	CURR
            ED07 
  2640 1064			DW	AT
            C305 
  2641 1066			DW	CFA
            9509 
  2642 1068			DW	COMMA
            7B08 
  2643 106A			DW	HERE
            5D08 
  2644 106C			DW	VOCL
            9C07 
  2645 106E			DW	AT
            C305 
  2646 1070			DW	COMMA
            7B08 
  2647 1072			DW	VOCL
            9C07 
  2648 1074			DW	STORE
            FD05 
  2649 1076			DW	DOES
            3C0B 
  2650 1078		DOVOC	DW	TWOP
            4D08 
  2651 107A			DW	CONT
            DF07 
  2652 107C			DW	STORE
            FD05 
  2653 107E			DW	SEMIS
            6104 
  2654 			;
  2655 1080			DB	0C5H	; FORTH
            C5 
  2656 1081			DB	'FORT'
            46 4F 52 54 
            
  2657 1085			DB	'H'+80H
            48 80 
  2658 1087			DW	VOCAB-0DH
            4B10 
  2659 1089		FORTH	DW	DODOE
            480B 
  2660 108B			DW	DOVOC
            7810 
  2661 108D			DW	0A081H
            81A0 
  2662 108F			DW	TASK-7	; COLD START VALUE ONLY
            521B 
  2663 			;			  CHANGED EACH TIME A DEF IS APPENDED
  2664 			;			  TO THE FORTH VOCABULARY
  2665 1091			DW	0	; END OF VOCABULARY LIST
            0000 
  2666 			;
  2667 1093			DB	8BH	; DEFINITIONS
            8B 
  2668 1094			DB	'DEFINITION'
            44 45 46 49 
            4E 49 54 49 
            4F 4E 
  2669 109E			DB	'S'+80H
            53 80 
  2670 10A0			DW	FORTH-8
            8110 
  2671 10A2		DEFIN	DW	DOCOL
            4306 
  2672 10A4			DW	CONT
            DF07 
  2673 10A6			DW	AT
            C305 
  2674 10A8			DW	CURR
            ED07 
  2675 10AA			DW	STORE
            FD05 
  2676 10AC			DW	SEMIS
            6104 
  2677 			;
  2678 10AE			DB	0C1H	; (
            C1 
  2679 10AF			DB	'('+80H
            28 80 
  2680 10B1			DW	DEFIN-0EH
            9410 
  2681 10B3		PAREN	DW	DOCOL
            4306 
  2682 10B5			DW	LIT
            5701 
  2683 10B7			DW	29H
            2900 
  2684 10B9			DW	WORD
            6D0D 
  2685 10BB			DW	SEMIS
            6104 
  2686 			;
  2687 10BD			DB	84H	; QUIT
            84 
  2688 10BE			DB	'QUI'
            51 55 49 
  2689 10C1			DB	'T'+80H
            54 80 
  2690 10C3			DW	PAREN-4
            AF10 
  2691 10C5		QUIT	DW	DOCOL
            4306 
  2692 10C7			DW	ZERO
            C606 
  2693 10C9			DW	BLK
            A707 
  2694 10CB			DW	STORE
            FD05 
  2695 10CD			DW	LBRAC
            950A 
  2696 10CF		QUIT1	DW	RPSTO	; BEGIN
            4804 
  2697 10D1			DW	CR
            1F03 
  2698 10D3			DW	QUERY
            A50C 
  2699 10D5			DW	INTER
            EF0F 
  2700 10D7			DW	STATE
            F907 
  2701 10D9			DW	AT
            C305 
  2702 10DB			DW	ZEQU
            C204 
  2703 10DD			DW	ZBRAN	; IF
            9601 
  2704 10DF			DW	QUIT2-$
            0700 
  2705 10E1			DW	PDOTQ
            DB0B 
  2706 10E3			DB	2
            02 
  2707 10E4			DB	'OK'	; ENDIF
            4F 4B 
  2708 10E6		QUIT2	DW	BRAN	; AGAIN
            7D01 
  2709 10E8			DW	QUIT1-$
            E7FFFFFFFF 
  2710 			;
  2711 10EA			DB	85H	; ABORT
            85 
  2712 10EB			DB	'ABOR'
            41 42 4F 52 
            
  2713 10EF			DB	'T'+80H
            54 80 
  2714 10F1			DW	QUIT-7
            BE10 
  2715 10F3		ABORT	DW	DOCOL
            4306 
  2716 10F5			DW	SPSTO
            2104 
  2717 10F7			DW	DEC
            E40A 
  2718 10F9			DW	QSTAC
            BE0F 
  2719 10FB			DW	CR
            1F03 
  2720 10FD			DW	DOTCPU
            331B 
  2721 10FF			DW	PDOTQ
            DB0B 
  2722 1101			DB	0DH
            0D 
  2723 1102			DB	'fig-FORTH '
            66 69 67 2D 
            46 4F 52 54 
            48 20 
  2724 110C			DB	FIGREL+30H,ADOT,FIGREV+30H
            31 2E 31 
  2725 110F			DW	FORTH
            8910 
  2726 1111			DW	DEFIN
            A210 
  2727 1113			DW	QUIT
            C510 
  2728 			;
  2729 1115 01 1B 11	WRM	LXI	B,WRM1
  2730 1118 C3 45 01		JMP	NEXT
  2731 111B		WRM1	DW	WARM
            2511 
  2732 			;
  2733 111D			DB	84H	; WARM
            84 
  2734 111E			DB	'WAR'
            57 41 52 
  2735 1121			DB	'M'+80H
            4D 80 
  2736 1123			DW	ABORT-8
            EB10 
  2737 1125		WARM	DW	DOCOL
            4306 
  2738 1127			DW	MTBUF
            4E14 
  2739 1129			DW	ABORT
            F310 
  2740 			;
  2741 112B 01 35 11	CLD	LXI	B,CLD1
  2742 112E 2A 12 01		LHLD	ORIG+12H
  2743 1131 F9			SPHL
  2744 1132 C3 45 01		JMP	NEXT
  2745 1135		CLD1	DW	COLD
            3F11 
  2746 			;
  2747 1137			DB	84H	; COLD
            84 
  2748 1138			DB	'COL'
            43 4F 4C 
  2749 113B			DB	'D'+80H
            44 80 
  2750 113D			DW	WARM-7
            1E11 
  2751 113F		COLD	DW	DOCOL
            4306 
  2752 1141			DW	MTBUF
            4E14 
  2753 1143			DW	ZERO,DENSTY
            C606 DF13 
  2754 1147			DW	STORE
            FD05 
  2755 1149			DW	LIT,BUF1
            5701 E0F3 
  2756 114D			DW	USE,STORE
            A813 FD05 
  2757 1151			DW	LIT,BUF1
            5701 E0F3 
  2758 1155			DW	PREV,STORE
            B413 FD05 
  2759 1159			DW	DRZER
            6314 
  2760 115B			DW	LIT,0
            5701 0000 
  2761 115F			DW	LIT,EPRINT
            5701 EE16 
  2762 1163			DW	STORE
            FD05 
  2763 			;
  2764 1165			DW	LIT
            5701 
  2765 1167			DW	ORIG+12H
            1201 
  2766 1169			DW	LIT
            5701 
  2767 116B			DW	UP
            2601 
  2768 116D			DW	AT
            C305 
  2769 116F			DW	LIT
            5701 
  2770 1171			DW	6
            0600 
  2771 1173			DW	PLUS
            EA04 
  2772 1175			DW	LIT
            5701 
  2773 1177			DW	10H
            1000 
  2774 1179			DW	CMOVE
            2D03 
  2775 117B			DW	LIT
            5701 
  2776 117D			DW	ORIG+0CH
            0C01 
  2777 117F			DW	AT
            C305 
  2778 1181			DW	LIT
            5701 
  2779 1183			DW	FORTH+6
            8F10 
  2780 1185			DW	STORE
            FD05 
  2781 1187			DW	ABORT
            F310 
  2782 			;
  2783 1189			DB	84H	; S->D
            84 
  2784 118A			DB	'S->'
            53 2D 3E 
  2785 118D			DB	'D'+80H
            44 80 
  2786 118F			DW	COLD-7
            3811 
  2787 1191		STOD	DW	$+2
            9311 
  2788 1193 D1			POP	D
  2789 1194 21 00 00		LXI	H,0
  2790 1197 7A			MOV	A,D
  2791 1198 E6 80		ANI	80H
  2792 119A CA 9E 11		JZ	STOD1
  2793 119D 2B			DCX	H
  2794 119E C3 43 01	STOD1	JMP	DPUSH
  2795 			;
  2796 11A1			DB	82H	; +-
            82 
  2797 11A2			DB	'+'
            2B 
  2798 11A3			DB	'-'+80H
            2D 80 
  2799 11A5			DW	STOD-7
            8A11 
  2800 11A7		PM	DW	DOCOL
            4306 
  2801 11A9			DW	ZLESS
            D704 
  2802 11AB			DW	ZBRAN	; IF
            9601 
  2803 11AD			DW	PM1-$
            0400 
  2804 11AF			DW	MINUS	; ENDIF
            1C05 
  2805 11B1		PM1	DW	SEMIS
            6104 
  2806 			;
  2807 11B3			DB	83H	; D+-
            83 
  2808 11B4			DB	'D+'
            44 2B 
  2809 11B6			DB	'-'+80H
            2D 80 
  2810 11B8			DW	PM-5
            A211 
  2811 11BA		DPM	DW	DOCOL
            4306 
  2812 11BC			DW	ZLESS
            D704 
  2813 11BE			DW	ZBRAN	; IF
            9601 
  2814 11C0			DW	DPM1-$
            0400 
  2815 11C2			DW	DMINU	; ENDIF
            3305 
  2816 11C4		DPM1	DW	SEMIS
            6104 
  2817 			;
  2818 11C6			DB	83H	; ABS
            83 
  2819 11C7			DB	'AB'
            41 42 
  2820 11C9			DB	'S'+80H
            53 80 
  2821 11CB			DW	DPM-6
            B411 
  2822 11CD		ABS	DW	DOCOL
            4306 
  2823 11CF			DW	DUP
            7E05 
  2824 11D1			DW	PM
            A711 
  2825 11D3			DW	SEMIS
            6104 
  2826 			;
  2827 11D5			DB	84H	; DABS
            84 
  2828 11D6			DB	'DAB'
            44 41 42 
  2829 11D9			DB	'S'+80H
            53 80 
  2830 11DB			DW	ABS-6
            C711 
  2831 11DD		DABS	DW	DOCOL
            4306 
  2832 11DF			DW	DUP
            7E05 
  2833 11E1			DW	DPM
            BA11 
  2834 11E3			DW	SEMIS
            6104 
  2835 			;
  2836 11E5			DB	83H	; MIN
            83 
  2837 11E6			DB	'MI'
            4D 49 
  2838 11E8			DB	'N'+80H
            4E 80 
  2839 11EA			DW	DABS-7
            D611 
  2840 11EC		MIN	DW	DOCOL,TDUP
            4306 8D05 
  2841 11F0			DW	GREAT
            0509 
  2842 11F2			DW	ZBRAN	; IF
            9601 
  2843 11F4			DW	MIN1-$
            0400 
  2844 11F6			DW	SWAP	; ENDIF
            7005 
  2845 11F8		MIN1	DW	DROP
            6205 
  2846 11FA			DW	SEMIS
            6104 
  2847 			;
  2848 11FC			DB	83H	; MAX
            83 
  2849 11FD			DB	'MA'
            4D 41 
  2850 11FF			DB	'X'+80H
            58 80 
  2851 1201			DW	MIN-6
            E611 
  2852 1203		MAX	DW	DOCOL,TDUP
            4306 8D05 
  2853 1207			DW	LESS
            C108 
  2854 1209			DW	ZBRAN	; IF
            9601 
  2855 120B			DW	MAX1-$
            0400 
  2856 120D			DW	SWAP	; ENDIF
            7005 
  2857 120F		MAX1	DW	DROP
            6205 
  2858 1211			DW	SEMIS
            6104 
  2859 			;
  2860 1213			DB	82H	; M*
            82 
  2861 1214			DB	'M'
            4D 
  2862 1215			DB	'*'+80H
            2A 80 
  2863 1217			DW	MAX-6
            FD11 
  2864 1219		MSTAR	DW	DOCOL,TDUP
            4306 8D05 
  2865 121D			DW	XORR
            FD03 
  2866 121F			DW	TOR
            8E04 
  2867 1221			DW	ABS
            CD11 
  2868 1223			DW	SWAP
            7005 
  2869 1225			DW	ABS
            CD11 
  2870 1227			DW	USTAR
            4B03 
  2871 1229			DW	FROMR
            A504 
  2872 122B			DW	DPM
            BA11 
  2873 122D			DW	SEMIS
            6104 
  2874 			;
  2875 122F			DB	82H	; M/
            82 
  2876 1230			DB	'M'
            4D 
  2877 1231			DB	'/'+80H
            2F 80 
  2878 1233			DW	MSTAR-5
            1412 
  2879 1235		MSLAS	DW	DOCOL
            4306 
  2880 1237			DW	OVER
            5205 
  2881 1239			DW	TOR
            8E04 
  2882 123B			DW	TOR
            8E04 
  2883 123D			DW	DABS
            DD11 
  2884 123F			DW	RR
            BA04 
  2885 1241			DW	ABS
            CD11 
  2886 1243			DW	USLAS
            8103 
  2887 1245			DW	FROMR
            A504 
  2888 1247			DW	RR
            BA04 
  2889 1249			DW	XORR
            FD03 
  2890 124B			DW	PM
            A711 
  2891 124D			DW	SWAP
            7005 
  2892 124F			DW	FROMR
            A504 
  2893 1251			DW	PM
            A711 
  2894 1253			DW	SWAP
            7005 
  2895 1255			DW	SEMIS
            6104 
  2896 			;
  2897 1257			DB	81H	; *
            81 
  2898 1258			DB	'*'+80H
            2A 80 
  2899 125A			DW	MSLAS-5
            3012 
  2900 125C		STAR	DW	DOCOL
            4306 
  2901 125E			DW	MSTAR
            1912 
  2902 1260			DW	DROP
            6205 
  2903 1262			DW	SEMIS
            6104 
  2904 			;
  2905 1264			DB	84H	; /MOD
            84 
  2906 1265			DB	'/MO'
            2F 4D 4F 
  2907 1268			DB	'D'+80H
            44 80 
  2908 126A			DW	STAR-4
            5812 
  2909 126C		SLMOD	DW	DOCOL
            4306 
  2910 126E			DW	TOR
            8E04 
  2911 1270			DW	STOD
            9111 
  2912 1272			DW	FROMR
            A504 
  2913 1274			DW	MSLAS
            3512 
  2914 1276			DW	SEMIS
            6104 
  2915 			;
  2916 1278			DB	81H	; /
            81 
  2917 1279			DB	'/'+80H
            2F 80 
  2918 127B			DW	SLMOD-7
            6512 
  2919 127D		SLASH	DW	DOCOL
            4306 
  2920 127F			DW	SLMOD
            6C12 
  2921 1281			DW	SWAP
            7005 
  2922 1283			DW	DROP
            6205 
  2923 1285			DW	SEMIS
            6104 
  2924 			;
  2925 1287			DB	83H	; MOD
            83 
  2926 1288			DB	'MO'
            4D 4F 
  2927 128A			DB	'D'+80H
            44 80 
  2928 128C			DW	SLASH-4
            7912 
  2929 128E		MODD	DW	DOCOL
            4306 
  2930 1290			DW	SLMOD
            6C12 
  2931 1292			DW	DROP
            6205 
  2932 1294			DW	SEMIS
            6104 
  2933 			;
  2934 1296			DB	85H	; */MOD
            85 
  2935 1297			DB	'*/MO'
            2A 2F 4D 4F 
            
  2936 129B			DB	'D'+80H
            44 80 
  2937 129D			DW	MODD-6
            8812 
  2938 129F		SSMOD	DW	DOCOL
            4306 
  2939 12A1			DW	TOR
            8E04 
  2940 12A3			DW	MSTAR
            1912 
  2941 12A5			DW	FROMR
            A504 
  2942 12A7			DW	MSLAS
            3512 
  2943 12A9			DW	SEMIS
            6104 
  2944 			;
  2945 12AB			DB	82H	; */
            82 
  2946 12AC			DB	'*'
            2A 
  2947 12AD			DB	'/'+80H
            2F 80 
  2948 12AF			DW	SSMOD-8
            9712 
  2949 12B1		SSLA	DW	DOCOL
            4306 
  2950 12B3			DW	SSMOD
            9F12 
  2951 12B5			DW	SWAP
            7005 
  2952 12B7			DW	DROP
            6205 
  2953 12B9			DW	SEMIS
            6104 
  2954 			;
  2955 12BB			DB	85H	; M/MOD
            85 
  2956 12BC			DB	'M/MO'
            4D 2F 4D 4F 
            
  2957 12C0			DB	'D'+80H
            44 80 
  2958 12C2			DW	SSLA-5
            AC12 
  2959 12C4		MSMOD	DW	DOCOL
            4306 
  2960 12C6			DW	TOR
            8E04 
  2961 12C8			DW	ZERO
            C606 
  2962 12CA			DW	RR
            BA04 
  2963 12CC			DW	USLAS
            8103 
  2964 12CE			DW	FROMR
            A504 
  2965 12D0			DW	SWAP
            7005 
  2966 12D2			DW	TOR
            8E04 
  2967 12D4			DW	USLAS
            8103 
  2968 12D6			DW	FROMR
            A504 
  2969 12D8			DW	SEMIS
            6104 
  2970 			;
  2971 			;	BLOCK MOVED DOWN 2 PAGES
  2972 			;
  2973 			;
  2974 12DA			DB	86H	; (LINE)
            86 
  2975 12DB			DB	'(LINE'
            28 4C 49 4E 
            45 
  2976 12E0			DB	')'+80H
            29 80 
  2977 12E2			DW	MSMOD-8
            BC12 
  2978 12E4		PLINE	DW	DOCOL
            4306 
  2979 12E6			DW	TOR
            8E04 
  2980 12E8			DW	LIT
            5701 
  2981 12EA			DW	40H
            4000 
  2982 12EC			DW	BBUF
            1D07 
  2983 12EE			DW	SSMOD
            9F12 
  2984 12F0			DW	FROMR
            A504 
  2985 12F2			DW	BSCR
            2A07 
  2986 12F4			DW	STAR
            5C12 
  2987 12F6			DW	PLUS
            EA04 
  2988 12F8			DW	BLOCK
            E314 
  2989 12FA			DW	PLUS
            EA04 
  2990 12FC			DW	LIT
            5701 
  2991 12FE			DW	40H
            4000 
  2992 1300			DW	SEMIS
            6104 
  2993 			;
  2994 1302			DB	85H	; .LINE
            85 
  2995 1303			DB	'.LIN'
            2E 4C 49 4E 
            
  2996 1307			DB	'E'+80H
            45 80 
  2997 1309			DW	PLINE-9
            DB12 
  2998 130B		DLINE	DW	DOCOL
            4306 
  2999 130D			DW	PLINE
            E412 
  3000 130F			DW	DTRAI
            A70B 
  3001 1311			DW	TYPE
            780B 
  3002 1313			DW	SEMIS
            6104 
  3003 			;
  3004 1315			DB	87H	; MESSAGE
            87 
  3005 1316			DB	'MESSAG'
            4D 45 53 53 
            41 47 
  3006 131C			DB	'E'+80H
            45 80 
  3007 131E			DW	DLINE-8
            0313 
  3008 1320		MESS	DW	DOCOL
            4306 
  3009 1322			DW	WARN
            7807 
  3010 1324			DW	AT
            C305 
  3011 1326			DW	ZBRAN	; IF
            9601 
  3012 1328			DW	MESS1-$
            1E00 
  3013 132A			DW	DDUP
            3509 
  3014 132C			DW	ZBRAN	; IF
            9601 
  3015 132E			DW	MESS2-$
            1400 
  3016 1330			DW	LIT
            5701 
  3017 1332			DW	4
            0400 
  3018 1334			DW	OFSET
            D107 
  3019 1336			DW	AT
            C305 
  3020 1338			DW	BSCR
            2A07 
  3021 133A			DW	SLASH
            7D12 
  3022 133C			DW	SUBB
            A508 
  3023 133E			DW	DLINE
            0B13 
  3024 1340			DW	SPACE	; ENDIF
            2509 
  3025 1342		MESS2	DW	BRAN	; ELSE
            7D01 
  3026 1344			DW	MESS3-$
            0D00 
  3027 1346		MESS1	DW	PDOTQ
            DB0B 
  3028 1348			DB	6
            06 
  3029 1349			DB	'MSG # '
            4D 53 47 20 
            23 20 
  3030 134F			DW	DOT	; ENDIF
            E619 
  3031 1351		MESS3	DW	SEMIS
            6104 
  3032     			PAGE
  3033 			;------------------------------------------
  3034 			;
  3035 			;	8080 PORT FETCH AND STORE
  3036 			;	( SELF MODIFYING CODE, NOT REENTRANT )
  3037 			;
  3038 1353			DB	82H	; P@ "PORT @"
            82 
  3039 1354			DB	'P'
            50 
  3040 1355			DB	'@'+80H
            40 80 
  3041 1357			DW	MESS-0AH
            1613 
  3042 1359		PTAT:	DW	$+2
            5B13 
  3043 135B D1			POP	D	;E <- PORT#
  3044 135C 21 61 13		LXI	H,$+5
  3045 135F 73			MOV	M,E
  3046 1360 DB 00		IN	0	;( PORT# MODIFIED )
  3047 1362 6F			MOV	L,A	;L <- (PORT#)
  3048 1363 26 00		MVI	H,0
  3049 1365 C3 44 01		JMP	HPUSH
  3050 			;
  3051 1368			DB	82H	; "PORT STORE"
            82 
  3052 1369			DB	'P'
            50 
  3053 136A			DB	'!'+80H
            21 80 
  3054 136C			DW	PTAT-5
            5413 
  3055 136E		PTSTO:	DW	$+2
            7013 
  3056 1370 D1			POP	D	;E <- PORT#
  3057 1371 21 78 13		LXI	H,$+7
  3058 1374 73			MOV	M,E
  3059 1375 E1			POP	H	;H <- CDATA
  3060 1376 7D			MOV	A,L
  3061 1377 D3 00		OUT	0	;( PORT# MODIFIED )
  3062 1379 C3 45 01		JMP	NEXT
  3063
  3064     			PAGE
  3065
  3066 			;;; === === === === === === === === === === === === === === === ===
  3067 			;;; VoidStar8080 Disk Interface
  3068 			;;; === === === === === === === === === === === === === === === ===
  3069
  3070      00 0A	BDRES	EQU	10              ;RESET CONTROLLER (DRV 0, TRK 0, SEC 1)
  3071      00 0B	BDDRV	EQU	11              ;SELECT DRIVE
  3072      00 0C	BDTRK	EQU	12              ;SELECT TRACK
  3073      00 0D	BDSEC	EQU	13              ;SELECT SECTOR
  3074      00 0E	BDDAT	EQU	14              ;READ/WRITE NEXT BYTE
  3075
  3076 			;	DOUBLE DENSITY 8" FLOPPY CAPACITIES
  3077      00 34	SPT2	EQU	52	; SECTORS PER TRACK
  3078      00 4D	TRKS2	EQU	77	; NUMBER OF TRACKS
  3079      0F A4	SPDRV2	EQU	SPT2*TRKS2	; SECTORS/DRIVE
  3080
  3081 			;	SINGLE DENSITY 8" FLOPPY CAPACITIES
  3082      00 1A	SPT1	EQU	26	; SECTORS/TRACK
  3083      00 4D	TRKS1	EQU	77	; # TRACKS
  3084      07 D2	SPDRV1	EQU	SPT1*TRKS1	; SECTORS/DRIVE
  3085
  3086      00 80	BPS	EQU	128	; BYTES PER SECTOR
  3087      00 10	MXDRV	EQU	16	; MAX # DRIVES
  3088
  3089
  3090 			;
  3091 			;	FORTH VARIABLES AND CONSTANTS USED IN DISK INTERFACE
  3092 			;
  3093 137C			DB	85H	; DRIVE ( CURRENT DRIVE # )
            85 
  3094 137D			DB	'DRIV'
            44 52 49 56 
            
  3095 1381			DB	'E'+80H
            45 80 
  3096 1383			DW	PTSTO-5
            6913 
  3097 1385		DRIVE	DW	DOVAR,0
            A206 0000 
  3098 			;
  3099 1389			DB	83H	; SEC	( SECTOR # )
            83 
  3100 138A			DB	'SE'
            53 45 
  3101 138C			DB	'C'+80H
            43 80 
  3102 138E			DW	DRIVE-8
            7D13 
  3103 1390		SEC:	DW	DOVAR
            A206 
  3104 1392			DW	0
            0000 
  3105 			;
  3106 1394			DB	85H	; TRACK	( TRACK # )
            85 
  3107 1395			DB	'TRAC'
            54 52 41 43 
            
  3108 1399			DB	'K'+80H
            4B 80 
  3109 139B			DW	SEC-6
            8A13 
  3110 139D		TRACK:	DW	DOVAR,0
            A206 0000 
  3111 			;
  3112 13A1			DB	83H	; USE	( ADDR OF NEXT BUFFER TO USE )
            83 
  3113 13A2			DB	'US'
            55 53 
  3114 13A4			DB	'E'+80H
            45 80 
  3115 13A6			DW	TRACK-8
            9513 
  3116 13A8		USE:	DW	DOVAR
            A206 
  3117 13AA			DW	BUF1
            E0F3 
  3118 			;
  3119 13AC			DB	84H	; PREV
            84 
  3120 			;			( ADDR OF PREVIOUSLY USED BUFFER )
  3121 13AD			DB	'PRE'
            50 52 45 
  3122 13B0			DB	'V'+80H
            56 80 
  3123 13B2			DW	USE-6
            A213 
  3124 13B4		PREV	DW	DOVAR
            A206 
  3125 13B6			DW	BUF1
            E0F3 
  3126 			;
  3127 13B8			DB	87H	; SEC/BLK ( # SECTORS/BLOCK )
            87 
  3128 13B9			DB	'SEC/BL'
            53 45 43 2F 
            42 4C 
  3129 13BF			DB	'K'+80H
            4B 80 
  3130 13C1			DW	PREV-7
            AD13 
  3131 13C3		SPBLK	DW	DOCON
            8706 
  3132 13C5			DW	KBBUF/BPS
            0100 
  3133 			;
  3134 13C7			DB	85H	; #BUFF  ( NUMBER OF BUFFERS )
            85 
  3135 13C8			DB	'#BUF'
            23 42 55 46 
            
  3136 13CC			DB	'F'+80H
            46 80 
  3137 13CE			DW	SPBLK-10
            B913 
  3138 13D0		NOBUF	DW	DOCON,NBUF
            8706 0800 
  3139 			;
  3140 13D4			DB	87H	; DENSITY ( 0 = SINGLE , 1 = DOUBLE )
            87 
  3141 13D5			DB	'DENSIT'
            44 45 4E 53 
            49 54 
  3142 13DB			DB	'Y'+80H
            59 80 
  3143 13DD			DW	NOBUF-8
            C813 
  3144 13DF		DENSTY	DW	DOVAR
            A206 
  3145 13E1			DW	0
            0000 
  3146 			;
  3147 13E3			DB	8AH	; DISK-ERROR  ( DISK ERROR STATUS )
            8A 
  3148 13E4			DB	'DISK-ERRO'
            44 49 53 4B 
            2D 45 52 52 
            4F 
  3149 13ED			DB	'R'+80H
            52 80 
  3150 13EF			DW	DENSTY-10
            D513 
  3151 13F1		DSKERR	DW	DOVAR,0
            A206 0000 
  3152 			;
  3153 			;	DISK INTERFACE HIGH-LEVEL ROUTINES
  3154 			;
  3155 13F5			DB	84H	; +BUF	( ADVANCE BUFFER )
            84 
  3156 13F6			DB	'+BU'
            2B 42 55 
  3157 13F9			DB	'F'+80H
            46 80 
  3158 13FB			DW	DSKERR-13
            E413 
  3159 13FD		PBUF	DW	DOCOL
            4306 
  3160 13FF			DW	LIT,CO
            5701 8400 
  3161 1403			DW	PLUS,DUP
            EA04 7E05 
  3162 1407			DW	LIMIT,EQUAL
            1007 B408 
  3163 140B			DW	ZBRAN,PBUF1-$
            9601 0800 
  3164 140F			DW	DROP,FIRST
            6205 0307 
  3165 1413		PBUF1:	DW	DUP,PREV
            7E05 B413 
  3166 1417			DW	AT,SUBB
            C305 A508 
  3167 141B			DW	SEMIS
            6104 
  3168 			;
  3169 141D			DB	86H	; UPDATE
            86 
  3170 141E			DB	'UPDAT'
            55 50 44 41 
            54 
  3171 1423			DB	'E'+80H
            45 80 
  3172 1425			DW	PBUF-7
            F613 
  3173 1427		UPDAT	DW	DOCOL,PREV
            4306 B413 
  3174 142B			DW	AT,AT
            C305 C305 
  3175 142F			DW	LIT,8000H
            5701 0080 
  3176 1433			DW	ORR
            E903 
  3177 1435			DW	PREV,AT
            B413 C305 
  3178 1439			DW	STORE,SEMIS
            FD05 6104 
  3179 			;
  3180 143D			DB	8DH	; EMPTY-BUFFERS
            8D 
  3181 143E			DB	'EMPTY-BUFFER'
            45 4D 50 54 
            59 2D 42 55 
            46 46 45 52 
            
  3182 144A			DB	'S'+80H
            53 80 
  3183 144C			DW	UPDAT-9
            1E14 
  3184 144E		MTBUF	DW	DOCOL,FIRST
            4306 0307 
  3185 1452			DW	LIMIT,OVER
            1007 5205 
  3186 1456			DW	SUBB,ERASEE
            A508 1E0D 
  3187 145A			DW	SEMIS
            6104 
  3188 			;
  3189 145C			DB	83H	; DR0
            83 
  3190 145D			DB	'DR'
            44 52 
  3191 145F			DB	'0'+80H
            30 80 
  3192 1461			DW	MTBUF-16
            3E14 
  3193 1463		DRZER	DW	DOCOL,ZERO
            4306 C606 
  3194 1467			DW	OFSET,STORE
            D107 FD05 
  3195 146B			DW	SEMIS
            6104 
  3196 			;
  3197 146D			DB	83H	; DR1
            83 
  3198 146E			DB	'DR'
            44 52 
  3199 1470			DB	'1'+80H
            31 80 
  3200 1472			DW	DRZER-6
            5D14 
  3201 1474		DRONE	DW	DOCOL
            4306 
  3202 1476			DW	DENSTY,AT
            DF13 C305 
  3203 147A			DW	ZBRAN,DRON1-$
            9601 0C00 
  3204 147E			DW	LIT,SPDRV2
            5701 A40F 
  3205 1482			DW	BRAN,DRON2-$
            7D01 0800 
  3206 1486		DRON1	DW	LIT,SPDRV1
            5701 D207 
  3207 148A		DRON2	DW	OFSET,STORE
            D107 FD05 
  3208 148E			DW	SEMIS
            6104 
  3209 			;
  3210 1490			DB	86H	; BUFFER
            86 
  3211 1491			DB	'BUFFE'
            42 55 46 46 
            45 
  3212 1496			DB	'R'+80H
            52 80 
  3213 1498			DW	DRONE-6
            6E14 
  3214 149A		BUFFE:	DW	DOCOL,USE
            4306 A813 
  3215 149E			DW	AT,DUP
            C305 7E05 
  3216 14A2			DW	TOR
            8E04 
  3217 14A4		BUFF1	DW	PBUF		; WON'T WORK IF SINGLE BUFFER
            FD13 
  3218 14A6			DW	ZBRAN,BUFF1-$
            9601 FEFFFFFFFF 
  3219 14AA			DW	USE,STORE
            A813 FD05 
  3220 14AE			DW	RR,AT
            BA04 C305 
  3221 14B2			DW	ZLESS
            D704 
  3222 14B4			DW	ZBRAN,BUFF2-$
            9601 1600 
  3223 14B8			DW	RR,TWOP
            BA04 4D08 
  3224 14BC			DW	RR,AT
            BA04 C305 
  3225 14C0			DW	LIT,7FFFH
            5701 FF7F 
  3226 14C4			DW	ANDD,ZERO
            D603 C606 
  3227 14C8			DW	RSLW
            3016 
  3228 14CA		BUFF2	DW	RR,STORE
            BA04 FD05 
  3229 14CE			DW	RR,PREV
            BA04 B413 
  3230 14D2			DW	STORE,FROMR
            FD05 A504 
  3231 14D6			DW	TWOP,SEMIS
            4D08 6104 
  3232 			;
  3233 14DA			DB	85H	; BLOCK
            85 
  3234 14DB			DB	'BLOC'
            42 4C 4F 43 
            
  3235 14DF			DB	'K'+80H
            4B 80 
  3236 14E1			DW	BUFFE-9
            9114 
  3237 14E3		BLOCK	DW	DOCOL,OFSET
            4306 D107 
  3238 14E7			DW	AT,PLUS
            C305 EA04 
  3239 14EB			DW	TOR,PREV
            8E04 B413 
  3240 14EF			DW	AT,DUP
            C305 7E05 
  3241 14F3			DW	AT,RR
            C305 BA04 
  3242 14F7			DW	SUBB
            A508 
  3243 14F9			DW	DUP,PLUS
            7E05 EA04 
  3244 14FD			DW	ZBRAN,BLOC1-$
            9601 3600 
  3245 1501		BLOC2	DW	PBUF,ZEQU
            FD13 C204 
  3246 1505			DW	ZBRAN,BLOC3-$
            9601 1600 
  3247 1509			DW	DROP,RR
            6205 BA04 
  3248 150D			DW	BUFFE,DUP
            9A14 7E05 
  3249 1511			DW	RR,ONE
            BA04 CF06 
  3250 1515			DW	RSLW
            3016 
  3251 1517			DW	TWO,SUBB
            D806 A508 
  3252 151B		BLOC3	DW	DUP,AT
            7E05 C305 
  3253 151F			DW	RR,SUBB
            BA04 A508 
  3254 1523			DW	DUP,PLUS
            7E05 EA04 
  3255 1527			DW	ZEQU
            C204 
  3256 1529			DW	ZBRAN,BLOC2-$
            9601 D8FFFFFFFF 
  3257 152D			DW	DUP,PREV
            7E05 B413 
  3258 1531			DW	STORE
            FD05 
  3259 1533		BLOC1	DW	FROMR,DROP
            A504 6205 
  3260 1537			DW	TWOP,SEMIS
            4D08 6104 
  3261 			;
  3262 			;
  3263 			;	VoidStar8080 INTERFACE ROUTINES
  3264 			;	modeled on CP/M INTERFACE ROUTINES
  3265 			;	intended to run without BIOS or ROM support
  3266 			;
  3267 153B			DB	86H	; SET-IO
            86 
  3268 			;			( ASSIGN SECTOR, TRACK FOR BDOS )
  3269 153C			DB	'SET-I'
            53 45 54 2D 
            49 
  3270 1541			DB	'O'+80H
            4F 80 
  3271 1543			DW	BLOCK-8
            DB14 
  3272 1545		SETIO:	DW	$+2
            4715 
  3273
  3274 			        ;; === === === === === === === === === === === ===
  3275 1547 3A 92 13	        LDA     SEC+2
  3276 154A D3 0D	        OUT     BDSEC           ;VoidStar8080: set sector number (1..26 or 1..52)
  3277 154C 3A 9F 13	        LDA     TRACK+2
  3278 154F D3 0C	        OUT     BDTRK	        ;VoidStar8080: set track number (0..76)
  3279 			        ;; === === === === === === === === === === === ===
  3280
  3281 1551 C3 45 01		JMP	NEXT
  3282 			;
  3283 1554			DB	89H	; SET-DRIVE
            89 
  3284 1555			DB	'SET-DRIV'
            53 45 54 2D 
            44 52 49 56 
            
  3285 155D			DB	'E'+80H
            45 80 
  3286 155F			DW	SETIO-9
            3C15 
  3287 1561		SETDRV:	DW	$+2
            6315 
  3288
  3289 			        ;; === === === === === === === === === === === ===
  3290 1563 3A 87 13		LDA	DRIVE+2	; (A) <- (DRIVE) = DRIVE #
  3291 1566 D3 0B	        OUT     BDDRV	        ;VoidStar8080: set drive number
  3292 			        ;; === === === === === === === === === === === ===
  3293
  3294 1568 C3 45 01		JMP	NEXT
  3295 			;
  3296 			;	T&SCALC		( CALCULATES DRIVE#, TRACK#, & SECTOR# )
  3297 			;	STACK INPUT: SECTOR-DISPLACEMENT = BLK# * SEC/BLK
  3298 			;	OUTPUT: VARIABLES DRIVE, TRACK, & SEC
  3299 			;
  3300 156B			DB	87H	; T&SCALC
            87 
  3301 156C			DB	'T&SCAL'
            54 26 53 43 
            41 4C 
  3302 1572			DB	'C'+80H
            43 80 
  3303 1574			DW	SETDRV-12
            5515 
  3304 1576		TSCALC:	DW	DOCOL,DENSTY
            4306 DF13 
  3305 157A			DW	AT
            C305 
  3306 157C			DW	ZBRAN,TSCALS-$
            9601 3A00 
  3307 1580			DW	LIT,SPDRV2
            5701 A40F 
  3308 1584			DW	SLMOD
            6C12 
  3309 1586			DW	LIT,MXDRV
            5701 1000 
  3310 158A			DW	MIN
            EC11 
  3311 158C			DW	DUP,DRIVE
            7E05 8513 
  3312 1590			DW	AT,EQUAL
            C305 B408 
  3313 1594			DW	ZBRAN,TSCAL1-$
            9601 0A00 
  3314 1598			DW	DROP
            6205 
  3315 159A			DW	BRAN,TSCAL2-$
            7D01 0A00 
  3316 159E		TSCAL1	DW	DRIVE,STORE
            8513 FD05 
  3317 15A2			DW	SETDRV
            6115 
  3318 15A4		TSCAL2	DW	LIT,SPT2
            5701 3400 
  3319 15A8			DW	SLMOD,TRACK
            6C12 9D13 
  3320 15AC			DW	STORE,ONEP
            FD05 3F08 
  3321 15B0			DW	SEC,STORE
            9013 FD05 
  3322 15B4			DW	SEMIS
            6104 
  3323 			;	SINGLE DENSITY
  3324 15B6		TSCALS	DW	LIT,SPDRV1
            5701 D207 
  3325 15BA			DW	SLMOD
            6C12 
  3326 15BC			DW	LIT,MXDRV
            5701 1000 
  3327 15C0			DW	MIN
            EC11 
  3328 15C2			DW	DUP,DRIVE
            7E05 8513 
  3329 15C6			DW	AT,EQUAL
            C305 B408 
  3330 15CA			DW	ZBRAN,TSCAL3-$
            9601 0A00 
  3331 15CE			DW	DROP
            6205 
  3332 15D0			DW	BRAN,TSCAL4-$
            7D01 0A00 
  3333 15D4		TSCAL3	DW	DRIVE,STORE
            8513 FD05 
  3334 15D8			DW	SETDRV
            6115 
  3335 15DA		TSCAL4	DW	LIT,SPT1
            5701 1A00 
  3336 15DE			DW	SLMOD,TRACK
            6C12 9D13 
  3337 15E2			DW	STORE,ONEP
            FD05 3F08 
  3338 15E6			DW	SEC,STORE
            9013 FD05 
  3339 15EA			DW	SEMIS
            6104 
  3340 			;
  3341 			;	SEC-READ
  3342 			;	( READ A SECTOR SETUP BY 'SET-DRIVE' & 'SETIO' )
  3343 			;
  3344 15EC			DB	88H	; SEC-READ
            88 
  3345 15ED			DB	'SEC-REA'
            53 45 43 2D 
            52 45 41 
  3346 15F4			DB	'D'+80H
            44 80 
  3347 15F6			DW	TSCALC-10
            6C15 
  3348 15F8		SECRD	DW	$+2
            FA15 
  3349
  3350 			        ;; === === === === === === === === === === === ===
  3351 			        ;; VoidStar8080 sector READ:
  3352 			        ;;   DBDRV, DBTRK, DBSEC ports have been set.
  3353 15FA 2A AA 13		LHLD	USE+2	; (HL) <- ADDR BUFFER
  3354 15FD 1E 80	        MVI     E,BPS
  3355 15FF DB 0E	SECRL	IN      BDDAT
  3356 1601 77		        MOV     M,A
  3357 1602 23		        INX     HL
  3358 1603 1D		        DCR     E
  3359 1604 C2 FF 15	        JNZ     SECRL
  3360 			        ;; === === === === === === === === === === === ===
  3361
  3362 1607 C3 45 01		JMP	NEXT
  3363 			;
  3364 			;	SEC-WRITE
  3365 			;	( WRITE A SECTOR SETUP BY 'SET-DRIVE' & 'SETIO' )
  3366 			;
  3367 160A			DB	89H	; SEC-WRITE
            89 
  3368 160B			DB	'SEC-WRIT'
            53 45 43 2D 
            57 52 49 54 
            
  3369 1613			DB	'E'+80H
            45 80 
  3370 1615			DW	SECRD-11
            ED15 
  3371 1617		SECWT	DW	$+2
            1916 
  3372
  3373 			        ;; === === === === === === === === === === === ===
  3374 			        ;; VoidStar8080 sector write:
  3375 			        ;;   DBDRV, DBTRK, DBSEC ports have been set.
  3376 1619 2A AA 13		LHLD	USE+2	; (HL) <- ADDR BUFFER
  3377 161C 1E 80	        MVI     E,BPS
  3378 161E 7E		SECWL	MOV     A,M
  3379 161F 23		        INX     HL
  3380 1620 D3 0E	        OUT     BDDAT
  3381 1622 1D		        DCR     E
  3382 1623 C2 1E 16	        JNZ     SECWL
  3383 			        ;; === === === === === === === === === === === ===
  3384
  3385 1626 C3 45 01		JMP	NEXT
  3386 			;
  3387 1629			DB	83H	; R/W	( FORTH DISK PRIMATIVE )
            83 
  3388 162A			DB	'R/'
            52 2F 
  3389 162C			DB	'W'+80H
            57 80 
  3390 162E			DW	SECWT-12
            0B16 
  3391 1630		RSLW	DW	DOCOL
            4306 
  3392 1632			DW	USE,AT
            A813 C305 
  3393 1636			DW	TOR
            8E04 
  3394 1638			DW	SWAP,SPBLK
            7005 C313 
  3395 163C			DW	STAR,ROT
            5C12 1409 
  3396 1640			DW	USE,STORE
            A813 FD05 
  3397 1644			DW	SPBLK,ZERO
            C313 C606 
  3398 1648			DW	XDO
            F601 
  3399 164A		RSLW1	DW	OVER,OVER
            5205 5205 
  3400 164E			DW	TSCALC,SETIO
            7615 4515 
  3401 1652			DW	ZBRAN,RSLW2-$
            9601 0A00 
  3402 1656			DW	SECRD
            F815 
  3403 1658			DW	BRAN,RSLW3-$
            7D01 0600 
  3404 165C		RSLW2	DW	SECWT
            1716 
  3405 165E		RSLW3	DW	ONEP
            3F08 
  3406 1660			DW	LIT,80H
            5701 8000 
  3407 1664			DW	USE,PSTOR
            A813 9C05 
  3408 1668			DW	XLOOP,RSLW1-$
            AD01 E2FFFFFFFF 
  3409 166C			DW	DROP,DROP
            6205 6205 
  3410 1670			DW	FROMR,USE
            A504 A813 
  3411 1674			DW	STORE,SEMIS
            FD05 6104 
  3412 			;
  3413 			;--------------------------------------------------------
  3414 			;
  3415 			;	ALTERNATIVE R/W FOR NO DISK INTERFACE
  3416 			;
  3417 			;RSLW	DW	DOCOL,DROP,DROP,DROP,SEMIS
  3418 			;
  3419 			;--------------------------------------------------------
  3420 			;
  3421 1678			DB	85H	; FLUSH
            85 
  3422 1679			DB	'FLUS'
            46 4C 55 53 
            
  3423 167D			DB	'H'+80H
            48 80 
  3424 167F			DW	RSLW-6
            2A16 
  3425 1681		FLUSH	DW	DOCOL
            4306 
  3426 1683			DW	NOBUF,ONEP
            D013 3F08 
  3427 1687			DW	ZERO,XDO
            C606 F601 
  3428 168B		FLUS1	DW	ZERO,BUFFE
            C606 9A14 
  3429 168F			DW	DROP
            6205 
  3430 1691			DW	XLOOP,FLUS1-$
            AD01 FAFFFFFFFF 
  3431 1695			DW	SEMIS
            6104 
  3432 			;
  3433 1697			DB	84H	; LOAD
            84 
  3434 1698			DB	'LOA'
            4C 4F 41 
  3435 169B			DB	'D'+80H
            44 80 
  3436 169D			DW	FLUSH-8
            7916 
  3437 169F		LOAD	DW	DOCOL,BLK
            4306 A707 
  3438 16A3			DW	AT,TOR
            C305 8E04 
  3439 16A7			DW	INN,AT
            B007 C305 
  3440 16AB			DW	TOR,ZERO
            8E04 C606 
  3441 16AF			DW	INN,STORE
            B007 FD05 
  3442 16B3			DW	BSCR,STAR
            2A07 5C12 
  3443 16B7			DW	BLK,STORE	; BLK <- SCR * B/SCR
            A707 FD05 
  3444 16BB			DW	INTER		; INTERPRET FROM OTHER SCREEN
            EF0F 
  3445 16BD			DW	FROMR,INN
            A504 B007 
  3446 16C1			DW	STORE
            FD05 
  3447 16C3			DW	FROMR,BLK
            A504 A707 
  3448 16C7			DW	STORE
            FD05 
  3449 16C9			DW	SEMIS
            6104 
  3450 			;
  3451 16CB			DB	0C3H	; -->
            C3 
  3452 16CC			DB	'--'
            2D 2D 
  3453 16CE			DB	'>'+80H
            3E 80 
  3454 16D0			DW	LOAD-7
            9816 
  3455 16D2		ARROW	DW	DOCOL
            4306 
  3456 16D4			DW	QLOAD
            630A 
  3457 16D6			DW	ZERO
            C606 
  3458 16D8			DW	INN
            B007 
  3459 16DA			DW	STORE
            FD05 
  3460 16DC			DW	BSCR
            2A07 
  3461 16DE			DW	BLK
            A707 
  3462 16E0			DW	AT
            C305 
  3463 16E2			DW	OVER
            5205 
  3464 16E4			DW	MODD
            8E12 
  3465 16E6			DW	SUBB
            A508 
  3466 16E8			DW	BLK
            A707 
  3467 16EA			DW	PSTOR
            9C05 
  3468 16EC			DW	SEMIS
            6104 
  3469 			;
  3470     			PAGE
  3471
  3472 			;;; === === === === === === === === === === === === === === === ===
  3473 			;;; VoidStar8080 Serial Device Ports
  3474 			;;; === === === === === === === === === === === === === === === ===
  3475
  3476      00 00	TTYD	EQU     0               ;READ/WRITE DATA FROM/TO PRINTING CONSOLE
  3477      00 01	TTYC	EQU     1               ;PRINTING CONSOLE STATUS/CONTROL PORT
  3478      00 02	CRTD	EQU     2               ;READ/WRITE DATA FROM/TO PRINTING CONSOLE
  3479      00 03	CRTC	EQU     3               ;PRINTING CONSOLE STATUS/CONTROL PORT
  3480      00 04	PPTD	EQU     4               ;READ/WRITE DATA FROM/TO HIGH SPEED PAPER TAPE
  3481      00 05	PPTC	EQU     5               ;HIGH SPEED PAPER TAPE STATUS/CONTROL PORT
  3482      00 06	LPTD	EQU     6               ;WRITE DATA TO LINE PRINTER
  3483      00 07	LPTC	EQU     7               ;LINE PRINTER STATUS/CONTROL PORT
  3484 			;
  3485 16EE		EPRINT	DW	0	; ENABLE PRINTER VARIABLE
            0000 
  3486 			;			; 0 = DISABLED, 1 = ENABLED
  3487 			;
  3488
  3489 			        ;; === === === === === === === === === === === ===
  3490 			        ;; VoidStar8080 CSTAT: A=FF if char ready on console, else A=00
  3491 			        ;; do not modify BC.
  3492 16F0 DB 01	CSTAT	IN      TTYC
  3493 16F2 E6 01	        ANI     01H
  3494 16F4 C8		        RZ                      ;RETURN 00 IF NO DATA AVAILABLE
  3495 16F5 3E FF	        MVI     A,0FFH          ;RETURN FF IF DATA IS AVAILABLE
  3496 16F7 C9		        RET
  3497 			        ;; === === === === === === === === === === === ===
  3498 			;
  3499 			        ;; === === === === === === === === === === === ===
  3500 			        ;; VoidStar8080 CIN: A=next char from console
  3501 			        ;; if no char available, wait for one
  3502 			        ;; do not modify BC
  3503 16F8 DB 01	CIN     IN      TTYC
  3504 16FA E6 01	        ANI     01H
  3505 16FC CA F8 16	        JZ      CIN             ;WAIT FOR DATA AVAILABLE
  3506 16FF DB 00	        IN      TTYD
  3507 1701 E6 7F	        ANI     7FH             ;STRIP THE PARITY BIT
  3508 1703 C9		        RET                     ;RETURN WITH CHAR IN (A)
  3509 			        ;; === === === === === === === === === === === ===
  3510 			;
  3511 			        ;; === === === === === === === === === === === ===
  3512 			        ;; VoidStar8080 COUT: send (C) to the console outputC
  3513 			        ;; if necessary, wait until the channel is available
  3514 1704 DB 01	COUT	IN      TTYC
  3515 1706 E6 02	        ANI     02H
  3516 1708 CA 04 17	        JZ      COUT
  3517 170B 79		        MOV     A,C
  3518 170C D3 00	        OUT     TTYD
  3519 170E C9		        RET
  3520 			        ;; === === === === === === === === === === === ===
  3521 			;
  3522 			        ;; === === === === === === === === === === === ===
  3523 			        ;; VoidStar8080 POUT: send (C) to the printer output
  3524 			        ;; if necessary, wait until the channel is available
  3525 170F DB 07	POUT	IN      LPTC
  3526 1711 E6 02	        ANI     02H
  3527 1713 CA 0F 17	        JZ      POUT
  3528 1716 79		        MOV     A,C
  3529 1717 D3 06	        OUT     LPTD
  3530 1719 C9		        RET
  3531 			        ;; === === === === === === === === === === === ===
  3532 			;
  3533 171A CD 04 17	CPOUT	CALL	COUT	; OUTPUT (C) TO CONSOLE
  3534 171D EB			XCHG
  3535 171E 21 EE 16		LXI	H,EPRINT
  3536 1721 7E			MOV	A,M	; IF (EPRINT) <> 0
  3537 1722 B7			ORA	A
  3538 1723 CA 2A 17		JZ	CPOU1
  3539 1726 4B			MOV	C,E	; THEN OUTPUT (C) TO PRINTER
  3540 1727 CD 0F 17		CALL	POUT
  3541 172A C9		CPOU1	RET
  3542 			;
  3543 			;	FORTH TO CP/M-LIKE SERIAL IO INTERFACE
  3544 			;
  3545 172B CD F0 16	PQTER	CALL	CSTAT	; IF CHR TYPED
  3546 172E 21 00 00		LXI	H,0
  3547 1731 B7			ORA	A
  3548 1732 CA 36 17		JZ	PQTE1
  3549 1735 2C			INR	L	; THEN (S1) <- TRUE
  3550 1736 C3 44 01	PQTE1	JMP	HPUSH	; ELSE (S1) <- FALSE
  3551 			;
  3552 1739 CD F8 16	PKEY	CALL	CIN	; READ CHR FROM CONSOLE
  3553 173C FE 10		CPI	DLE	; IF CHR = (^P)
  3554 173E 5F			MOV	E,A
  3555 173F C2 4B 17		JNZ	PKEY1
  3556 1742 21 EE 16		LXI	H,EPRINT  ; THEN TOGGLE (EPRINT)LSB
  3557 1745 1E 20		MVI	E,ABL	; CHR <- BLANK
  3558 1747 7E			MOV	A,M
  3559 1748 EE 01		XRI	1
  3560 174A 77			MOV	M,A
  3561 174B 6B		PKEY1	MOV	L,E
  3562 174C 26 00		MVI	H,0
  3563 174E C3 44 01		JMP	HPUSH	; (S1)LB <- CHR
  3564 			;
  3565 1751		PEMIT	DW	$+2	; (EMIT)	ORPHAN
            5317 
  3566 1753 E1			POP	H	; (L) <- (S1)LB = CHR
  3567 1754 C5			PUSH	B	; SAVE (IP)
  3568 1755 4D			MOV	C,L
  3569 1756 CD 1A 17		CALL	CPOUT	; OUTPUT CHR TO CONSOLE
  3570 			;			; & MAYBE PRINTER
  3571 1759 C1			POP	B	; RESTORE (IP)
  3572 175A C3 45 01		JMP	NEXT
  3573 			;
  3574 175D C5		PCR	PUSH	B	; SAVE (IP)
  3575 175E 0E 0D		MVI	C,ACR	; OUTPUT (CR) TO CONSOLE
  3576 1760 69			MOV	L,C
  3577 1761 CD 1A 17		CALL	CPOUT	; & MAYBE TO PRINTER
  3578 1764 0E 0A		MVI	C,LF	; OUTPUT (LF) TO CONSOLE
  3579 1766 69			MOV	L,C
  3580 1767 CD 1A 17		CALL	CPOUT	; & MAYBE TO PRINTER
  3581 176A C1			POP	B	; RESTORE (IP)
  3582 176B C3 45 01		JMP	NEXT
  3583 			;
  3584 			;----------------------------------------------------
  3585     			PAGE
  3586 			;
  3587 176E			DB	0C1H	; '	( TICK )
            C1 
  3588 176F			DB	0A7H
            A7 
  3589 1770			DW	ARROW-6
            CC16 
  3590 1772		TICK	DW	DOCOL
            4306 
  3591 1774			DW	DFIND
            640E 
  3592 1776			DW	ZEQU
            C204 
  3593 1778			DW	ZERO
            C606 
  3594 177A			DW	QERR
            E509 
  3595 177C			DW	DROP
            6205 
  3596 177E			DW	LITER
            840F 
  3597 1780			DW	SEMIS
            6104 
  3598 			;
  3599 1782			DB	86H	; FORGET
            86 
  3600 1783			DB	'FORGE'
            46 4F 52 47 
            45 
  3601 1788			DB	'T'+80H
            54 80 
  3602 178A			DW	TICK-4
            6E17 
  3603 178C		FORG	DW	DOCOL
            4306 
  3604 178E			DW	CURR
            ED07 
  3605 1790			DW	AT
            C305 
  3606 1792			DW	CONT
            DF07 
  3607 1794			DW	AT
            C305 
  3608 1796			DW	SUBB
            A508 
  3609 1798			DW	LIT
            5701 
  3610 179A			DW	18H
            1800 
  3611 179C			DW	QERR
            E509 
  3612 179E			DW	TICK
            7217 
  3613 17A0			DW	DUP
            7E05 
  3614 17A2			DW	FENCE
            8407 
  3615 17A4			DW	AT
            C305 
  3616 17A6			DW	LESS
            C108 
  3617 17A8			DW	LIT
            5701 
  3618 17AA			DW	15H
            1500 
  3619 17AC			DW	QERR
            E509 
  3620 17AE			DW	DUP
            7E05 
  3621 17B0			DW	NFA
            A409 
  3622 17B2			DW	DP
            8D07 
  3623 17B4			DW	STORE
            FD05 
  3624 17B6			DW	LFA
            8409 
  3625 17B8			DW	AT
            C305 
  3626 17BA			DW	CONT
            DF07 
  3627 17BC			DW	AT
            C305 
  3628 17BE			DW	STORE
            FD05 
  3629 17C0			DW	SEMIS
            6104 
  3630 			;
  3631 17C2			DB	84H	; BACK
            84 
  3632 17C3			DB	'BAC'
            42 41 43 
  3633 17C6			DB	'K'+80H
            4B 80 
  3634 17C8			DW	FORG-9
            8317 
  3635 17CA		BACK	DW	DOCOL
            4306 
  3636 17CC			DW	HERE
            5D08 
  3637 17CE			DW	SUBB
            A508 
  3638 17D0			DW	COMMA
            7B08 
  3639 17D2			DW	SEMIS
            6104 
  3640 			;
  3641 17D4			DB	0C5H	; BEGIN
            C5 
  3642 17D5			DB	'BEGI'
            42 45 47 49 
            
  3643 17D9			DB	'N'+80H
            4E 80 
  3644 17DB			DW	BACK-7
            C317 
  3645 17DD		BEGIN	DW	DOCOL
            4306 
  3646 17DF			DW	QCOMP
            000A 
  3647 17E1			DW	HERE
            5D08 
  3648 17E3			DW	ONE
            CF06 
  3649 17E5			DW	SEMIS
            6104 
  3650 			;
  3651 17E7			DB	0C5H	; ENDIF
            C5 
  3652 17E8			DB	'ENDI'
            45 4E 44 49 
            
  3653 17EC			DB	'F'+80H
            46 80 
  3654 17EE			DW	BEGIN-8
            D517 
  3655 17F0		ENDIFF	DW	DOCOL
            4306 
  3656 17F2			DW	QCOMP
            000A 
  3657 17F4			DW	TWO
            D806 
  3658 17F6			DW	QPAIR
            310A 
  3659 17F8			DW	HERE
            5D08 
  3660 17FA			DW	OVER
            5205 
  3661 17FC			DW	SUBB
            A508 
  3662 17FE			DW	SWAP
            7005 
  3663 1800			DW	STORE
            FD05 
  3664 1802			DW	SEMIS
            6104 
  3665 			;
  3666 1804			DB	0C4H	; THEN
            C4 
  3667 1805			DB	'THE'
            54 48 45 
  3668 1808			DB	'N'+80H
            4E 80 
  3669 180A			DW	ENDIFF-8
            E817 
  3670 180C		THEN	DW	DOCOL
            4306 
  3671 180E			DW	ENDIFF
            F017 
  3672 1810			DW	SEMIS
            6104 
  3673 			;
  3674 1812			DB	0C2H	; DO
            C2 
  3675 1813			DB	'D'
            44 
  3676 1814			DB	'O'+80H
            4F 80 
  3677 1816			DW	THEN-7
            0518 
  3678 1818		DO	DW	DOCOL
            4306 
  3679 181A			DW	COMP
            7E0A 
  3680 181C			DW	XDO
            F601 
  3681 181E			DW	HERE
            5D08 
  3682 1820			DW	THREE
            E106 
  3683 1822			DW	SEMIS
            6104 
  3684 			;
  3685 1824			DB	0C4H	; LOOP
            C4 
  3686 1825			DB	'LOO'
            4C 4F 4F 
  3687 1828			DB	'P'+80H
            50 80 
  3688 182A			DW	DO-5
            1318 
  3689 182C		LOOP	DW	DOCOL
            4306 
  3690 182E			DW	THREE
            E106 
  3691 1830			DW	QPAIR
            310A 
  3692 1832			DW	COMP
            7E0A 
  3693 1834			DW	XLOOP
            AD01 
  3694 1836			DW	BACK
            CA17 
  3695 1838			DW	SEMIS
            6104 
  3696 			;
  3697 183A			DB	0C5H	; +LOOP
            C5 
  3698 183B			DB	'+LOO'
            2B 4C 4F 4F 
            
  3699 183F			DB	'P'+80H
            50 80 
  3700 1841			DW	LOOP-7
            2518 
  3701 1843		PLOOP	DW	DOCOL
            4306 
  3702 1845			DW	THREE
            E106 
  3703 1847			DW	QPAIR
            310A 
  3704 1849			DW	COMP
            7E0A 
  3705 184B			DW	XPLOO
            E801 
  3706 184D			DW	BACK
            CA17 
  3707 184F			DW	SEMIS
            6104 
  3708 			;
  3709 1851			DB	0C5H	; UNTIL
            C5 
  3710 1852			DB	'UNTI'
            55 4E 54 49 
            
  3711 1856			DB	'L'+80H
            4C 80 
  3712 1858			DW	PLOOP-8
            3B18 
  3713 185A		UNTIL	DW	DOCOL
            4306 
  3714 185C			DW	ONE
            CF06 
  3715 185E			DW	QPAIR
            310A 
  3716 1860			DW	COMP
            7E0A 
  3717 1862			DW	ZBRAN
            9601 
  3718 1864			DW	BACK
            CA17 
  3719 1866			DW	SEMIS
            6104 
  3720 			;
  3721 1868			DB	0C3H	; END
            C3 
  3722 1869			DB	'EN'
            45 4E 
  3723 186B			DB	'D'+80H
            44 80 
  3724 186D			DW	UNTIL-8
            5218 
  3725 186F		ENDD	DW	DOCOL
            4306 
  3726 1871			DW	UNTIL
            5A18 
  3727 1873			DW	SEMIS
            6104 
  3728 			;
  3729 1875			DB	0C5H	; AGAIN
            C5 
  3730 1876			DB	'AGAI'
            41 47 41 49 
            
  3731 187A			DB	'N'+80H
            4E 80 
  3732 187C			DW	ENDD-6
            6918 
  3733 187E		AGAIN	DW	DOCOL
            4306 
  3734 1880			DW	ONE
            CF06 
  3735 1882			DW	QPAIR
            310A 
  3736 1884			DW	COMP
            7E0A 
  3737 1886			DW	BRAN
            7D01 
  3738 1888			DW	BACK
            CA17 
  3739 188A			DW	SEMIS
            6104 
  3740 			;
  3741 188C			DB	0C6H	; REPEAT
            C6 
  3742 188D			DB	'REPEA'
            52 45 50 45 
            41 
  3743 1892			DB	'T'+80H
            54 80 
  3744 1894			DW	AGAIN-8
            7618 
  3745 1896		REPEA	DW	DOCOL
            4306 
  3746 1898			DW	TOR
            8E04 
  3747 189A			DW	TOR
            8E04 
  3748 189C			DW	AGAIN
            7E18 
  3749 189E			DW	FROMR
            A504 
  3750 18A0			DW	FROMR
            A504 
  3751 18A2			DW	TWO
            D806 
  3752 18A4			DW	SUBB
            A508 
  3753 18A6			DW	ENDIFF
            F017 
  3754 18A8			DW	SEMIS
            6104 
  3755 			;
  3756 18AA			DB	0C2H	; IF
            C2 
  3757 18AB			DB	'I'
            49 
  3758 18AC			DB	'F'+80H
            46 80 
  3759 18AE			DW	REPEA-9
            8D18 
  3760 18B0		IFF	DW	DOCOL
            4306 
  3761 18B2			DW	COMP
            7E0A 
  3762 18B4			DW	ZBRAN
            9601 
  3763 18B6			DW	HERE
            5D08 
  3764 18B8			DW	ZERO
            C606 
  3765 18BA			DW	COMMA
            7B08 
  3766 18BC			DW	TWO
            D806 
  3767 18BE			DW	SEMIS
            6104 
  3768 			;
  3769 18C0			DB	0C4H	; ELSE
            C4 
  3770 18C1			DB	'ELS'
            45 4C 53 
  3771 18C4			DB	'E'+80H
            45 80 
  3772 18C6			DW	IFF-5
            AB18 
  3773 18C8		ELSEE	DW	DOCOL
            4306 
  3774 18CA			DW	TWO
            D806 
  3775 18CC			DW	QPAIR
            310A 
  3776 18CE			DW	COMP
            7E0A 
  3777 18D0			DW	BRAN
            7D01 
  3778 18D2			DW	HERE
            5D08 
  3779 18D4			DW	ZERO
            C606 
  3780 18D6			DW	COMMA
            7B08 
  3781 18D8			DW	SWAP
            7005 
  3782 18DA			DW	TWO
            D806 
  3783 18DC			DW	ENDIFF
            F017 
  3784 18DE			DW	TWO
            D806 
  3785 18E0			DW	SEMIS
            6104 
  3786 			;
  3787 18E2			DB	0C5H	; WHILE
            C5 
  3788 18E3			DB	'WHIL'
            57 48 49 4C 
            
  3789 18E7			DB	'E'+80H
            45 80 
  3790 18E9			DW	ELSEE-7
            C118 
  3791 18EB		WHILE	DW	DOCOL
            4306 
  3792 18ED			DW	IFF
            B018 
  3793 18EF			DW	TWOP
            4D08 
  3794 18F1			DW	SEMIS
            6104 
  3795 			;
  3796 18F3			DB	86H	; SPACES
            86 
  3797 18F4			DB	'SPACE'
            53 50 41 43 
            45 
  3798 18F9			DB	'S'+80H
            53 80 
  3799 18FB			DW	WHILE-8
            E318 
  3800 18FD		SPACS	DW	DOCOL
            4306 
  3801 18FF			DW	ZERO
            C606 
  3802 1901			DW	MAX
            0312 
  3803 1903			DW	DDUP
            3509 
  3804 1905			DW	ZBRAN	; IF
            9601 
  3805 1907			DW	SPAX1-$
            0C00 
  3806 1909			DW	ZERO
            C606 
  3807 190B			DW	XDO	; DO
            F601 
  3808 190D		SPAX2	DW	SPACE
            2509 
  3809 190F			DW	XLOOP	; LOOP	ENDIF
            AD01 
  3810 1911			DW	SPAX2-$
            FCFFFFFFFF 
  3811 1913		SPAX1	DW	SEMIS
            6104 
  3812 			;
  3813 1915			DB	82H	; <#
            82 
  3814 1916			DB	'<'
            3C 
  3815 1917			DB	'#'+80H
            23 80 
  3816 1919			DW	SPACS-9
            F418 
  3817 191B		BDIGS	DW	DOCOL
            4306 
  3818 191D			DW	PAD
            590D 
  3819 191F			DW	HLD
            3508 
  3820 1921			DW	STORE
            FD05 
  3821 1923			DW	SEMIS
            6104 
  3822 			;
  3823 1925			DB	82H	; #>
            82 
  3824 1926			DB	'#'
            23 
  3825 1927			DB	'>'+80H
            3E 80 
  3826 1929			DW	BDIGS-5
            1619 
  3827 192B		EDIGS	DW	DOCOL
            4306 
  3828 192D			DW	DROP
            6205 
  3829 192F			DW	DROP
            6205 
  3830 1931			DW	HLD
            3508 
  3831 1933			DW	AT
            C305 
  3832 1935			DW	PAD
            590D 
  3833 1937			DW	OVER
            5205 
  3834 1939			DW	SUBB
            A508 
  3835 193B			DW	SEMIS
            6104 
  3836 			;
  3837 193D			DB	84H	; SIGN
            84 
  3838 193E			DB	'SIG'
            53 49 47 
  3839 1941			DB	'N'+80H
            4E 80 
  3840 1943			DW	EDIGS-5
            2619 
  3841 1945		SIGN	DW	DOCOL
            4306 
  3842 1947			DW	ROT
            1409 
  3843 1949			DW	ZLESS
            D704 
  3844 194B			DW	ZBRAN	; IF
            9601 
  3845 194D			DW	SIGN1-$
            0800 
  3846 194F			DW	LIT
            5701 
  3847 1951			DW	2DH
            2D00 
  3848 1953			DW	HOLD	; ENDIF
            400D 
  3849 1955		SIGN1	DW	SEMIS
            6104 
  3850 			;
  3851 1957			DB	81H	; #
            81 
  3852 1958			DB	'#'+80H
            23 80 
  3853 195A			DW	SIGN-7
            3E19 
  3854 195C		DIG	DW	DOCOL
            4306 
  3855 195E			DW	BASE
            0408 
  3856 1960			DW	AT
            C305 
  3857 1962			DW	MSMOD
            C412 
  3858 1964			DW	ROT
            1409 
  3859 1966			DW	LIT
            5701 
  3860 1968			DW	9
            0900 
  3861 196A			DW	OVER
            5205 
  3862 196C			DW	LESS
            C108 
  3863 196E			DW	ZBRAN	; IF
            9601 
  3864 1970			DW	DIG1-$
            0800 
  3865 1972			DW	LIT
            5701 
  3866 1974			DW	7
            0700 
  3867 1976			DW	PLUS	; ENDIF
            EA04 
  3868 1978		DIG1	DW	LIT
            5701 
  3869 197A			DW	30H
            3000 
  3870 197C			DW	PLUS
            EA04 
  3871 197E			DW	HOLD
            400D 
  3872 1980			DW	SEMIS
            6104 
  3873 			;
  3874 1982			DB	82H	; #S
            82 
  3875 1983			DB	'#'
            23 
  3876 1984			DB	'S'+80H
            53 80 
  3877 1986			DW	DIG-4
            5819 
  3878 1988		DIGS	DW	DOCOL
            4306 
  3879 198A		DIGS1	DW	DIG	; BEGIN
            5C19 
  3880 198C			DW	OVER
            5205 
  3881 198E			DW	OVER
            5205 
  3882 1990			DW	ORR
            E903 
  3883 1992			DW	ZEQU
            C204 
  3884 1994			DW	ZBRAN	; UNTIL
            9601 
  3885 1996			DW	DIGS1-$
            F4FFFFFFFF 
  3886 1998			DW	SEMIS
            6104 
  3887 			;
  3888 199A			DB	83H	; D.R
            83 
  3889 199B			DB	'D.'
            44 2E 
  3890 199D			DB	'R'+80H
            52 80 
  3891 199F			DW	DIGS-5
            8319 
  3892 19A1		DDOTR	DW	DOCOL
            4306 
  3893 19A3			DW	TOR
            8E04 
  3894 19A5			DW	SWAP
            7005 
  3895 19A7			DW	OVER
            5205 
  3896 19A9			DW	DABS
            DD11 
  3897 19AB			DW	BDIGS
            1B19 
  3898 19AD			DW	DIGS
            8819 
  3899 19AF			DW	SIGN
            4519 
  3900 19B1			DW	EDIGS
            2B19 
  3901 19B3			DW	FROMR
            A504 
  3902 19B5			DW	OVER
            5205 
  3903 19B7			DW	SUBB
            A508 
  3904 19B9			DW	SPACS
            FD18 
  3905 19BB			DW	TYPE
            780B 
  3906 19BD			DW	SEMIS
            6104 
  3907 			;
  3908 19BF			DB	82H	; .R
            82 
  3909 19C0			DB	'.'
            2E 
  3910 19C1			DB	'R'+80H
            52 80 
  3911 19C3			DW	DDOTR-6
            9B19 
  3912 19C5		DOTR	DW	DOCOL
            4306 
  3913 19C7			DW	TOR
            8E04 
  3914 19C9			DW	STOD
            9111 
  3915 19CB			DW	FROMR
            A504 
  3916 19CD			DW	DDOTR
            A119 
  3917 19CF			DW	SEMIS
            6104 
  3918 			;
  3919 19D1			DB	82H	; D.
            82 
  3920 19D2			DB	'D'
            44 
  3921 19D3			DB	'.'+80H
            2E 80 
  3922 19D5			DW	DOTR-5
            C019 
  3923 19D7		DDOT	DW	DOCOL
            4306 
  3924 19D9			DW	ZERO
            C606 
  3925 19DB			DW	DDOTR
            A119 
  3926 19DD			DW	SPACE
            2509 
  3927 19DF			DW	SEMIS
            6104 
  3928 			;
  3929 19E1			DB	81H	; .
            81 
  3930 19E2			DB	'.'+80H
            2E 80 
  3931 19E4			DW	DDOT-5
            D219 
  3932 19E6		DOT	DW	DOCOL
            4306 
  3933 19E8			DW	STOD
            9111 
  3934 19EA			DW	DDOT
            D719 
  3935 19EC			DW	SEMIS
            6104 
  3936 			;
  3937 19EE			DB	81H	; ?
            81 
  3938 19EF			DB	'?'+80H
            3F 80 
  3939 19F1			DW	DOT-4
            E219 
  3940 19F3		QUES	DW	DOCOL
            4306 
  3941 19F5			DW	AT
            C305 
  3942 19F7			DW	DOT
            E619 
  3943 19F9			DW	SEMIS
            6104 
  3944 			;
  3945 19FB			DB	82H	; U.
            82 
  3946 19FC			DB	'U'
            55 
  3947 19FD			DB	'.'+80H
            2E 80 
  3948 19FF			DW	QUES-4
            EF19 
  3949 1A01		UDOT	DW	DOCOL
            4306 
  3950 1A03			DW	ZERO
            C606 
  3951 1A05			DW	DDOT
            D719 
  3952 1A07			DW	SEMIS
            6104 
  3953 			;
  3954 1A09			DB	85H	; VLIST
            85 
  3955 1A0A			DB	'VLIS'
            56 4C 49 53 
            
  3956 1A0E			DB	'T'+80H
            54 80 
  3957 1A10			DW	UDOT-5
            FC19 
  3958 1A12		VLIST	DW	DOCOL
            4306 
  3959 1A14			DW	LIT
            5701 
  3960 1A16			DW	80H
            8000 
  3961 1A18			DW	OUTT
            BA07 
  3962 1A1A			DW	STORE
            FD05 
  3963 1A1C			DW	CONT
            DF07 
  3964 1A1E			DW	AT
            C305 
  3965 1A20			DW	AT
            C305 
  3966 1A22		VLIS1	DW	OUTT	; BEGIN
            BA07 
  3967 1A24			DW	AT
            C305 
  3968 1A26			DW	CSLL
            F606 
  3969 1A28			DW	GREAT
            0509 
  3970 1A2A			DW	ZBRAN	; IF
            9601 
  3971 1A2C			DW	VLIS2-$
            0A00 
  3972 1A2E			DW	CR
            1F03 
  3973 1A30			DW	ZERO
            C606 
  3974 1A32			DW	OUTT
            BA07 
  3975 1A34			DW	STORE	; ENDIF
            FD05 
  3976 1A36		VLIS2	DW	DUP
            7E05 
  3977 1A38			DW	IDDOT
            D60E 
  3978 1A3A			DW	SPACE
            2509 
  3979 1A3C			DW	SPACE
            2509 
  3980 1A3E			DW	PFA
            BB09 
  3981 1A40			DW	LFA
            8409 
  3982 1A42			DW	AT
            C305 
  3983 1A44			DW	DUP
            7E05 
  3984 1A46			DW	ZEQU
            C204 
  3985 1A48			DW	QTERM
            1103 
  3986 1A4A			DW	ORR
            E903 
  3987 1A4C			DW	ZBRAN	; UNTIL
            9601 
  3988 1A4E			DW	VLIS1-$
            D4FFFFFFFF 
  3989 1A50			DW	DROP
            6205 
  3990 1A52			DW	SEMIS
            6104 
  3991 			;
  3992 			        ;; === === === === === === === === === === === ===
  3993 			        ;; EXIT to VoidStar8080 Monitor
  3994 1A54			DB	83H	; BYE
            83 
  3995 1A55			DB	'BY'
            42 59 
  3996 1A57			DB	'E'+80H
            45 80 
  3997 1A59			DW	VLIST-8
            0A1A 
  3998 1A5B		BYE	DW	$+2
            5D1A 
  3999 1A5D C3 00 F8		JMP	ROMBASE
  4000 			        ;; === === === === === === === === === === === ===
  4001 			;
  4002 1A60			DB	84H	; LIST
            84 
  4003 1A61			DB	'LIS'
            4C 49 53 
  4004 1A64			DB	'T'+80H
            54 80 
  4005 1A66			DW	BYE-6
            551A 
  4006 1A68		LIST	DW	DOCOL,DEC
            4306 E40A 
  4007 1A6C			DW	CR,DUP
            1F03 7E05 
  4008 1A70			DW	SCR,STORE
            C407 FD05 
  4009 1A74			DW	PDOTQ
            DB0B 
  4010 1A76			DB	6,'SCR # '
            06 53 43 52 
            20 23 20 
  4011 1A7D			DW	DOT
            E619 
  4012 1A7F			DW	LIT,10H
            5701 1000 
  4013 1A83			DW	ZERO,XDO
            C606 F601 
  4014 1A87		LIST1	DW	CR,IDO
            1F03 1302 
  4015 1A8B			DW	LIT,3
            5701 0300 
  4016 1A8F			DW	DOTR,SPACE
            C519 2509 
  4017 1A93			DW	IDO,SCR
            1302 C407 
  4018 1A97			DW	AT,DLINE
            C305 0B13 
  4019 1A9B			DW	QTERM		; ?TERMINAL
            1103 
  4020 1A9D			DW	ZBRAN,LIST2-$	; IF
            9601 0600 
  4021 1AA1			DW	LEAVE		; LEAVE
            7904 
  4022 1AA3		LIST2	DW	XLOOP,LIST1-$	; ENDIF
            AD01 E4FFFFFFFF 
  4023 1AA7			DW	CR,SEMIS
            1F03 6104 
  4024 			;
  4025 1AAB			DB	85H	; INDEX
            85 
  4026 1AAC			DB	'INDE'
            49 4E 44 45 
            
  4027 1AB0			DB	'X'+80H
            58 80 
  4028 1AB2			DW	LIST-7
            611A 
  4029 1AB4		INDEX	DW	DOCOL
            4306 
  4030 1AB6			DW	LIT,FF
            5701 0C00 
  4031 1ABA			DW	EMIT,CR
            EC02 1F03 
  4032 1ABE			DW	ONEP,SWAP
            3F08 7005 
  4033 1AC2			DW	XDO
            F601 
  4034 1AC4		INDE1	DW	CR,IDO
            1F03 1302 
  4035 1AC8			DW	LIT,3
            5701 0300 
  4036 1ACC			DW	DOTR,SPACE
            C519 2509 
  4037 1AD0			DW	ZERO,IDO
            C606 1302 
  4038 1AD4			DW	DLINE,QTERM
            0B13 1103 
  4039 1AD8			DW	ZBRAN,INDE2-$
            9601 0600 
  4040 1ADC			DW	LEAVE
            7904 
  4041 1ADE		INDE2	DW	XLOOP,INDE1-$
            AD01 E6FFFFFFFF 
  4042 1AE2			DW	SEMIS
            6104 
  4043 			;
  4044 1AE4			DB	85H	; TRIAD
            85 
  4045 1AE5			DB	'TRIA'
            54 52 49 41 
            
  4046 1AE9			DB	'D'+80H
            44 80 
  4047 1AEB			DW	INDEX-8
            AC1A 
  4048 1AED		TRIAD	DW	DOCOL
            4306 
  4049 1AEF			DW	LIT,FF
            5701 0C00 
  4050 1AF3			DW	EMIT
            EC02 
  4051 1AF5			DW	LIT,3
            5701 0300 
  4052 1AF9			DW	SLASH
            7D12 
  4053 1AFB			DW	LIT,3
            5701 0300 
  4054 1AFF			DW	STAR
            5C12 
  4055 1B01			DW	LIT,3
            5701 0300 
  4056 1B05			DW	OVER,PLUS
            5205 EA04 
  4057 1B09			DW	SWAP,XDO
            7005 F601 
  4058 1B0D		TRIA1	DW	CR,IDO
            1F03 1302 
  4059 1B11			DW	LIST
            681A 
  4060 1B13			DW	QTERM		; ?TERMINAL
            1103 
  4061 1B15			DW	ZBRAN,TRIA2-$	; IF
            9601 0600 
  4062 1B19			DW	LEAVE		; LEAVE
            7904 
  4063 1B1B		TRIA2	DW	XLOOP,TRIA1-$	; ENDIF
            AD01 F2FFFFFFFF 
  4064 1B1F			DW	CR
            1F03 
  4065 1B21			DW	LIT,15
            5701 0F00 
  4066 1B25			DW	MESS,CR
            2013 1F03 
  4067 1B29			DW	SEMIS
            6104 
  4068 			;
  4069 1B2B			DB	84H	; .CPU
            84 
  4070 1B2C			DB	'.CP'
            2E 43 50 
  4071 1B2F			DB	'U'+80H
            55 80 
  4072 1B31			DW	TRIAD-8
            E51A 
  4073 1B33		DOTCPU	DW	DOCOL
            4306 
  4074 1B35			DW	BASE,AT
            0408 C305 
  4075 1B39			DW	LIT,36
            5701 2400 
  4076 1B3D			DW	BASE,STORE
            0408 FD05 
  4077 1B41			DW	LIT,22H
            5701 2200 
  4078 1B45			DW	PORIG,TAT
            3907 E205 
  4079 1B49			DW	DDOT
            D719 
  4080 1B4B			DW	BASE,STORE
            0408 FD05 
  4081 1B4F			DW	SEMIS
            6104 
  4082 			;
  4083 1B51			DB	84H	; TASK
            84 
  4084 1B52			DB	'TAS'
            54 41 53 
  4085 1B55			DB	'K'+80H
            4B 80 
  4086 1B57			DW	DOTCPU-7
            2C1B 
  4087 1B59		TASK	DW	DOCOL
            4306 
  4088 1B5B			DW	SEMIS
            6104 
  4089 			;
  4090 1B5D		INITDP:	DS	EM-$	;CONSUME MEMORY TO LIMIT
  4091 			;
  4092     			PAGE
  4093 			;
  4094 			;		MEMORY MAP
  4095 			;	( THE FOLLOWING EQUATES ARE NOT REFERENCED ELSEWHERE )
  4096 			;
  4097 			;		LOCATION	CONTENTS
  4098 			;		--------	--------
  4099      01 00	MCOLD	EQU 	ORIG		;JMP TO COLD START
  4100      01 04	MWARM	EQU	ORIG+4		;JMP TO WARM START
  4101      01 08	MA2	EQU	ORIG+8		;COLD START PARAMETERS
  4102      01 26	MUP	EQU	UP		;USER VARIABLES' BASE 'REG'
  4103      01 28	MRP	EQU	RPP		;RETURN STACK 'REGISTER'
  4104 			;
  4105      01 2A	MBIP	EQU	BIP		;DEBUG SUPPORT
  4106      01 43	MDPUSH	EQU	DPUSH		;ADDRESS INTERPRETER
  4107      01 44	MHPUSH	EQU	HPUSH
  4108      01 45	MNEXT	EQU	NEXT
  4109 			;
  4110      01 50	MDP0	EQU	DP0		;START FORTH DICTIONARY
  4111      13 85	MDIO	EQU	DRIVE		  ;BDEV INTERFACE
  4112      16 EE	MCIO	EQU	EPRINT		  ;CDEV INTERFACE
  4113      1B 5D	MIDP	EQU	INITDP		;END INITIAL FORTH DICTIONARY
  4114 			;				  = COLD (DP) VALUE
  4115 			;				  = COLD (FENCE) VALUE
  4116 			;				  |  NEW
  4117 			;				  |  DEFINITIONS
  4118 			;				  V
  4119 			;
  4120 			;				  ^
  4121 			;				  |  DATA
  4122 			;				  |  STACK
  4123      F3 00	MIS0	EQU	INITS0		;  = COLD (SP) VALUE = (S0)
  4124 			;				   = (TIB)
  4125 			;				  |  TERMINAL INPUT
  4126 			;				  |  BUFFER
  4127 			;				  V
  4128 			;
  4129 			;				  ^
  4130 			;				  |  RETURN
  4131 			;				  |  STACK
  4132      F3 A0	MIR0	EQU	INITR0		;START USER VARIABLES
  4133 			;				  = COLD (RP) VALUE = (R0)
  4134 			;				  = (UP)
  4135 			;				;END USER VARIABLES
  4136      F3 E0	MFIRST	EQU	BUF1		;START DISK BUFFERS
  4137 			;				  = FIRST
  4138      F7 FF	MEND	EQU	EM-1		;END DISK BUFFERS
  4139      F8 00	MLIMIT	EQU	EM		;LAST MEMORY LOC USED + 1
  4140 			;				  = LIMIT
  4141 			;
  4142 			;
  4143     			END	ORIG


*******************************************************************************
                                 Symbols table
*******************************************************************************

Names		Types	Values
-----		-----	------
RAMKB		EQU	0003Eh
ROMKB		EQU	00002h
RAMTOP		EQU	0F800h
ROMBASE		EQU	0F800h
FIGREL		EQU	00001h
FIGREV		EQU	00001h
USRVER		EQU	00001h
ABL		EQU	00020h
ACR		EQU	0000Dh
ADOT		EQU	0002Eh
BELL		EQU	00007h
BSIN		EQU	0007Fh
BSOUT		EQU	00008h
DLE		EQU	00010h
LF		EQU	0000Ah
FF		EQU	0000Ch
EM		EQU	0F800h
NSCR		EQU	00001h
KBBUF		EQU	00080h
US		EQU	00040h
RTS		EQU	000A0h
CO		EQU	00084h
NBUF		EQU	00008h
BUF1		EQU	0F3E0h
INITR0		EQU	0F3A0h
INITS0		EQU	0F300h
BDRES		EQU	0000Ah
BDDRV		EQU	0000Bh
BDTRK		EQU	0000Ch
BDSEC		EQU	0000Dh
BDDAT		EQU	0000Eh
SPT2		EQU	00034h
TRKS2		EQU	0004Dh
SPDRV2		EQU	00FA4h
SPT1		EQU	0001Ah
TRKS1		EQU	0004Dh
SPDRV1		EQU	007D2h
BPS		EQU	00080h
MXDRV		EQU	00010h
TTYD		EQU	00000h
TTYC		EQU	00001h
CRTD		EQU	00002h
CRTC		EQU	00003h
PPTD		EQU	00004h
PPTC		EQU	00005h
LPTD		EQU	00006h
LPTC		EQU	00007h
MCOLD		EQU	00100h
MWARM		EQU	00104h
MA2		EQU	00108h
MUP		EQU	00126h
MRP		EQU	00128h
MBIP		EQU	0012Ah
MDPUSH		EQU	00143h
MHPUSH		EQU	00144h
MNEXT		EQU	00145h
MDP0		EQU	00150h
MDIO		EQU	01385h
MCIO		EQU	016EEh
MIDP		EQU	01B5Dh
MIS0		EQU	0F300h
MIR0		EQU	0F3A0h
MFIRST		EQU	0F3E0h
MEND		EQU	0F7FFh
MLIMIT		EQU	0F800h
ORIG		Label	00100h
UP		Label	00126h
RPP		Label	00128h
BIP		Label	0012Ah
TNEXT		Label	0012Ch
BREAK		Label	0013Ah
TNEXT1		Label	0013Dh
DPUSH		Label	00143h
HPUSH		Label	00144h
NEXT		Label	00145h
NEXT1		Label	0014Bh
DP0		Label	00150h
LIT		Label	00157h
EXEC		Label	0016Dh
BRAN		Label	0017Dh
BRAN1		Label	0017Fh
ZBRAN		Label	00196h
XLOOP		Label	001ADh
XLOO1		Label	001B2h
XLOO2		Label	001CCh
XLOO3		Label	001D1h
XPLOO		Label	001E8h
XDO		Label	001F6h
IDO		Label	00213h
DIGIT		Label	00228h
DIGI1		Label	0023Eh
DIGI2		Label	00249h
PFIND		Label	00257h
PFIN1		Label	0025Ah
PFIN2		Label	00263h
PFIN6		Label	00273h
PFIN3		Label	00282h
PFIN4		Label	00285h
PFIN5		Label	0028Bh
ENCL		Label	002A7h
ENCL1		Label	002B1h
ENCL2		Label	002C9h
ENCL3		Label	002D5h
ENCL4		Label	002DCh
EMIT		Label	002ECh
KEY		Label	002FFh
QTERM		Label	00311h
CR		Label	0031Fh
CMOVE		Label	0032Dh
CMOV1		Label	00337h
CMOV2		Label	0033Ch
USTAR		Label	0034Bh
MPYX		Label	00369h
MPYX1		Label	0036Eh
MPYX2		Label	00376h
USLAS		Label	00381h
USLA1		Label	0039Eh
USLA2		Label	003A0h
USLA3		Label	003A9h
USLA4		Label	003B8h
USLA5		Label	003C3h
USLA6		Label	003C4h
USLA7		Label	003C9h
ANDD		Label	003D6h
ORR		Label	003E9h
XORR		Label	003FDh
SPAT		Label	00411h
SPSTO		Label	00421h
RPAT		Label	00439h
RPSTO		Label	00448h
SEMIS		Label	00461h
LEAVE		Label	00479h
TOR		Label	0048Eh
FROMR		Label	004A5h
RR		Label	004BAh
ZEQU		Label	004C2h
ZEQU1		Label	004CEh
ZLESS		Label	004D7h
ZLES1		Label	004E2h
PLUS		Label	004EAh
DPLUS		Label	004F8h
MINUS		Label	0051Ch
DMINU		Label	00533h
OVER		Label	00552h
DROP		Label	00562h
SWAP		Label	00570h
DUP		Label	0057Eh
TDUP		Label	0058Dh
PSTOR		Label	0059Ch
TOGGL		Label	005B4h
AT		Label	005C3h
CAT		Label	005D3h
TAT		Label	005E2h
STORE		Label	005FDh
CSTOR		Label	0060Dh
TSTOR		Label	0061Bh
COLON		Label	0062Fh
DOCOL		Label	00643h
SEMI		Label	00657h
NOOP		Label	0066Dh
CON		Label	0067Dh
DOCON		Label	00687h
VAR		Label	0069Ch
DOVAR		Label	006A2h
USER		Label	006AFh
DOUSE		Label	006B5h
ZERO		Label	006C6h
ONE		Label	006CFh
TWO		Label	006D8h
THREE		Label	006E1h
BL		Label	006EBh
CSLL		Label	006F6h
FIRST		Label	00703h
LIMIT		Label	00710h
BBUF		Label	0071Dh
BSCR		Label	0072Ah
PORIG		Label	00739h
SZERO		Label	00749h
RZERO		Label	00753h
TIB		Label	0075Eh
WIDTH		Label	0076Ah
WARN		Label	00778h
FENCE		Label	00784h
DP		Label	0078Dh
VOCL		Label	0079Ch
BLK		Label	007A7h
INN		Label	007B0h
OUTT		Label	007BAh
SCR		Label	007C4h
OFSET		Label	007D1h
CONT		Label	007DFh
CURR		Label	007EDh
STATE		Label	007F9h
BASE		Label	00804h
DPL		Label	0080Eh
FLD		Label	00818h
CSPP		Label	00822h
RNUM		Label	0082Bh
HLD		Label	00835h
ONEP		Label	0083Fh
TWOP		Label	0084Dh
HERE		Label	0085Dh
ALLOT		Label	0086Eh
COMMA		Label	0087Bh
CCOMM		Label	0088Dh
SSUB		Label	00899h
SUBB		Label	008A5h
EQUAL		Label	008B4h
LESS		Label	008C1h
LES1		Label	008CDh
LES2		Label	008D8h
ULESS		Label	008E4h
ULES1		Label	008FAh
ULES2		Label	008FEh
GREAT		Label	00905h
ROT		Label	00914h
SPACE		Label	00925h
DDUP		Label	00935h
DDUP1		Label	0093Fh
TRAV		Label	0094Dh
TRAV1		Label	00951h
LATES		Label	00973h
LFA		Label	00984h
CFA		Label	00995h
NFA		Label	009A4h
PFA		Label	009BBh
SCSP		Label	009D1h
QERR		Label	009E5h
QERR1		Label	009F3h
QERR2		Label	009F5h
QCOMP		Label	00A00h
QEXEC		Label	00A19h
QPAIR		Label	00A31h
QCSP		Label	00A45h
QLOAD		Label	00A63h
COMP		Label	00A7Eh
LBRAC		Label	00A95h
RBRAC		Label	00AA4h
SMUDG		Label	00ABAh
HEX		Label	00ACDh
DEC		Label	00AE4h
PSCOD		Label	00AFBh
SEMIC		Label	00B12h
SEMI1		Label	00B1Ch
BUILD		Label	00B2Bh
DOES		Label	00B3Ch
DODOE		Label	00B48h
COUNT		Label	00B64h
TYPE		Label	00B78h
TYPE2		Label	00B88h
TYPE1		Label	00B96h
TYPE3		Label	00B98h
DTRAI		Label	00BA7h
DTRA1		Label	00BAFh
DTRA2		Label	00BC9h
DTRA3		Label	00BCDh
PDOTQ		Label	00BDBh
DOTQ		Label	00BF4h
DOTQ1		Label	00C14h
DOTQ2		Label	00C1Ch
EXPEC		Label	00C28h
EXPE1		Label	00C32h
EXPE6		Label	00C64h
EXPE7		Label	00C68h
EXPE2		Label	00C6Ch
EXPE4		Label	00C84h
EXPE5		Label	00C86h
EXPE3		Label	00C92h
QUERY		Label	00CA5h
NULL		Label	00CBDh
NULL2		Label	00CEBh
NULL1		Label	00CEFh
NULL3		Label	00CF3h
FILL		Label	00CFDh
FILL1		Label	00D05h
FILL2		Label	00D11h
ERASEE		Label	00D1Eh
BLANK		Label	00D30h
HOLD		Label	00D40h
PAD		Label	00D59h
WORD		Label	00D6Dh
WORD1		Label	00D81h
WORD2		Label	00D85h
PNUMB		Label	00DBFh
PNUM1		Label	00DC1h
PNUM3		Label	00DF7h
PNUM2		Label	00DFDh
NUMB		Label	00E0Bh
NUMB1		Label	00E29h
NUMB2		Label	00E4Fh
NUMB3		Label	00E59h
DFIND		Label	00E64h
DFIN1		Label	00E84h
PABOR		Label	00E91h
ERROR		Label	00EA0h
ERRO1		Label	00EAEh
ERRO2		Label	00ECDh
IDDOT		Label	00ED6h
CREAT		Label	00F0Eh
CREA1		Label	00F24h
BCOMP		Label	00F67h
LITER		Label	00F84h
LITE1		Label	00F94h
DLITE		Label	00FA2h
DLIT1		Label	00FB2h
QSTAC		Label	00FBEh
INTER		Label	00FEFh
INTE1		Label	00FF1h
INTE3		Label	01009h
INTE4		Label	0100Dh
INTE2		Label	01013h
INTE6		Label	01027h
INTE7		Label	0102Bh
INTE5		Label	0102Dh
IMMED		Label	0103Eh
VOCAB		Label	01058h
DOVOC		Label	01078h
FORTH		Label	01089h
DEFIN		Label	010A2h
PAREN		Label	010B3h
QUIT		Label	010C5h
QUIT1		Label	010CFh
QUIT2		Label	010E6h
ABORT		Label	010F3h
WRM		Label	01115h
WRM1		Label	0111Bh
WARM		Label	01125h
CLD		Label	0112Bh
CLD1		Label	01135h
COLD		Label	0113Fh
STOD		Label	01191h
STOD1		Label	0119Eh
PM		Label	011A7h
PM1		Label	011B1h
DPM		Label	011BAh
DPM1		Label	011C4h
ABS		Label	011CDh
DABS		Label	011DDh
MIN		Label	011ECh
MIN1		Label	011F8h
MAX		Label	01203h
MAX1		Label	0120Fh
MSTAR		Label	01219h
MSLAS		Label	01235h
STAR		Label	0125Ch
SLMOD		Label	0126Ch
SLASH		Label	0127Dh
MODD		Label	0128Eh
SSMOD		Label	0129Fh
SSLA		Label	012B1h
MSMOD		Label	012C4h
PLINE		Label	012E4h
DLINE		Label	0130Bh
MESS		Label	01320h
MESS2		Label	01342h
MESS1		Label	01346h
MESS3		Label	01351h
PTAT		Label	01359h
PTSTO		Label	0136Eh
DRIVE		Label	01385h
SEC		Label	01390h
TRACK		Label	0139Dh
USE		Label	013A8h
PREV		Label	013B4h
SPBLK		Label	013C3h
NOBUF		Label	013D0h
DENSTY		Label	013DFh
DSKERR		Label	013F1h
PBUF		Label	013FDh
PBUF1		Label	01413h
UPDAT		Label	01427h
MTBUF		Label	0144Eh
DRZER		Label	01463h
DRONE		Label	01474h
DRON1		Label	01486h
DRON2		Label	0148Ah
BUFFE		Label	0149Ah
BUFF1		Label	014A4h
BUFF2		Label	014CAh
BLOCK		Label	014E3h
BLOC2		Label	01501h
BLOC3		Label	0151Bh
BLOC1		Label	01533h
SETIO		Label	01545h
SETDRV		Label	01561h
TSCALC		Label	01576h
TSCAL1		Label	0159Eh
TSCAL2		Label	015A4h
TSCALS		Label	015B6h
TSCAL3		Label	015D4h
TSCAL4		Label	015DAh
SECRD		Label	015F8h
SECRL		Label	015FFh
SECWT		Label	01617h
SECWL		Label	0161Eh
RSLW		Label	01630h
RSLW1		Label	0164Ah
RSLW2		Label	0165Ch
RSLW3		Label	0165Eh
FLUSH		Label	01681h
FLUS1		Label	0168Bh
LOAD		Label	0169Fh
ARROW		Label	016D2h
EPRINT		Label	016EEh
CSTAT		Label	016F0h
CIN		Label	016F8h
COUT		Label	01704h
POUT		Label	0170Fh
CPOUT		Label	0171Ah
CPOU1		Label	0172Ah
PQTER		Label	0172Bh
PQTE1		Label	01736h
PKEY		Label	01739h
PKEY1		Label	0174Bh
PEMIT		Label	01751h
PCR		Label	0175Dh
TICK		Label	01772h
FORG		Label	0178Ch
BACK		Label	017CAh
BEGIN		Label	017DDh
ENDIFF		Label	017F0h
THEN		Label	0180Ch
DO		Label	01818h
LOOP		Label	0182Ch
PLOOP		Label	01843h
UNTIL		Label	0185Ah
ENDD		Label	0186Fh
AGAIN		Label	0187Eh
REPEA		Label	01896h
IFF		Label	018B0h
ELSEE		Label	018C8h
WHILE		Label	018EBh
SPACS		Label	018FDh
SPAX2		Label	0190Dh
SPAX1		Label	01913h
BDIGS		Label	0191Bh
EDIGS		Label	0192Bh
SIGN		Label	01945h
SIGN1		Label	01955h
DIG		Label	0195Ch
DIG1		Label	01978h
DIGS		Label	01988h
DIGS1		Label	0198Ah
DDOTR		Label	019A1h
DOTR		Label	019C5h
DDOT		Label	019D7h
DOT		Label	019E6h
QUES		Label	019F3h
UDOT		Label	01A01h
VLIST		Label	01A12h
VLIS1		Label	01A22h
VLIS2		Label	01A36h
BYE		Label	01A5Bh
LIST		Label	01A68h
LIST1		Label	01A87h
LIST2		Label	01AA3h
INDEX		Label	01AB4h
INDE1		Label	01AC4h
INDE2		Label	01ADEh
TRIAD		Label	01AEDh
TRIA1		Label	01B0Dh
TRIA2		Label	01B1Bh
DOTCPU		Label	01B33h
TASK		Label	01B59h
INITDP		Label	01B5Dh

Statistics
----------
"Name"	= 0
"EQU"	= 65
"SET"	= 0
Labels	= 400


