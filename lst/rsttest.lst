     1     			TITLE	'test for RST instructions'
     2
     3 			        ;; RST does a call to 00nnn000
     4 			        ;; at that addresss, we call CHECK in the rom
     5 			        ;; the rom CHECK subroutine pulls its return address
     6 			        ;; which is in the RST service area, and logs the low byte;
     7 			        ;; it then returns to just after the RST instruction.
     8
     9      00 80	LOG     EQU     00080H
    10      00 80	STOP    EQU     00080H
    11
    12      F8 00	        ORG     0F800H
    13 F800 C3 03 F8	        JMP     ROM
    14 			ROM:
    15
    16 F803 3E 00	        MVI     A,0             ;leading NOP to allow debug
    17 F805 32 00 00	        STA     0000H
    18 F808 32 08 00	        STA     0008H
    19 F80B 32 10 00	        STA     0010H
    20 F80E 32 18 00	        STA     0018H
    21 F811 32 20 00	        STA     0020H
    22 F814 32 28 00	        STA     0028H
    23 F817 32 30 00	        STA     0030H
    24 F81A 32 38 00	        STA     0038H
    25
    26 F81D 3E CD	        MVI     A,0CDH
    27 F81F 32 01 00	        STA     0001H
    28 F822 32 09 00	        STA     0009H
    29 F825 32 11 00	        STA     0011H
    30 F828 32 19 00	        STA     0019H
    31 F82B 32 21 00	        STA     0021H
    32 F82E 32 29 00	        STA     0029H
    33 F831 32 31 00	        STA     0031H
    34 F834 32 39 00	        STA     0039H
    35
    36 F837 21 69 F8	        LXI     HL,CHECK
    37 F83A 22 02 00	        SHLD    0002H
    38 F83D 22 0A 00	        SHLD    000AH
    39 F840 22 12 00	        SHLD    0012H
    40 F843 22 1A 00	        SHLD    001AH
    41 F846 22 22 00	        SHLD    0022H
    42 F849 22 2A 00	        SHLD    002AH
    43 F84C 22 32 00	        SHLD    0032H
    44 F84F 22 3A 00	        SHLD    003AH
    45
    46 			        ;; write RST 1 to terminate test early.
    47 			        ;;         MVI     A,010H
    48 			        ;;         STA     0008H
    49
    50 F852 31 80 00	        LXI     SP,STOP
    51 F855 21 80 00	        LXI     HL,LOG
    52
    53 F858		        DB      18H             ;next subtest
            18 
    54 F859 C7		        RST     0
    55 F85A		        DB      18H             ;next subtest
            18 
    56 F85B CF		        RST     1
    57 F85C		        DB      18H             ;next subtest
            18 
    58 F85D D7		        RST     2
    59 F85E		        DB      18H             ;next subtest
            18 
    60 F85F DF		        RST     3
    61 F860		        DB      18H             ;next subtest
            18 
    62 F861 E7		        RST     4
    63 F862		        DB      18H             ;next subtest
            18 
    64 F863 EF		        RST     5
    65 F864		        DB      18H             ;next subtest
            18 
    66 F865 F7		        RST     6
    67 F866		        DB      18H             ;next subtest
            18 
    68 F867 FF		        RST     7
    69 F868		        DB      10H             ;test complete
            10 
    70
    71 			CHECK:
    72 F869 D1		        POP     DE
    73 F86A 73		        MOV     M,E
    74 F86B 23		        INX     HL
    75 F86C C9		        RET


*******************************************************************************
                                 Symbols table
*******************************************************************************

Names		Types	Values
-----		-----	------
LOG		EQU	00080h
STOP		EQU	00080h
ROM		Label	0F803h
CHECK		Label	0F869h

Statistics
----------
"Name"	= 0
"EQU"	= 2
"SET"	= 0
Labels	= 2


